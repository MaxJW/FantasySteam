import{a as s,f as l,c as ye,t as _e}from"../chunks/gRx6Pn2l.js";import{o as Dr}from"../chunks/ayy7s-Yp.js";import{p as Sr,b as x,i as Ft,u as he,s as n,g as e,I as Lr,a as Tr,J as v,K as Cr,$ as Er,c as o,d as u,f as F,r,n as Ue,t as j}from"../chunks/vIZKj9Q3.js";import{d as Ir,s as D}from"../chunks/DuGzo3VH.js";import{i as y}from"../chunks/nU2p-N_8.js";import{h as jr,b as Ye,i as Ve,s as We,d as Mt}from"../chunks/B1_1BM22.js";import{c as Se}from"../chunks/B7WRRx_I.js";import{b as Rr}from"../chunks/V1i_876p.js";import{g as Ur}from"../chunks/BDeyOzaV.js";import{g as Nt}from"../chunks/Vc87Tlf-.js";import{p as Ar}from"../chunks/B6wWA6T8.js";import{g as Bt}from"../chunks/BOOFKvYd.js";import{e as Zt,f as Gr,h as Kt,p as Fr,i as Mr,P as Nr,j as Ot}from"../chunks/Gs9gDzk3.js";import{d as Fe,t as Br,a as $t,b as Or}from"../chunks/CBaHvGib.js";import{a as Ht,b as zt,i as Hr}from"../chunks/CJZZ3COj.js";import{l as zr,u as Dt,m as Jt,a as Qt,s as qr,e as Yr,n as Vr,r as Wr,T as Zr,b as Kr}from"../chunks/D36JPk-d.js";import{g as Jr,P as Qr}from"../chunks/C4QyQyGp.js";import{B as Ze}from"../chunks/D78Pr55m.js";import{I as Xr}from"../chunks/DeuSJQV-.js";import{B as ea}from"../chunks/B4dUOVH_.js";import{D as ta,a as ra,b as aa,S as qt,G as sa}from"../chunks/CmgDEwON.js";import{A as na,a as oa}from"../chunks/8NcR7VKf.js";import{A as Yt}from"../chunks/DUj78siy.js";import{S as ia,B as la,T as ca}from"../chunks/CTP1Ow0s.js";import{S as da}from"../chunks/6hOdE094.js";import{S as ua}from"../chunks/Cl-1vxpa.js";import{L as Vt}from"../chunks/Pu3e9upW.js";import{Z as Wt}from"../chunks/DbBOe8j6.js";import{C as fa}from"../chunks/rdCW3jIr.js";function Xt(f,g,c,R){const b=(f??[]).filter(J=>J.userId===g),T=b.length;return R==="winter"?T===0?["hitPick","bombPick"]:T===1?b[0].pickType==="hitPick"?["bombPick"]:["hitPick"]:T<2+c?["seasonalPick"]:T===2+c?["altPick"]:[]:T<c?["seasonalPick"]:T===c?["altPick"]:[]}async function er(f,g){const c=await Qt(Fe(f,g));return c.exists()?{id:c.id,...c.data()}:null}function va(f,g,c,R){return zr(Fe(f,g),b=>{if(!b.exists()){c(null);return}c({id:b.id,...b.data()})},b=>{R?.(b)})}function St(f,g){return g%2===0?[...f].reverse():f}function tr(f){const g=f.currentPick;return g?St(f.order,g.round)[g.position]??null:null}async function ma(f,g,c){await Dt(Fe(f,g),{presentUserIds:Jt(c)})}async function pa(f,g,c){await Dt(Fe(f,g),{presentUserIds:Vr(c)})}async function ga(f,g,c,R){await qr(Fe(f,g),{status:"pending",phase:c,order:R,currentPick:null,picks:[],presentUserIds:[],createdAt:Yr()})}async function _a(f,g){const c=Fe(f,g),R=await Qt(c);if(!R.exists())throw new Error("Draft not found");const T={round:1,position:0,userId:R.data().order[0]??"",expiresAt:null};await Dt(c,{status:"active",currentPick:T})}function ha(f,g,c,R){const T=Kt(c,R)*f.length;if(g>=T)return null;const J=Math.floor(g/f.length)+1,Pe=g%f.length,C=St(f,J)[Pe];return C?{round:J,position:Pe,userId:C,expiresAt:null}:null}async function xa(f,g,c,R,b){const T=Fe(f,g),J=Br(f,c),Pe=await $t(f);if(!Pe)throw new Error("League not found");const w=Zt(Pe.members.length);await Wr(Kr,async B=>{const ne=await B.get(T),P=await B.get(J);if(!ne.exists())throw new Error("Draft does not exist");const d=ne.data(),Le=d.phase,z=tr(d);if(z!==c)throw new Error(`It is not your turn. Waiting for ${z}.`);if(d.picks.some(Te=>Te.gameId===R))throw new Error("This game has already been drafted.");if(!Xt(d.picks,c,w,Le).includes(b))throw new Error(`You cannot make a ${b} right now.`);const Ke={userId:c,gameId:R,pickType:b,timestamp:Zr.now()};if(B.update(T,{picks:Jt(Ke)}),P.exists()){const ot=P.data().picks??{};if(b==="hitPick")B.update(J,{"picks.hitPick":R});else if(b==="bombPick")B.update(J,{"picks.bombPick":R});else if(b==="seasonalPick"){const re=Gr(Le),Q=[...ot[re]??[],R];B.update(J,{[`picks.${re}`]:Q})}else if(b==="altPick"){const re=[...ot.altPicks??[],R];B.update(J,{"picks.altPicks":re})}}const oe=ha(d.order,d.picks.length+1,Le,w);oe?B.update(T,{currentPick:oe}):B.update(T,{currentPick:null,status:"completed"})}),(await er(f,g))?.status==="completed"&&await Or(f)}var ba=l('<div class="flex h-full flex-col items-center justify-center gap-4"><p class="text-sm text-destructive"> </p> <!></div>'),wa=l('<div class="flex h-full flex-col items-center justify-center gap-3"><!> <p class="text-sm text-muted-foreground">Loading draft room...</p></div>'),ka=l('<span class="flex items-center gap-1.5 font-medium text-red-400"><span class="relative flex h-2 w-2"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex h-2 w-2 rounded-full bg-red-400"></span></span> LIVE</span>'),ya=l("<span> </span>"),Pa=l('<span class="font-medium text-yellow-500">Current picker away</span>'),$a=l("<!> Start Draft",1),Da=l('<span class="flex h-2 w-2 rounded-full bg-accent"></span>'),Sa=l('<span class="flex h-2 w-2 animate-pulse rounded-full bg-muted-foreground/40"></span>'),La=l('<div><span class="max-w-[110px] truncate text-sm font-medium"> </span> <!></div>'),Ta=l('<div class="flex flex-1 items-center justify-center"><div class="glass w-full max-w-md rounded-xl p-6 text-center"><div class="mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10"><!></div> <h2 class="text-lg font-semibold">Waiting for Players</h2> <p class="mt-1 text-sm text-muted-foreground"><!></p> <div class="mt-5 grid grid-cols-2 gap-2"></div></div></div>'),Ca=l("<div><!> <p> </p></div>"),Ea=l('<!> <span class="mt-0.5 text-[9px] font-semibold tracking-tight text-muted-foreground uppercase"> </span>',1),Ia=l('<img alt="" class="absolute inset-0 h-full w-full object-cover"/> <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div> <span class="absolute right-1 bottom-1 left-1.5 line-clamp-2 text-[10px] leading-tight font-medium text-white"> </span>',1),ja=l('<div class="flex h-full w-full items-center justify-center p-1.5 text-center"><span class="line-clamp-3 text-[10px] font-medium text-muted-foreground"> </span></div>'),Ra=l('<div class="absolute inset-0 flex"><div class="flex w-1/3 flex-col items-center justify-center gap-1 border-r border-white/[0.06] bg-white/[0.02]"><!> <span class="text-[8px] font-semibold tracking-tight text-muted-foreground uppercase"> </span></div> <div class="relative flex w-2/3 items-center justify-center overflow-hidden"><!></div></div>'),Ua=l("<!> Make Pick",1),Aa=l('<div class="flex flex-col items-center gap-1"><div class="h-1.5 w-1.5 animate-ping rounded-full bg-primary"></div> <span class="text-[10px] font-medium text-muted-foreground">Picking...</span></div>'),Ga=l('<div class="absolute inset-0 flex items-center justify-center"><!></div>'),Fa=l("<div><!></div>"),Ma=l('<div class="flex min-w-max gap-2"><div class="flex w-16 shrink-0 flex-col items-center justify-center text-center sm:w-20"><!></div> <!></div>'),Na=l('<div class="sticky top-0 z-10 flex min-w-max gap-2 border-b border-white/[0.06] p-2 backdrop-blur" style="background: oklch(0.15 0.03 250 / 0.9)"><div class="flex w-16 shrink-0 items-center justify-center sm:w-20"></div> <!></div> <div class="flex flex-col gap-2 p-2"></div>',1),Ba=l('<div class="flex flex-1 flex-col overflow-hidden rounded-xl border border-white/[0.06] bg-card/30"><!></div>'),Oa=l('<div class="flex shrink-0 flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"><div class="flex items-center gap-2"><!> <div class="min-w-0"><div class="flex flex-wrap items-center gap-2"><h1 class="truncate text-lg font-bold tracking-tight sm:text-xl"> </h1> <!></div> <div class="flex flex-wrap items-center gap-3 text-xs text-muted-foreground"><!> <!> <span> </span></div></div></div> <!></div> <!>',1),Ha=l("<!> Back",1),za=l('<button><!> <span> </span> <span class="text-center text-[11px] leading-relaxed text-muted-foreground"> </span></button>'),qa=l('<div class="overflow-y-auto p-5"><div class="grid h-full min-h-[340px] grid-cols-2 content-center gap-3"></div></div>'),Ya=l('<div class="flex flex-1 items-center justify-center"><!></div>'),Va=l('<button class="flex w-full items-center justify-between rounded-lg px-3 py-2.5 text-left transition-colors hover:bg-white/[0.04]"><span class="text-sm font-medium"> </span> <span class="shrink-0 pl-3 font-mono text-xs text-muted-foreground"> </span></button>'),Wa=l('<div class="py-3 text-center text-xs text-muted-foreground">Loading more…</div>'),Za=l('<div class="py-2 text-center text-[10px] text-muted-foreground"> </div>'),Ka=l('<div class="p-3"><div class="grid grid-cols-1 gap-0.5"></div> <div class="h-4 w-full" role="presentation"></div> <!></div>'),Ja=l('<div class="flex min-h-0 flex-1 flex-col"><div class="shrink-0 border-b border-white/[0.06] px-5 py-3"><div class="relative"><!> <!></div> <p class="mt-2 text-[11px] text-muted-foreground"><!></p></div> <!></div>'),Qa=l('<div class="rounded-full border border-white/[0.08] bg-white/[0.03] p-2"><!></div> <div><p class="text-[10px] font-semibold text-muted-foreground uppercase">Drafting as</p> <p class="text-sm font-medium"> </p></div>',1),Xa=l('<p class="mt-2 text-center text-sm text-destructive"> </p>'),es=l('<div class="flex w-full items-center justify-between rounded-lg border border-white/[0.08] bg-white/[0.03] p-4"><div class="flex items-center gap-3"><!></div> <!></div> <!>',1),ts=l('<div class="flex min-h-0 flex-1 flex-col"><!></div>'),rs=l('<div class="border-b border-white/[0.06] p-5 pb-3"><!> <!></div> <div class="flex h-[420px] flex-col overflow-hidden"><!></div>',1),as=l('<div class="flex h-[calc(100vh-7rem)] flex-col gap-4 md:h-[calc(100vh-8rem)]"><!> <!></div>');function js(f,g){Sr(g,!0);const c=new Map,R=24;let b=x(0),T=x(!1),J=x(void 0),Pe=x(""),w=x(""),C=x(""),B=x("winter"),ne=x(""),P=x(null),d=x(null),Le=x(!1),z=x("type"),Me=x(!1),Ke=x(!1),oe=x(null),Te=x(null),ot=x(""),re=x(null),Q=x(Ft([])),Ce=x(""),it=x(!1),Je=x(""),Lt=null,Tt=x(0),Ct=x(Ft(new Map)),gt=x(0),Ne=x(null),$e=x(null);const ie=v(Bt),Et=v(()=>!!(e(ie)&&e(P)&&e(P).commissionerId===e(ie).uid)),rr=v(()=>new Set((e(d)?.picks??[]).map(t=>t.gameId))),lt=v(()=>e(P)?Zt(e(P).members.length):2),ar=v(()=>Kt(e(B),e(lt))),sr=v(()=>!e(ie)||!e(d)||!e(It)?[]:Xt(e(d).picks??[],e(ie).uid,e(lt),e(B))),nr=v(()=>e(Q).filter(t=>!e(rr).has(t.id)));function ct(t){return e(Ct).get(t)?.trim()||""}const or=v(()=>{if(!e(P)||!e(d))return!1;const t=e(d).presentUserIds??[];return e(P).members.every(a=>t.includes(a))}),Qe=v(()=>e(d)?tr(e(d)):null),It=v(()=>!!(e(ie)&&e(Qe)===e(ie).uid)),ir=v(()=>!!(e(Qe)&&(e(d)?.presentUserIds??[]).includes(e(Qe)))),dt=v(()=>e(P)?.members.filter(t=>!(e(d)?.presentUserIds??[]).includes(t))??[]),Ee=v(()=>Nr[e(B)]);he(()=>{const t=Ur(Ar).params;n(w,t?.id??"",!0),n(C,t?.season??"",!0);const a=Fr(e(C));a&&(n(B,a.phase,!0),n(ne,a.season,!0))}),he(()=>{e(w)&&(n($e,null),$t(e(w)).then(t=>n(P,t,!0)).catch(t=>n($e,t instanceof Error?t.message:"Load failed",!0)))}),he(()=>{const t=e(P)?.members;t?.length&&Jr(t).then(a=>n(Ct,a,!0))}),he(()=>{if(!e(w)||!e(C))return;Lt?.();const t=va(e(w),e(C),a=>n(d,a,!0),a=>n($e,a.message||"Connection error",!0));return Lt=t,()=>t()}),he(()=>{e(d)?.status==="completed"&&e(w)&&Nt(`/league/${e(w)}`)}),he(()=>{!e(d)||!e(ie)||!e(w)||!e(C)||ma(e(w),e(C),e(ie).uid).catch(()=>{})}),he(()=>{e(w)&&e(C)&&e(P)&&jt()}),he(()=>{const t=e(d)?.picks??[];for(const a of t)!a?.gameId||c.has(a.gameId)||Ht(a.gameId).then(S=>{S&&(c.set(a.gameId,S),Lr(Tt))})}),Dr(()=>{const t=Bt();if(!t||!e(w)||!e(C))return;const a=()=>{pa(e(w),e(C),t.uid).catch(()=>{})};return window.addEventListener("beforeunload",a),window.addEventListener("pagehide",a),()=>{a(),window.removeEventListener("beforeunload",a),window.removeEventListener("pagehide",a)}});async function jt(){if(!(!e(w)||!e(C)||!e(P)))try{const t=await er(e(w),e(C));t?n(d,t,!0):e(Et)&&await ga(e(w),e(C),e(B),e(P).members),n($e,null)}catch(t){n($e,t instanceof Error?t.message:"Load failed",!0)}}async function lr(){if(n($e,null),!!e(w))try{const t=await $t(e(w));n(P,t,!0),t&&e(C)&&await jt()}catch(t){n($e,t instanceof Error?t.message:"Load failed",!0)}}async function cr(){!e(w)||!e(C)||await _a(e(w),e(C))}function dr(){n(Le,!0),n(z,"type"),n(oe,null),n(Te,null),n(re,null),n(Ce,""),n(Je,"")}function ur(t){n(oe,t,!0),n(z,"game"),n(Pe,e(Ce),!0),Ut()}function fr(t){if(!t?.trim())return"?";const a=t.trim().split(/\s+/);return a.length===1?a[0].slice(0,2).toUpperCase():(a[0][0]+a[a.length-1][0]).toUpperCase()}function vr(){const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function Rt(){const t=vr(),a=parseInt(e(ne)),S=`${a}-12-31`;if(e(oe)==="seasonalPick"){const O=Mr(e(B),a);return{releaseFrom:O.start>t?O.start:t,releaseTo:O.end}}return{releaseFrom:t,releaseTo:S}}async function Ut(){const t=parseInt(e(ne)),a=e(Ce).trim()||void 0,{releaseFrom:S,releaseTo:O}=Rt();n(gt,0),n(Me,!0),n(Q,[],!0),n(b,0);try{const{games:V,total:H}=await zt(t,R,0,{search:a,releaseFrom:S,releaseTo:O});n(Q,V,!0),n(b,H,!0)}finally{n(Me,!1)}}async function mr(){const t=parseInt(e(ne)),a=e(Ce).trim()||void 0,{releaseFrom:S,releaseTo:O}=Rt();if(!(e(Me)||e(T)||e(Q).length>=e(b))){n(T,!0);try{const{games:V,total:H}=await zt(t,R,e(Q).length,{search:a,releaseFrom:S,releaseTo:O});n(Q,[...e(Q),...V],!0),n(b,H,!0)}finally{n(T,!1)}}}he(()=>{if(e(z)!=="game"||e(Ce)===e(Pe))return;const t=e(Ce),a=setTimeout(()=>{n(Pe,t,!0),Ut()},300);return()=>clearTimeout(a)}),he(()=>{const t=e(J);if(!t)return;const a=new IntersectionObserver(S=>{const[O]=S;O?.isIntersecting&&e(z)==="game"&&e(Q).length>0&&e(Q).length<e(b)&&!e(T)&&!e(Me)&&mr()},{rootMargin:"100px",threshold:0});return a.observe(t),()=>a.disconnect()}),he(()=>{if(e(z)!=="game"||!e(Ne))return;const t=e(gt);queueMicrotask(()=>{e(Ne)&&(e(Ne).scrollTop=t)})});async function pr(t){n(gt,e(Ne)?.scrollTop??0,!0),n(Ke,!0),n(re,null),n(z,"confirm");try{if(c.has(t))n(re,c.get(t),!0);else{const a=await Ht(t);a&&(c.set(t,a),n(re,a,!0))}e(re)&&(n(Te,e(re).id,!0),n(ot,e(re).name,!0))}finally{n(Ke,!1)}}async function gr(){if(!(!e(ie)||!e(w)||!e(C)||!e(Te)||!e(oe))){if(await Hr(e(Te))){n(Je,"That game cannot be drafted.");return}n(it,!0);try{await xa(e(w),e(C),e(ie).uid,e(Te),e(oe)),n(Le,!1)}catch(t){n(Je,t instanceof Error?t.message:"Pick failed",!0)}finally{n(it,!1)}}}function _r(t){if(!t)return"—";const a=new Date(t);return isNaN(a.getTime())?t:a.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}const hr={seasonalPick:{label:"Seasonal",icon:da,color:"text-sky-400",borderHover:"hover:border-sky-400/50 hover:bg-sky-400/10"},hitPick:{label:"Hit",icon:ca,color:"text-accent",borderHover:"hover:border-accent/50 hover:bg-accent/10"},bombPick:{label:"Bomb",icon:la,color:"text-destructive",borderHover:"hover:border-destructive/50 hover:bg-destructive/10"},altPick:{label:"Alt",icon:ia,color:"text-purple-400",borderHover:"hover:border-purple-400/50 hover:bg-purple-400/10"}};function xr(t){return t==="seasonalPick"?`Pick a game releasing in the ${e(Ee)?.label??""} window`:t==="hitPick"?"Your GOTY prediction — the best performer this year":t==="bombPick"?"A game you think will flop — hurts other players if it bombs":t==="altPick"?"Backup pick — activates if one of your games is delisted from Steam":""}const Xe=hr;function br(t,a,S){if(e(Tt),!e(d)||!e(P))return null;const O=e(P).members.length;let V;t%2===0?V=t*O+a:V=t*O+(O-1-a);const H=e(d).picks[V],ue=St(e(d).order,e(d).currentPick?.round??0),fe=!!e(d).currentPick&&e(d).currentPick.round===t+1&&ue[e(d).currentPick.position]===S;let Ie,Be;if(H){const xe=c.get(H.gameId);Ie=xe?.coverUrl??void 0,Be=xe?.name??""}const Ae=Ot(e(B),t+1,e(lt));return{pick:H,isCurrent:fe,pickIndex:V,coverUrl:Ie,gameName:Be,roundPickType:Ae}}var _t=as();jr("1glbubq",t=>{Cr(()=>{Er.title=e(P)?.name?`${e(P).name} – ${e(Ee)?.label??""} Draft`:"Draft Room"})});var At=o(_t);{var wr=t=>{var a=ba(),S=o(a),O=o(S,!0);r(S);var V=u(S,2);Ze(V,{variant:"outline",onclick:lr,children:(H,ue)=>{Ue();var fe=_e("Retry");s(H,fe)},$$slots:{default:!0}}),r(a),j(()=>D(O,e($e))),s(t,a)},kr=t=>{var a=ye(),S=F(a);{var O=H=>{var ue=wa(),fe=o(ue);Vt(fe,{class:"h-8 w-8 animate-spin text-primary"}),Ue(2),r(ue),s(H,ue)},V=H=>{var ue=Oa(),fe=F(ue),Ie=o(fe),Be=o(Ie);Ze(Be,{variant:"ghost",size:"icon",onclick:()=>Nt(`/league/${e(w)}`),class:"h-8 w-8 shrink-0 text-muted-foreground hover:text-foreground",children:(i,m)=>{Yt(i,{class:"h-4 w-4"})},$$slots:{default:!0}});var Ae=u(Be,2),xe=o(Ae),Oe=o(xe),ht=o(Oe,!0);r(Oe);var xt=u(Oe,2);ea(xt,{variant:"outline",class:"shrink-0 text-[10px]",children:(i,m)=>{Ue();var $=_e();j(()=>D($,`${e(Ee)?.label??""??""} Draft`)),s(i,$)},$$slots:{default:!0}}),r(xe);var et=u(xe,2),ut=o(et);{var bt=i=>{var m=ka();s(i,m)},wt=i=>{var m=ya(),$=o(m);r(m),j(()=>D($,`Status: ${e(d).status??""}`)),s(i,m)};y(ut,i=>{e(d).status==="active"?i(bt):i(wt,!1)})}var W=u(ut,2);{var le=i=>{var m=Pa();s(i,m)};y(W,i=>{!e(ir)&&e(d).status==="active"&&i(le)})}var be=u(W,2),De=o(be);r(be),r(et),r(Ae),r(Ie);var ce=u(Ie,2);{var q=i=>{{let m=v(()=>!e(or));Ze(i,{onclick:cr,get disabled(){return e(m)},class:"glow-sm-primary gap-2",children:($,X)=>{var E=$a(),M=F(E);Qr(M,{class:"h-4 w-4"}),Ue(),s($,E)},$$slots:{default:!0}})}};y(ce,i=>{e(Et)&&e(d).status==="pending"&&i(q)})}r(fe);var ae=u(fe,2);{var ve=i=>{var m=Ta(),$=o(m),X=o($),E=o(X);Wt(E,{class:"h-6 w-6 text-primary"}),r(X);var M=u(X,4),ee=o(M);{var me=p=>{var U=_e();j(()=>D(U,`Waiting for ${e(dt).length??""} ${e(dt).length===1?"player":"players"}`)),s(p,U)},de=p=>{var U=_e("Everyone is here! The commissioner can start the draft.");s(p,U)};y(ee,p=>{e(dt).length>0?p(me):p(de,!1)})}r(M);var k=u(M,2);Ye(k,21,()=>e(P).members,Ve,(p,U)=>{const te=v(()=>!e(dt).includes(e(U)));var _=La(),L=o(_),N=o(L,!0);r(L);var we=u(L,2);{var se=h=>{var G=Da();s(h,G)},A=h=>{var G=Sa();s(h,G)};y(we,h=>{e(te)?h(se):h(A,!1)})}r(_),j(h=>{We(_,1,`flex items-center justify-between rounded-lg border px-3 py-2 transition-colors ${e(te)?"border-accent/30 bg-accent/[0.06]":"border-white/[0.06] bg-white/[0.02]"}`),D(N,h)},[()=>ct(e(U))||"…"]),s(p,_)}),r(k),r($),r(m),s(i,m)},Y=i=>{var m=Ba(),$=o(m);qt($,{class:"min-h-0 flex-1",orientation:"both",children:(X,E)=>{var M=Na(),ee=F(M),me=u(o(ee),2);Ye(me,17,()=>e(P).members,Ve,(k,p)=>{const U=v(()=>e(ie)?.uid===e(p)),te=v(()=>e(Qe)===e(p));var _=Ca(),L=o(_);Se(L,()=>oa,(se,A)=>{A(se,{class:"h-7 w-7 shrink-0",children:(h,G)=>{var Z=ye(),I=F(Z);{let K=v(()=>e(U)?"bg-primary text-primary-foreground":"");Se(I,()=>na,(pe,je)=>{je(pe,{get class(){return`text-[10px] ${e(K)??""}`},children:(tt,rt)=>{Ue();var ft=_e();j(kt=>D(ft,kt),[()=>fr(ct(e(p)))]),s(tt,ft)},$$slots:{default:!0}})})}s(h,Z)},$$slots:{default:!0}})});var N=u(L,2),we=o(N,!0);r(N),r(_),j((se,A)=>{We(_,1,`flex min-w-[160px] flex-1 items-center justify-center gap-2 rounded-lg border px-2 py-2 transition-all sm:min-w-[180px] ${e(te)?"glow-sm-primary border-primary/30 bg-primary/[0.08]":"border-white/[0.06] bg-white/[0.03]"}`),We(N,1,`truncate text-sm font-medium ${e(U)?"text-primary":""}`),Mt(N,"title",se),D(we,A)},[()=>ct(e(p))||void 0,()=>ct(e(p))||"…"]),s(k,_)}),r(ee);var de=u(ee,2);Ye(de,21,()=>Array(e(ar)),Ve,(k,p,U)=>{const te=v(()=>Ot(e(B),U+1,e(lt))),_=v(()=>Xe[e(te)]);var L=Ma(),N=o(L),we=o(N);{var se=h=>{const G=v(()=>e(_).icon);var Z=Ea(),I=F(Z);Se(I,()=>e(G),(je,tt)=>{tt(je,{get class(){return`h-4 w-4 ${e(_).color??""}`}})});var K=u(I,2),pe=o(K,!0);r(K),j(()=>D(pe,e(_).label)),s(h,Z)};y(we,h=>{e(_)&&h(se)})}r(N);var A=u(N,2);Ye(A,17,()=>e(P).members,Ve,(h,G,Z)=>{const I=v(()=>br(U,Z,e(G))),K=v(()=>e(ie)?.uid===e(G)),pe=v(()=>e(I)?.isCurrent),je=v(()=>!!e(I)?.pick),tt=v(()=>e(Qe)===e(G));var rt=Fa(),ft=o(rt);{var kt=He=>{const ze=v(()=>Xe[e(I).pick.pickType]||{icon:fa,color:"text-gray-500",label:"?"}),yt=v(()=>e(ze).icon);var at=Ra(),Ge=o(at),qe=o(Ge);Se(qe,()=>e(yt),(ge,ke)=>{ke(ge,{get class(){return`h-4 w-4 ${e(ze).color??""}`}})});var vt=u(qe,2),Pt=o(vt,!0);r(vt),r(Ge);var mt=u(Ge,2),Re=o(mt);{var st=ge=>{var ke=Ia(),nt=F(ke),pt=u(nt,4),$r=o(pt,!0);r(pt),j(()=>{Mt(nt,"src",e(I).coverUrl),D($r,e(I).gameName||"…")}),s(ge,ke)},Gt=ge=>{var ke=ja(),nt=o(ke),pt=o(nt,!0);r(nt),r(ke),j(()=>D(pt,e(I).gameName||"…")),s(ge,ke)};y(Re,ge=>{e(I).coverUrl?ge(st):ge(Gt,!1)})}r(mt),r(at),j(()=>D(Pt,e(ze).label)),s(He,at)},Pr=He=>{var ze=ye(),yt=F(ze);{var at=Ge=>{var qe=Ga(),vt=o(qe);{var Pt=Re=>{Ze(Re,{size:"sm",onclick:dr,class:"glow-primary gap-1.5 font-semibold",children:(st,Gt)=>{var ge=Ua(),ke=F(ge);Wt(ke,{class:"h-3.5 w-3.5"}),Ue(),s(st,ge)},$$slots:{default:!0}})},mt=Re=>{var st=Aa();s(Re,st)};y(vt,Re=>{e(K)&&e(It)?Re(Pt):Re(mt,!1)})}r(qe),s(Ge,qe)};y(yt,Ge=>{e(pe)&&Ge(at)},!0)}s(He,ze)};y(ft,He=>{e(je)&&e(I)?.pick?He(kt):He(Pr,!1)})}r(rt),j(()=>We(rt,1,`group relative min-h-[90px] min-w-[160px] flex-1 overflow-hidden rounded-lg border transition-all sm:min-h-[100px] sm:min-w-[180px]
										${e(pe)?"animate-glow-pulse border-primary/50 ring-1 ring-primary/30":"border-white/[0.06]"}
										${e(tt)&&!e(pe)?"bg-primary/[0.03]":e(je)?"bg-card/50":"bg-white/[0.01]"}`)),s(h,rt)}),r(L),s(k,L)}),r(de),s(X,M)},$$slots:{default:!0}}),r(m),s(i,m)};y(ae,i=>{e(d).status==="pending"?i(ve):i(Y,!1)})}j((i,m)=>{D(ht,e(P).name||""),D(De,`${i??""} — ${m??""}`)},[()=>e(Ee)?.releaseStart(parseInt(e(ne))).slice(5),()=>e(Ee)?.releaseEnd(parseInt(e(ne))).slice(5)]),s(H,ue)};y(S,H=>{!e(P)||!e(d)?H(O):H(V,!1)},!0)}s(t,a)};y(At,t=>{e($e)?t(wr):t(kr,!1)})}var yr=u(At,2);Se(yr,()=>aa,(t,a)=>{a(t,{get open(){return e(Le)},set open(S){n(Le,S,!0)},children:(S,O)=>{var V=ye(),H=F(V);Se(H,()=>ta,(ue,fe)=>{fe(ue,{class:"gap-0 overflow-hidden p-0 sm:max-w-2xl",children:(Ie,Be)=>{var Ae=rs(),xe=F(Ae),Oe=o(xe);Se(Oe,()=>ra,(W,le)=>{le(W,{class:"text-lg font-semibold",children:(be,De)=>{var ce=ye(),q=F(ce);{var ae=Y=>{var i=_e("Select Pick Type");s(Y,i)},ve=Y=>{var i=ye(),m=F(i);{var $=E=>{var M=_e("Select Game");s(E,M)},X=E=>{var M=_e("Confirm Selection");s(E,M)};y(m,E=>{e(z)==="game"?E($):E(X,!1)},!0)}s(Y,i)};y(q,Y=>{e(z)==="type"?Y(ae):Y(ve,!1)})}s(be,ce)},$$slots:{default:!0}})});var ht=u(Oe,2);{var xt=W=>{Ze(W,{variant:"ghost",size:"sm",class:"mt-1 flex items-center gap-1 text-xs text-muted-foreground",onclick:()=>n(z,e(z)==="confirm"?"game":"type",!0),children:(le,be)=>{var De=Ha(),ce=F(De);Yt(ce,{class:"h-3 w-3"}),Ue(),s(le,De)},$$slots:{default:!0}})};y(ht,W=>{e(z)!=="type"&&W(xt)})}r(xe);var et=u(xe,2),ut=o(et);{var bt=W=>{var le=qa(),be=o(le);Ye(be,21,()=>e(sr),Ve,(De,ce)=>{const q=v(()=>Xe[e(ce)]);var ae=ye(),ve=F(ae);{var Y=i=>{const m=v(()=>e(q).icon);var $=za();$.__click=()=>ur(e(ce));var X=o($);Se(X,()=>e(m),(de,k)=>{k(de,{get class(){return`size-9 ${e(q).color??""} transition-transform group-hover:scale-110`}})});var E=u(X,2),M=o(E,!0);r(E);var ee=u(E,2),me=o(ee,!0);r(ee),r($),j(de=>{We($,1,`group flex flex-col items-center justify-center gap-3 rounded-xl border-2 border-white/[0.06] bg-white/[0.02] p-5 transition-all ${e(q).borderHover??""}`),We(E,1,`text-base font-bold ${e(q).color??""}`),D(M,e(q).label),D(me,de)},[()=>xr(e(ce))]),s(i,$)};y(ve,i=>{e(q)&&i(Y)})}s(De,ae)}),r(be),r(le),s(W,le)},wt=W=>{var le=ye(),be=F(le);{var De=q=>{var ae=Ja(),ve=o(ae),Y=o(ve),i=o(Y);ua(i,{class:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"});var m=u(i,2);Xr(m,{placeholder:"Search games...",class:"pl-9",autofocus:!0,get value(){return e(Ce)},set value(k){n(Ce,k,!0)}}),r(Y);var $=u(Y,2),X=o($);{var E=k=>{var p=_e();j((U,te)=>D(p,`Showing ${e(Ee)?.label??""??""} games (${U??""} — ${te??""})`),[()=>e(Ee)?.releaseStart(parseInt(e(ne))).slice(5),()=>e(Ee)?.releaseEnd(parseInt(e(ne))).slice(5)]),s(k,p)},M=k=>{var p=_e();j(()=>D(p,`All unreleased games for ${e(ne)??""}`)),s(k,p)};y(X,k=>{e(oe)==="seasonalPick"?k(E):k(M,!1)})}r($),r(ve);var ee=u(ve,2);{var me=k=>{var p=Ya(),U=o(p);Vt(U,{class:"animate-spin text-primary"}),r(p),s(k,p)},de=k=>{qt(k,{class:"min-h-0 flex-1",get viewportRef(){return e(Ne)},set viewportRef(p){n(Ne,p,!0)},children:(p,U)=>{var te=Ka(),_=o(te);Ye(_,21,()=>e(nr),Ve,(A,h)=>{var G=Va();G.__click=()=>pr(e(h).id);var Z=o(G),I=o(Z,!0);r(Z);var K=u(Z,2),pe=o(K,!0);r(K),r(G),j(je=>{D(I,e(h).name),D(pe,je)},[()=>_r(e(h).releaseDate)]),s(A,G)}),r(_);var L=u(_,2);Rr(L,A=>n(J,A),()=>e(J));var N=u(L,2);{var we=A=>{var h=Wa();s(A,h)},se=A=>{var h=ye(),G=F(h);{var Z=I=>{var K=Za(),pe=o(K);r(K),j(()=>D(pe,`${e(Q).length??""} of ${e(b)??""}`)),s(I,K)};y(G,I=>{e(Q).length>0&&e(Q).length<e(b)&&I(Z)},!0)}s(A,h)};y(N,A=>{e(T)?A(we):A(se,!1)})}r(te),s(p,te)},$$slots:{default:!0}})};y(ee,k=>{e(Me)?k(me):k(de,!1)})}r(ae),s(q,ae)},ce=q=>{var ae=ye(),ve=F(ae);{var Y=i=>{var m=ts(),$=o(m);sa($,{embedded:!0,get game(){return e(re)},get loading(){return e(Ke)},footer:E=>{var M=es(),ee=F(M),me=o(ee),de=o(me);{var k=_=>{const L=v(()=>Xe[e(oe)]),N=v(()=>e(L).icon);var we=Qa(),se=F(we),A=o(se);Se(A,()=>e(N),(I,K)=>{K(I,{get class(){return`h-5 w-5 ${e(L).color??""}`}})}),r(se);var h=u(se,2),G=u(o(h),2),Z=o(G);r(G),r(h),j(()=>D(Z,`${e(L).label??""} Pick`)),s(_,we)};y(de,_=>{e(oe)&&Xe[e(oe)]&&_(k)})}r(me);var p=u(me,2);Ze(p,{size:"lg",onclick:gr,get disabled(){return e(it)},class:"glow-sm-primary px-6",children:(_,L)=>{Ue();var N=_e();j(()=>D(N,e(it)?"Submitting...":"Confirm Pick")),s(_,N)},$$slots:{default:!0}}),r(ee);var U=u(ee,2);{var te=_=>{var L=Xa(),N=o(L,!0);r(L),j(()=>D(N,e(Je))),s(_,L)};y(U,_=>{e(Je)&&_(te)})}s(E,M)},$$slots:{footer:!0}}),r(m),s(i,m)};y(ve,i=>{e(z)==="confirm"&&i(Y)},!0)}s(q,ae)};y(be,q=>{e(z)==="game"?q(De):q(ce,!1)},!0)}s(W,le)};y(ut,W=>{e(z)==="type"?W(bt):W(wt,!1)})}r(et),s(Ie,Ae)},$$slots:{default:!0}})}),s(S,V)},$$slots:{default:!0}})}),r(_t),s(f,_t),Tr()}Ir(["click"]);export{js as component};
