import{a as s,f as l,c as Ae,t as Te}from"../chunks/C-txDrIU.js";import{o as Ar}from"../chunks/dq7zsYpg.js";import{p as Rr,b as _,v as kt,u as be,s as a,g as e,O as Or,a as Fr,P as u,Q as Nr,$ as Mr,c as o,d as i,f as B,r,n as Ee,t as $}from"../chunks/B3kg7STf.js";import{d as zr,s as y}from"../chunks/eHwK_pec.js";import{i as b}from"../chunks/BLFEfHvi.js";import{b as et,i as tt,s as ut,d as It}from"../chunks/C2sax5ki.js";import{c as we}from"../chunks/WTJoWbb0.js";import{h as Hr,B as rt}from"../chunks/D0K52Ymi.js";import{b as Vr}from"../chunks/TCx7b1jQ.js";import{g as Yr}from"../chunks/D_9Bzrfm.js";import{g as Jt}from"../chunks/oYG92esf.js";import{p as qr}from"../chunks/DD6Cvtsc.js";import{k as Wr,u as Ot,l as lr,d as cr,h as Zr,i as Qr,m as Kr,r as Jr,T as Xr,f as ea,g as Xt}from"../chunks/V1ThnXvC.js";import{e as dr,f as ta,h as ur,p as ra,i as aa,P as sa,j as er}from"../chunks/Gs9gDzk3.js";import{d as vt,t as oa,a as Rt,b as na}from"../chunks/B0fso3pj.js";import{a as tr,b as ia,c as rr,i as la}from"../chunks/DOiIeLCc.js";import{g as ca,P as da}from"../chunks/BIbVJvQ_.js";import{g as ua,D as va,a as fa,b as ma,G as pa,S as ar,B as sr,r as ga,c as ha}from"../chunks/WNVAp9EX.js";import{I as _a}from"../chunks/CEbPfyDv.js";import{B as xa}from"../chunks/DHMx5tZ5.js";import{S as ba,T as wa,a as ka,b as ya,c as Pa,d as $a,L as Da,e as Sa,C as La}from"../chunks/D-Ag-hz1.js";import{A as Ta,a as Ia}from"../chunks/C1BlhXKC.js";import{A as or}from"../chunks/5WwWcRaY.js";import{S as Ca,B as Ga,T as Ba}from"../chunks/CIti5ivr.js";import{S as Ea}from"../chunks/DeZ0sK82.js";import{L as nr}from"../chunks/B1u2S8by.js";import{Z as ir}from"../chunks/CAYcYfIj.js";import{C as ja}from"../chunks/8r4huLRU.js";function vr(g,P,v,U){const S=(g??[]).filter(oe=>oe.userId===P),E=S.length;return U==="winter"?E===0?["hitPick","bombPick"]:E===1?S[0].pickType==="hitPick"?["bombPick"]:["hitPick"]:E<2+v?["seasonalPick"]:E===2+v?["altPick"]:[]:E<v?["seasonalPick"]:E===v?["altPick"]:[]}async function fr(g,P){const v=await cr(vt(g,P));return v.exists()?{id:v.id,...v.data()}:null}function Ua(g,P,v,U){return Wr(vt(g,P),S=>{if(!S.exists()){v(null);return}v({id:S.id,...S.data()})},S=>{U?.(S)})}function Ft(g,P){return P%2===0?[...g].reverse():g}function mr(g){const P=g.currentPick;return P?Ft(g.order,P.round)[P.position]??null:null}async function Aa(g,P,v){await Ot(vt(g,P),{presentUserIds:lr(v)})}async function Ra(g,P,v){await Ot(vt(g,P),{presentUserIds:Kr(v)})}async function Oa(g,P,v,U){await Zr(vt(g,P),{status:"pending",phase:v,order:U,currentPick:null,picks:[],presentUserIds:[],createdAt:Qr()})}async function Fa(g,P){const v=vt(g,P),U=await cr(v);if(!U.exists())throw new Error("Draft not found");const E={round:1,position:0,userId:U.data().order[0]??"",expiresAt:null};await Ot(v,{status:"active",currentPick:E})}function Na(g,P,v,U){const E=ur(v,U)*g.length;if(P>=E)return null;const oe=Math.floor(P/g.length)+1,Re=P%g.length,j=Ft(g,oe)[Re];return j?{round:oe,position:Re,userId:j,expiresAt:null}:null}async function Ma(g,P,v,U,S){const E=vt(g,P),oe=oa(g,v),Re=await Rt(g);if(!Re)throw new Error("League not found");const L=dr(Re.members.length);await Jr(ea,async z=>{const me=await z.get(E),T=await z.get(oe);if(!me.exists())throw new Error("Draft does not exist");const m=me.data(),Ze=m.phase,q=mr(m);if(q!==v)throw new Error(`It is not your turn. Waiting for ${q}.`);if(m.picks.some(ke=>ke.gameId===U))throw new Error("This game has already been drafted.");if(!vr(m.picks,v,L,Ze).includes(S))throw new Error(`You cannot make a ${S} right now.`);const st={userId:v,gameId:U,pickType:S,timestamp:Xr.now()};if(z.update(E,{picks:lr(st)}),T.exists()){const O=T.data().picks??{};if(S==="hitPick")z.update(oe,{"picks.hitPick":U});else if(S==="bombPick")z.update(oe,{"picks.bombPick":U});else if(S==="seasonalPick"){const ft=ta(Ze),Ie=[...O[ft]??[],U];z.update(oe,{[`picks.${ft}`]:Ie})}else if(S==="altPick"){const ft=[...O.altPicks??[],U];z.update(oe,{"picks.altPicks":ft})}}const ot=Na(m.order,m.picks.length+1,Ze,L);ot?z.update(E,{currentPick:ot}):z.update(E,{currentPick:null,status:"completed"})}),(await fr(g,P))?.status==="completed"&&await na(g)}var za=l('<div class="flex h-full flex-col items-center justify-center gap-4"><p class="text-sm text-destructive"> </p> <!></div>'),Ha=l('<div class="flex h-full flex-col items-center justify-center gap-3"><!> <p class="text-sm text-muted-foreground">Loading draft room...</p></div>'),Va=l('<span class="flex items-center gap-1.5 font-medium text-red-400"><span class="relative flex h-2 w-2"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex h-2 w-2 rounded-full bg-red-400"></span></span> LIVE</span>'),Ya=l("<span> </span>"),qa=l('<span class="font-medium text-yellow-500">Current picker away</span>'),Wa=l("<!> Start Draft",1),Za=l('<span class="flex h-2 w-2 rounded-full bg-accent"></span>'),Qa=l('<span class="flex h-2 w-2 animate-pulse rounded-full bg-muted-foreground/40"></span>'),Ka=l('<div><span class="max-w-[110px] truncate text-sm font-medium"> </span> <!></div>'),Ja=l('<div class="flex flex-1 items-center justify-center"><div class="glass w-full max-w-md rounded-xl p-6 text-center"><div class="mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10"><!></div> <h2 class="text-lg font-semibold">Waiting for Players</h2> <p class="mt-1 text-sm text-muted-foreground"><!></p> <div class="mt-5 grid grid-cols-2 gap-2"></div></div></div>'),Xa=l("<div><!> <p> </p></div>"),es=l('<!> <span class="mt-0.5 text-[9px] font-semibold tracking-tight text-muted-foreground uppercase"> </span>',1),ts=l('<img alt="" class="absolute inset-0 h-full w-full object-cover"/> <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div> <span class="absolute right-1 bottom-1 left-1.5 line-clamp-2 text-[10px] leading-tight font-medium text-white"> </span>',1),rs=l('<div class="flex h-full w-full items-center justify-center p-1.5 text-center"><span class="line-clamp-3 text-[10px] font-medium text-muted-foreground"> </span></div>'),as=l('<div class="absolute inset-0 flex"><div class="flex w-1/3 flex-col items-center justify-center gap-1 border-r border-white/[0.06] bg-white/[0.02]"><!> <span class="text-[8px] font-semibold tracking-tight text-muted-foreground uppercase"> </span></div> <div class="relative flex w-2/3 items-center justify-center overflow-hidden"><!></div></div>'),ss=l("<!> Make Pick",1),os=l('<div class="flex flex-col items-center gap-1"><div class="h-1.5 w-1.5 animate-ping rounded-full bg-primary"></div> <span class="text-[10px] font-medium text-muted-foreground">Picking...</span></div>'),ns=l('<div class="absolute inset-0 flex items-center justify-center"><!></div>'),is=l("<div><!></div>"),ls=l('<div class="flex min-w-max gap-2"><div class="flex w-16 shrink-0 flex-col items-center justify-center text-center sm:w-20"><!></div> <!></div>'),cs=l('<div class="sticky top-0 z-10 flex min-w-max gap-2 border-b border-white/[0.06] p-2 backdrop-blur" style="background: oklch(0.15 0.03 250 / 0.9)"><div class="flex w-16 shrink-0 items-center justify-center sm:w-20"></div> <!></div> <div class="flex flex-col gap-2 p-2"></div>',1),ds=l('<div class="flex flex-1 flex-col overflow-hidden rounded-xl border border-white/[0.06] bg-card/30"><!></div>'),us=l('<div class="flex shrink-0 flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"><div class="flex items-center gap-2"><!> <div class="min-w-0"><div class="flex flex-wrap items-center gap-2"><h1 class="truncate text-lg font-bold tracking-tight sm:text-xl"> </h1> <!></div> <div class="flex flex-wrap items-center gap-3 text-xs text-muted-foreground"><!> <!> <span> </span></div></div></div> <!></div> <!>',1),vs=l("<!> Back",1),fs=l('<button><!> <span> </span> <span class="text-center text-[11px] leading-relaxed text-muted-foreground"> </span></button>'),ms=l('<div class="overflow-y-auto p-5"><div class="grid grid-cols-2 gap-3"></div></div>'),ps=l("<!> <!>",1),gs=l('<button type="button" role="checkbox" aria-label="Bookmarked only" class="flex h-8 shrink-0 cursor-pointer items-center gap-2 rounded-md border border-white/[0.08] bg-white/[0.04] px-3 text-xs transition-colors hover:bg-white/[0.06]"><span><!></span> <span class="text-foreground">Bookmarked</span></button>'),hs=l('<div class="flex flex-1 items-center justify-center"><!></div>'),_s=l('<button class="flex w-full cursor-pointer items-center justify-between rounded-lg px-3 py-2.5 text-left transition-colors hover:bg-white/[0.04]"><span class="flex items-center gap-2 text-sm font-medium"><!> </span> <span class="shrink-0 pl-3 font-mono text-xs text-muted-foreground"> </span></button>'),xs=l('<div class="grid grid-cols-1 gap-0.5"></div>'),bs=l('<img alt="" class="absolute inset-0 h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.03]" loading="lazy" width="264" height="396"/>'),ws=l('<div class="flex h-full w-full items-center justify-center p-3 text-center text-sm text-muted-foreground"> </div>'),ks=l('<div class="absolute top-2 right-2 rounded-full bg-black/60 p-1" aria-hidden="true"><!></div>'),ys=l('<span class="mt-0.5 font-mono text-[10px] text-white/80"> </span>'),Ps=l('<button type="button" class="group relative aspect-[2/3] w-full cursor-pointer overflow-hidden rounded-lg border border-white/[0.06] bg-white/[0.03] text-left transition-all hover:border-white/[0.15] hover:shadow-lg hover:shadow-primary/[0.05] focus:ring-2 focus:ring-ring focus:outline-none"><!> <!> <div class="absolute inset-x-0 bottom-0 flex min-h-[50%] flex-col justify-end bg-gradient-to-t from-black/90 via-black/40 to-transparent p-3 opacity-0 transition-opacity duration-200 group-hover:opacity-100"><span class="line-clamp-2 text-sm font-medium text-white"> </span> <span class="mt-0.5 text-[10px] text-white/70"> </span> <!></div></button>'),$s=l('<div class="grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6"></div>'),Ds=l('<div class="py-3 text-center text-xs text-muted-foreground">Loading more…</div>'),Ss=l('<div class="py-2 text-center text-[10px] text-muted-foreground"> </div>'),Ls=l('<div class="p-3"><!> <div class="h-4 w-full" role="presentation"></div> <!></div>'),Ts=l('<div class="rounded-full border border-white/[0.08] bg-white/[0.03] p-2"><!></div> <div><p class="text-[10px] font-semibold text-muted-foreground uppercase">Drafting as</p> <p class="text-sm font-medium"> </p></div>',1),Is=l('<p class="mt-2 text-center text-sm text-destructive"> </p>'),Cs=l('<div class="flex w-full items-center justify-between rounded-lg border border-white/[0.08] bg-white/[0.03] p-4"><div class="flex items-center gap-3"><!></div> <!></div> <!>',1),Gs=l('<div class="flex min-h-0 flex-1 flex-col"><div class="shrink-0 border-b border-white/[0.06] px-5 py-3"><div class="relative"><!> <!></div> <div class="mt-2 flex flex-wrap items-center gap-2"><div class="flex items-center gap-2"><!> <!></div> <!> <div class="flex items-center gap-0.5 rounded-lg border border-white/[0.08] bg-white/[0.04] p-0.5"><!> <!></div></div> <p class="mt-2 text-[11px] text-muted-foreground"><!></p></div> <!></div> <!>',1),Bs=l('<div class="border-b border-white/[0.06] p-5 pb-3"><!> <!></div> <div class="flex min-h-0 flex-1 flex-col overflow-hidden"><!></div>',1),Es=l('<div class="flex h-[calc(100vh-7rem)] flex-col gap-4 md:h-[calc(100vh-8rem)]"><!> <!></div>');function co(g,P){Rr(P,!0);const v=new Map,U=24;let S=_(0),E=_(!1),oe=_(void 0),Re=_(""),L=_(""),j=_(""),z=_("winter"),me=_(""),T=_(null),m=_(null),Ze=_(!1),q=_("type"),at=_(!1),st=_(!1),ot=_(!1),ke=_(null),O=_(null),ft=_(""),Ie=_(null),ye=_(kt([])),Qe=_(""),Ct=_(kt([])),Ce=_(kt([])),pt=_("grid"),je=_(!1),Ge=_(kt(new Set)),yt=_(!1),gt=_(""),Nt=null,Mt=_(0),zt=_(kt(new Map)),Ht=_(null),Oe=_(null);const F=u(Xt),Vt=u(()=>!!(e(F)&&e(T)&&e(T).commissionerId===e(F).uid)),pr=u(()=>new Set((e(m)?.picks??[]).map(t=>t.gameId))),Pt=u(()=>e(T)?dr(e(T).members.length):2),gr=u(()=>ur(e(z),e(Pt))),hr=u(()=>!e(F)||!e(m)||!e(qt)?[]:vr(e(m).picks??[],e(F).uid,e(Pt),e(z))),Yt=u(()=>e(ye).filter(t=>!e(pr).has(t.id)));function $t(t){return e(zt).get(t)?.trim()||""}const _r=u(()=>{if(!e(T)||!e(m))return!1;const t=e(m).presentUserIds??[];return e(T).members.every(n=>t.includes(n))}),ht=u(()=>e(m)?mr(e(m)):null),qt=u(()=>!!(e(F)&&e(ht)===e(F).uid)),xr=u(()=>!!(e(ht)&&(e(m)?.presentUserIds??[]).includes(e(ht)))),Dt=u(()=>e(T)?.members.filter(t=>!(e(m)?.presentUserIds??[]).includes(t))??[]),Ke=u(()=>sa[e(z)]);be(()=>{const t=Yr(qr).params;a(L,t?.id??"",!0),a(j,t?.season??"",!0);const n=ra(e(j));n&&(a(z,n.phase,!0),a(me,n.season,!0))}),be(()=>{e(L)&&(a(Oe,null),Rt(e(L)).then(t=>a(T,t,!0)).catch(t=>a(Oe,t instanceof Error?t.message:"Load failed",!0)))}),be(()=>{const t=e(T)?.members;t?.length&&ca(t).then(n=>a(zt,n,!0))}),be(()=>{if(!e(L)||!e(j))return;Nt?.();const t=Ua(e(L),e(j),n=>a(m,n,!0),n=>a(Oe,n.message||"Connection error",!0));return Nt=t,()=>t()}),be(()=>{e(m)?.status==="completed"&&e(L)&&Jt(`/league/${e(L)}`)}),be(()=>{!e(m)||!e(F)||!e(L)||!e(j)||Aa(e(L),e(j),e(F).uid).catch(()=>{})}),be(()=>{e(L)&&e(j)&&e(T)&&Wt()}),be(()=>{const t=e(m)?.picks??[];for(const n of t)!n?.gameId||v.has(n.gameId)||tr(n.gameId).then(C=>{C&&(v.set(n.gameId,C),Or(Mt))})}),Ar(()=>{const t=Xt();if(!t||!e(L)||!e(j))return;const n=()=>{Ra(e(L),e(j),t.uid).catch(()=>{})};return window.addEventListener("beforeunload",n),window.addEventListener("pagehide",n),()=>{n(),window.removeEventListener("beforeunload",n),window.removeEventListener("pagehide",n)}});async function Wt(){if(!(!e(L)||!e(j)||!e(T)))try{const t=await fr(e(L),e(j));t?a(m,t,!0):e(Vt)&&await Oa(e(L),e(j),e(z),e(T).members),a(Oe,null)}catch(t){a(Oe,t instanceof Error?t.message:"Load failed",!0)}}async function br(){if(a(Oe,null),!!e(L))try{const t=await Rt(e(L));a(T,t,!0),t&&e(j)&&await Wt()}catch(t){a(Oe,t instanceof Error?t.message:"Load failed",!0)}}async function wr(){!e(L)||!e(j)||await Fa(e(L),e(j))}function kr(){a(Ze,!0),a(q,"type"),a(at,!1),a(ke,null),a(O,null),a(Ie,null),a(Qe,""),a(Ce,[],!0),a(je,!1),a(gt,"")}function yr(t){a(ke,t,!0),a(q,"game"),a(Re,e(Qe),!0)}function Pr(t){if(!t?.trim())return"?";const n=t.trim().split(/\s+/);return n.length===1?n[0].slice(0,2).toUpperCase():(n[0][0]+n[n.length-1][0]).toUpperCase()}function $r(){const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function Zt(){const t=$r(),n=parseInt(e(me)),C=`${n}-12-31`;if(e(ke)==="seasonalPick"){const H=aa(e(z),n);return{releaseFrom:H.start>t?H.start:t,releaseTo:H.end}}return{releaseFrom:t,releaseTo:C}}async function Gt(){const t=parseInt(e(me)),n=e(Qe).trim()||void 0,{releaseFrom:C,releaseTo:H}=Zt(),J=e(Ce).length?e(Ce):void 0,G={search:n,releaseFrom:C,releaseTo:H,genres:J};e(je)&&(G.bookmarkedOnly=!0,G.bookmarkedIds=e(Ge)),a(st,!0),a(ye,[],!0),a(S,0);try{const{games:X,total:ee}=await rr(t,U,0,G);a(ye,X,!0),a(S,ee,!0)}finally{a(st,!1)}}async function Dr(){const t=parseInt(e(me)),n=e(Qe).trim()||void 0,{releaseFrom:C,releaseTo:H}=Zt(),J=e(Ce).length?e(Ce):void 0,G={search:n,releaseFrom:C,releaseTo:H,genres:J};if(e(je)&&(G.bookmarkedOnly=!0,G.bookmarkedIds=e(Ge)),!(e(st)||e(E)||e(ye).length>=e(S))){a(E,!0);try{const{games:X,total:ee}=await rr(t,U,e(ye).length,G);a(ye,[...e(ye),...X],!0),a(S,ee,!0)}finally{a(E,!1)}}}be(()=>{if(e(q)!=="game"||e(Qe)===e(Re))return;const t=e(Qe),n=setTimeout(()=>{a(Re,t,!0),Gt()},300);return()=>clearTimeout(n)}),be(()=>{if(e(q)!=="game")return;const t=parseInt(e(me));if(!t||Number.isNaN(t)){a(Ct,[],!0);return}ia(t).then(n=>a(Ct,n,!0))}),be(()=>{e(q)==="game"&&(e(Ce),e(je),Gt())}),be(()=>{e(q)!=="game"||!e(F)||ua(e(F).uid).then(t=>a(Ge,t,!0))}),be(()=>{const t=e(oe);if(!t)return;const n=new IntersectionObserver(C=>{const[H]=C;H?.isIntersecting&&e(q)==="game"&&e(ye).length>0&&e(ye).length<e(S)&&!e(E)&&!e(st)&&Dr()},{rootMargin:"100px",threshold:0});return n.observe(t),()=>n.disconnect()});async function Sr(){if(!e(F)||!e(O)){console.log("handleToggleBookmark: not me or selectedGameId"),console.log("me",e(F)),console.log("selectedGameId",e(O));return}e(Ge).has(e(O))?(await ga(e(F).uid,e(O)),a(Ge,new Set([...e(Ge)].filter(n=>n!==e(O))),!0)):(await ha(e(F).uid,e(O)),a(Ge,new Set([...e(Ge),e(O)]),!0)),e(je)&&Gt()}async function Qt(t){a(O,t,!0),a(ot,!0),a(Ie,null),a(at,!0);try{if(v.has(t))a(Ie,v.get(t),!0);else{const n=await tr(t);n&&(v.set(t,n),a(Ie,n,!0))}e(Ie)&&(a(O,e(Ie).id,!0),a(ft,e(Ie).name,!0))}finally{a(ot,!1)}}async function Lr(){if(!(!e(F)||!e(L)||!e(j)||!e(O)||!e(ke))){if(await la(e(O))){a(gt,"That game cannot be drafted.");return}a(yt,!0),a(at,!1);try{await Ma(e(L),e(j),e(F).uid,e(O),e(ke)),a(Ze,!1)}catch(t){a(gt,t instanceof Error?t.message:"Pick failed",!0)}finally{a(yt,!1)}}}function Tr(t){if(!t)return"—";const n=new Date(t);return isNaN(n.getTime())?t:n.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}const Ir={seasonalPick:{label:"Seasonal",icon:Ea,color:"text-sky-400",borderHover:"hover:border-sky-400/50 hover:bg-sky-400/10"},hitPick:{label:"Hit",icon:Ba,color:"text-accent",borderHover:"hover:border-accent/50 hover:bg-accent/10"},bombPick:{label:"Bomb",icon:Ga,color:"text-destructive",borderHover:"hover:border-destructive/50 hover:bg-destructive/10"},altPick:{label:"Alt",icon:Ca,color:"text-purple-400",borderHover:"hover:border-purple-400/50 hover:bg-purple-400/10"}};function Cr(t){return t==="seasonalPick"?`Pick a game releasing in the ${e(Ke)?.label??""} window`:t==="hitPick"?"Your GOTY prediction — the best performer this year":t==="bombPick"?"A game you think will flop — hurts other players if it bombs":t==="altPick"?"Backup pick — activates if one of your games is delisted from Steam":""}const _t=Ir;function Gr(t,n,C){if(e(Mt),!e(m)||!e(T))return null;const H=e(T).members.length;let J;t%2===0?J=t*H+n:J=t*H+(H-1-n);const G=e(m).picks[J],X=Ft(e(m).order,e(m).currentPick?.round??0),ee=!!e(m).currentPick&&e(m).currentPick.round===t+1&&X[e(m).currentPick.position]===C;let Je,nt;if(G){const Fe=v.get(G.gameId);Je=Fe?.coverUrl??void 0,nt=Fe?.name??""}const xt=er(e(z),t+1,e(Pt));return{pick:G,isCurrent:ee,pickIndex:J,coverUrl:Je,gameName:nt,roundPickType:xt}}var Bt=Es();Hr("1glbubq",t=>{Nr(()=>{Mr.title=e(T)?.name?`${e(T).name} – ${e(Ke)?.label??""} Draft`:"Draft Room"})});var Kt=o(Bt);{var Br=t=>{var n=za(),C=o(n),H=o(C,!0);r(C);var J=i(C,2);rt(J,{variant:"outline",onclick:br,children:(G,X)=>{Ee();var ee=Te("Retry");s(G,ee)},$$slots:{default:!0}}),r(n),$(()=>y(H,e(Oe))),s(t,n)},Er=t=>{var n=Ae(),C=B(n);{var H=G=>{var X=Ha(),ee=o(X);nr(ee,{class:"h-8 w-8 animate-spin text-primary"}),Ee(2),r(X),s(G,X)},J=G=>{var X=us(),ee=B(X),Je=o(ee),nt=o(Je);rt(nt,{variant:"ghost",size:"icon",onclick:()=>Jt(`/league/${e(L)}`),class:"h-8 w-8 shrink-0 text-muted-foreground hover:text-foreground",children:(c,h)=>{or(c,{class:"h-4 w-4"})},$$slots:{default:!0}});var xt=i(nt,2),Fe=o(xt),it=o(Fe),St=o(it,!0);r(it);var Et=i(it,2);xa(Et,{variant:"outline",class:"shrink-0 text-[10px]",children:(c,h)=>{Ee();var te=Te();$(()=>y(te,`${e(Ke)?.label??""??""} Draft`)),s(c,te)},$$slots:{default:!0}}),r(Fe);var Lt=i(Fe,2),bt=o(Lt);{var jt=c=>{var h=Va();s(c,h)},Ut=c=>{var h=Ya(),te=o(h);r(h),$(()=>y(te,`Status: ${e(m).status??""}`)),s(c,h)};b(bt,c=>{e(m).status==="active"?c(jt):c(Ut,!1)})}var Tt=i(bt,2);{var ne=c=>{var h=qa();s(c,h)};b(Tt,c=>{!e(xr)&&e(m).status==="active"&&c(ne)})}var pe=i(Tt,2),Ne=o(pe);r(pe),r(Lt),r(xt),r(Je);var Me=i(Je,2);{var ie=c=>{{let h=u(()=>!e(_r));rt(c,{onclick:wr,get disabled(){return e(h)},class:"glow-sm-primary gap-2",children:(te,W)=>{var Pe=Wa(),Z=B(Pe);da(Z,{class:"h-4 w-4"}),Ee(),s(te,Pe)},$$slots:{default:!0}})}};b(Me,c=>{e(Vt)&&e(m).status==="pending"&&c(ie)})}r(ee);var ge=i(ee,2);{var Ue=c=>{var h=Ja(),te=o(h),W=o(te),Pe=o(W);ir(Pe,{class:"h-6 w-6 text-primary"}),r(W);var Z=i(W,4),He=o(Z);{var Ve=A=>{var re=Te();$(()=>y(re,`Waiting for ${e(Dt).length??""} ${e(Dt).length===1?"player":"players"}`)),s(A,re)},Xe=A=>{var re=Te("Everyone is here! The commissioner can start the draft.");s(A,re)};b(He,A=>{e(Dt).length>0?A(Ve):A(Xe,!1)})}r(Z);var he=i(Z,2);et(he,21,()=>e(T).members,tt,(A,re)=>{const Ye=u(()=>!e(Dt).includes(e(re)));var Q=Ka(),$e=o(Q),De=o($e,!0);r($e);var lt=i($e,2);{var qe=V=>{var d=Za();s(V,d)},We=V=>{var d=Qa();s(V,d)};b(lt,V=>{e(Ye)?V(qe):V(We,!1)})}r(Q),$(V=>{ut(Q,1,`flex items-center justify-between rounded-lg border px-3 py-2 transition-colors ${e(Ye)?"border-accent/30 bg-accent/[0.06]":"border-white/[0.06] bg-white/[0.02]"}`),y(De,V)},[()=>$t(e(re))||"…"]),s(A,Q)}),r(he),r(te),r(h),s(c,h)},ze=c=>{var h=ds(),te=o(h);ar(te,{class:"min-h-0 flex-1",orientation:"both",children:(W,Pe)=>{var Z=cs(),He=B(Z),Ve=i(o(He),2);et(Ve,17,()=>e(T).members,tt,(he,A)=>{const re=u(()=>e(F)?.uid===e(A)),Ye=u(()=>e(ht)===e(A));var Q=Xa(),$e=o(Q);we($e,()=>Ia,(qe,We)=>{We(qe,{class:"h-7 w-7 shrink-0",children:(V,d)=>{var f=Ae(),w=B(f);{let N=u(()=>e(re)?"bg-primary text-primary-foreground":"");we(w,()=>Ta,(Y,M)=>{M(Y,{get class(){return`text-[10px] ${e(N)??""}`},children:(_e,le)=>{Ee();var Se=Te();$(Be=>y(Se,Be),[()=>Pr($t(e(A)))]),s(_e,Se)},$$slots:{default:!0}})})}s(V,f)},$$slots:{default:!0}})});var De=i($e,2),lt=o(De,!0);r(De),r(Q),$((qe,We)=>{ut(Q,1,`flex min-w-[160px] flex-1 items-center justify-center gap-2 rounded-lg border px-2 py-2 transition-all sm:min-w-[180px] ${e(Ye)?"glow-sm-primary border-primary/30 bg-primary/[0.08]":"border-white/[0.06] bg-white/[0.03]"}`),ut(De,1,`truncate text-sm font-medium ${e(re)?"text-primary":""}`),It(De,"title",qe),y(lt,We)},[()=>$t(e(A))||void 0,()=>$t(e(A))||"…"]),s(he,Q)}),r(He);var Xe=i(He,2);et(Xe,21,()=>Array(e(gr)),tt,(he,A,re)=>{const Ye=u(()=>er(e(z),re+1,e(Pt))),Q=u(()=>_t[e(Ye)]);var $e=ls(),De=o($e),lt=o(De);{var qe=V=>{const d=u(()=>e(Q).icon);var f=es(),w=B(f);we(w,()=>e(d),(M,_e)=>{_e(M,{get class(){return`h-4 w-4 ${e(Q).color??""}`}})});var N=i(w,2),Y=o(N,!0);r(N),$(()=>y(Y,e(Q).label)),s(V,f)};b(lt,V=>{e(Q)&&V(qe)})}r(De);var We=i(De,2);et(We,17,()=>e(T).members,tt,(V,d,f)=>{const w=u(()=>Gr(re,f,e(d))),N=u(()=>e(F)?.uid===e(d)),Y=u(()=>e(w)?.isCurrent),M=u(()=>!!e(w)?.pick),_e=u(()=>e(ht)===e(d));var le=is(),Se=o(le);{var Be=k=>{const x=u(()=>_t[e(w).pick.pickType]||{icon:ja,color:"text-gray-500",label:"?"}),R=u(()=>e(x).icon);var p=as(),D=o(p),I=o(D);we(I,()=>e(R),(xe,ue)=>{ue(xe,{get class(){return`h-4 w-4 ${e(x).color??""}`}})});var ae=i(I,2),Le=o(ae,!0);r(ae),r(D);var ce=i(D,2),K=o(ce);{var se=xe=>{var ue=ts(),dt=B(ue),mt=i(dt,4),At=o(mt,!0);r(mt),$(()=>{It(dt,"src",e(w).coverUrl),y(At,e(w).gameName||"…")}),s(xe,ue)},de=xe=>{var ue=rs(),dt=o(ue),mt=o(dt,!0);r(dt),r(ue),$(()=>y(mt,e(w).gameName||"…")),s(xe,ue)};b(K,xe=>{e(w).coverUrl?xe(se):xe(de,!1)})}r(ce),r(p),$(()=>y(Le,e(x).label)),s(k,p)},ct=k=>{var x=Ae(),R=B(x);{var p=D=>{var I=ns(),ae=o(I);{var Le=K=>{rt(K,{size:"sm",onclick:kr,class:"glow-primary gap-1.5 font-semibold",children:(se,de)=>{var xe=ss(),ue=B(xe);ir(ue,{class:"h-3.5 w-3.5"}),Ee(),s(se,xe)},$$slots:{default:!0}})},ce=K=>{var se=os();s(K,se)};b(ae,K=>{e(N)&&e(qt)?K(Le):K(ce,!1)})}r(I),s(D,I)};b(R,D=>{e(Y)&&D(p)},!0)}s(k,x)};b(Se,k=>{e(M)&&e(w)?.pick?k(Be):k(ct,!1)})}r(le),$(()=>ut(le,1,`group relative min-h-[90px] min-w-[160px] flex-1 overflow-hidden rounded-lg border transition-all sm:min-h-[100px] sm:min-w-[180px]
										${e(Y)?"animate-glow-pulse border-primary/50 ring-1 ring-primary/30":"border-white/[0.06]"}
										${e(_e)&&!e(Y)?"bg-primary/[0.03]":e(M)?"bg-card/50":"bg-white/[0.01]"}`)),s(V,le)}),r($e),s(he,$e)}),r(Xe),s(W,Z)},$$slots:{default:!0}}),r(h),s(c,h)};b(ge,c=>{e(m).status==="pending"?c(Ue):c(ze,!1)})}$((c,h)=>{y(St,e(T).name||""),y(Ne,`${c??""} — ${h??""}`)},[()=>e(Ke)?.releaseStart(parseInt(e(me))).slice(5),()=>e(Ke)?.releaseEnd(parseInt(e(me))).slice(5)]),s(G,X)};b(C,G=>{!e(T)||!e(m)?G(H):G(J,!1)},!0)}s(t,n)};b(Kt,t=>{e(Oe)?t(Br):t(Er,!1)})}var jr=i(Kt,2);we(jr,()=>ma,(t,n)=>{n(t,{get open(){return e(Ze)},set open(C){a(Ze,C,!0)},children:(C,H)=>{var J=Ae(),G=B(J);{let X=u(()=>e(q)==="type"?"w-auto max-w-md sm:max-w-md":"h-[90vh] w-[90vw] max-w-none sm:max-w-none");we(G,()=>va,(ee,Je)=>{Je(ee,{get class(){return`flex flex-col gap-0 overflow-hidden p-0 ${e(X)??""}`},children:(nt,xt)=>{var Fe=Bs(),it=B(Fe),St=o(it);we(St,()=>fa,(ne,pe)=>{pe(ne,{class:"text-lg font-semibold",children:(Ne,Me)=>{var ie=Ae(),ge=B(ie);{var Ue=c=>{var h=Te("Select Pick Type");s(c,h)},ze=c=>{var h=Te("Select Game");s(c,h)};b(ge,c=>{e(q)==="type"?c(Ue):c(ze,!1)})}s(Ne,ie)},$$slots:{default:!0}})});var Et=i(St,2);{var Lt=ne=>{rt(ne,{variant:"ghost",size:"sm",class:"mt-1 flex items-center gap-1 text-xs text-muted-foreground",onclick:()=>{a(at,!1),a(q,"type")},children:(pe,Ne)=>{var Me=vs(),ie=B(Me);or(ie,{class:"h-3 w-3"}),Ee(),s(pe,Me)},$$slots:{default:!0}})};b(Et,ne=>{e(q)!=="type"&&ne(Lt)})}r(it);var bt=i(it,2),jt=o(bt);{var Ut=ne=>{var pe=ms(),Ne=o(pe);et(Ne,21,()=>e(hr),tt,(Me,ie)=>{const ge=u(()=>_t[e(ie)]);var Ue=Ae(),ze=B(Ue);{var c=h=>{const te=u(()=>e(ge).icon);var W=fs();W.__click=()=>yr(e(ie));var Pe=o(W);we(Pe,()=>e(te),(he,A)=>{A(he,{get class(){return`size-9 ${e(ge).color??""} transition-transform group-hover:scale-110`}})});var Z=i(Pe,2),He=o(Z,!0);r(Z);var Ve=i(Z,2),Xe=o(Ve,!0);r(Ve),r(W),$(he=>{ut(W,1,`group flex cursor-pointer flex-col items-center justify-center gap-3 rounded-xl border-2 border-white/[0.06] bg-white/[0.02] p-5 transition-all ${e(ge).borderHover??""}`),ut(Z,1,`text-base font-bold ${e(ge).color??""}`),y(He,e(ge).label),y(Xe,he)},[()=>Cr(e(ie))]),s(h,W)};b(ze,h=>{e(ge)&&h(c)})}s(Me,Ue)}),r(Ne),r(pe),s(ne,pe)},Tt=ne=>{var pe=Ae(),Ne=B(pe);{var Me=ie=>{var ge=Gs(),Ue=B(ge),ze=o(Ue),c=o(ze),h=o(c);ba(h,{class:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"});var te=i(h,2);_a(te,{placeholder:"Search games...",class:"pl-9",autofocus:!0,get value(){return e(Qe)},set value(d){a(Qe,d,!0)}}),r(c);var W=i(c,2),Pe=o(W),Z=o(Pe);wa(Z,{class:"h-3.5 w-3.5 shrink-0 text-muted-foreground"});var He=i(Z,2);we(He,()=>ka,(d,f)=>{f(d,{type:"multiple",get value(){return e(Ce)},set value(w){a(Ce,w,!0)},children:(w,N)=>{var Y=ps(),M=B(Y);we(M,()=>ya,(le,Se)=>{Se(le,{class:"h-8 max-w-[140px] min-w-0 border-white/[0.08] bg-white/[0.04] text-xs",children:(Be,ct)=>{Ee();var k=Te();$(()=>y(k,e(Ce).length>1?`${e(Ce).length} genres`:e(Ce)[0]??"Genre")),s(Be,k)},$$slots:{default:!0}})});var _e=i(M,2);we(_e,()=>Pa,(le,Se)=>{Se(le,{children:(Be,ct)=>{var k=Ae(),x=B(k);et(x,17,()=>e(Ct),tt,(R,p)=>{var D=Ae(),I=B(D);we(I,()=>$a,(ae,Le)=>{Le(ae,{get value(){return e(p)},get label(){return e(p)},children:(ce,K)=>{Ee();var se=Te();$(()=>y(se,e(p))),s(ce,se)},$$slots:{default:!0}})}),s(R,D)}),s(Be,k)},$$slots:{default:!0}})}),s(w,Y)},$$slots:{default:!0}})}),r(Pe);var Ve=i(Pe,2);{var Xe=d=>{var f=gs();f.__click=()=>a(je,!e(je));var w=o(f),N=o(w);{var Y=M=>{La(M,{class:"h-2 w-2"})};b(N,M=>{e(je)&&M(Y)})}r(w),Ee(2),r(f),$(()=>{It(f,"aria-checked",e(je)),ut(w,1,`flex size-3.5 shrink-0 items-center justify-center rounded border border-white/[0.08] bg-white/[0.04] transition-colors ${e(je)?"border-primary bg-primary text-primary-foreground":""}`)}),s(d,f)};b(Ve,d=>{e(F)&&d(Xe)})}var he=i(Ve,2),A=o(he);{let d=u(()=>e(pt)==="table"?"secondary":"ghost");rt(A,{get variant(){return e(d)},size:"icon",class:"h-7 w-7",onclick:()=>a(pt,"table"),"aria-label":"Table view",children:(f,w)=>{Da(f,{class:"h-3.5 w-3.5"})},$$slots:{default:!0}})}var re=i(A,2);{let d=u(()=>e(pt)==="grid"?"secondary":"ghost");rt(re,{get variant(){return e(d)},size:"icon",class:"h-7 w-7",onclick:()=>a(pt,"grid"),"aria-label":"Grid view",children:(f,w)=>{Sa(f,{class:"h-3.5 w-3.5"})},$$slots:{default:!0}})}r(he),r(W);var Ye=i(W,2),Q=o(Ye);{var $e=d=>{var f=Te();$((w,N)=>y(f,`Showing ${e(Ke)?.label??""??""} games (${w??""} — ${N??""})`),[()=>e(Ke)?.releaseStart(parseInt(e(me))).slice(5),()=>e(Ke)?.releaseEnd(parseInt(e(me))).slice(5)]),s(d,f)},De=d=>{var f=Te();$(()=>y(f,`All unreleased games for ${e(me)??""}`)),s(d,f)};b(Q,d=>{e(ke)==="seasonalPick"?d($e):d(De,!1)})}r(Ye),r(ze);var lt=i(ze,2);{var qe=d=>{var f=hs(),w=o(f);nr(w,{class:"animate-spin text-primary"}),r(f),s(d,f)},We=d=>{ar(d,{class:"min-h-0 flex-1",get viewportRef(){return e(Ht)},set viewportRef(f){a(Ht,f,!0)},children:(f,w)=>{var N=Ls(),Y=o(N);{var M=k=>{var x=xs();et(x,21,()=>e(Yt),tt,(R,p)=>{var D=_s();D.__click=()=>Qt(e(p).id);var I=o(D),ae=o(I);{var Le=de=>{sr(de,{class:"h-3.5 w-3.5 shrink-0 text-yellow-400"})};b(ae,de=>{e(Ge).has(e(p).id)&&de(Le)})}var ce=i(ae);r(I);var K=i(I,2),se=o(K,!0);r(K),r(D),$(de=>{y(ce,` ${e(p).name??""}`),y(se,de)},[()=>Tr(e(p).releaseDate)]),s(R,D)}),r(x),s(k,x)},_e=k=>{var x=$s();et(x,21,()=>e(Yt),tt,(R,p)=>{var D=Ps();D.__click=()=>Qt(e(p).id);var I=o(D);{var ae=ve=>{var fe=bs();$(()=>It(fe,"src",e(p).coverUrl)),s(ve,fe)},Le=ve=>{var fe=ws(),wt=o(fe,!0);r(fe),$(()=>y(wt,e(p).name)),s(ve,fe)};b(I,ve=>{e(p).coverUrl?ve(ae):ve(Le,!1)})}var ce=i(I,2);{var K=ve=>{var fe=ks(),wt=o(fe);sr(wt,{class:"h-4 w-4 text-yellow-400"}),r(fe),s(ve,fe)};b(ce,ve=>{e(Ge).has(e(p).id)&&ve(K)})}var se=i(ce,2),de=o(se),xe=o(de,!0);r(de);var ue=i(de,2),dt=o(ue,!0);r(ue);var mt=i(ue,2);{var At=ve=>{var fe=ys(),wt=o(fe);r(fe),$(Ur=>y(wt,`Score: ${Ur??""}`),[()=>Math.round(e(p).score).toLocaleString()]),s(ve,fe)};b(mt,ve=>{e(p).score!=null&&ve(At)})}r(se),r(D),$(()=>{y(xe,e(p).name),y(dt,e(p).releaseDate??"TBA")}),s(R,D)}),r(x),s(k,x)};b(Y,k=>{e(pt)==="table"?k(M):k(_e,!1)})}var le=i(Y,2);Vr(le,k=>a(oe,k),()=>e(oe));var Se=i(le,2);{var Be=k=>{var x=Ds();s(k,x)},ct=k=>{var x=Ae(),R=B(x);{var p=D=>{var I=Ss(),ae=o(I);r(I),$(()=>y(ae,`${e(ye).length??""} of ${e(S)??""}`)),s(D,I)};b(R,D=>{e(ye).length>0&&e(ye).length<e(S)&&D(p)},!0)}s(k,x)};b(Se,k=>{e(E)?k(Be):k(ct,!1)})}r(N),s(f,N)},$$slots:{default:!0}})};b(lt,d=>{e(st)?d(qe):d(We,!1)})}r(Ue);var V=i(Ue,2);{const d=N=>{var Y=Cs(),M=B(Y),_e=o(M),le=o(_e);{var Se=x=>{const R=u(()=>_t[e(ke)]),p=u(()=>e(R).icon);var D=Ts(),I=B(D),ae=o(I);we(ae,()=>e(p),(se,de)=>{de(se,{get class(){return`h-5 w-5 ${e(R).color??""}`}})}),r(I);var Le=i(I,2),ce=i(o(Le),2),K=o(ce);r(ce),r(Le),$(()=>y(K,`${e(R).label??""} Pick`)),s(x,D)};b(le,x=>{e(ke)&&_t[e(ke)]&&x(Se)})}r(_e);var Be=i(_e,2);rt(Be,{size:"lg",onclick:Lr,get disabled(){return e(yt)},class:"glow-sm-primary px-6",children:(x,R)=>{Ee();var p=Te();$(()=>y(p,e(yt)?"Submitting...":"Confirm Pick")),s(x,p)},$$slots:{default:!0}}),r(M);var ct=i(M,2);{var k=x=>{var R=Is(),p=o(R,!0);r(R),$(()=>y(p,e(gt))),s(x,R)};b(ct,x=>{e(gt)&&x(k)})}s(N,Y)};let f=u(()=>e(O)!=null&&!e(ot)&&e(Ie)==null),w=u(()=>e(O)!=null&&e(Ge).has(e(O)));pa(V,{get open(){return e(at)},onOpenChange:N=>a(at,N,!0),get game(){return e(Ie)},get loading(){return e(ot)},get showNotFound(){return e(f)},get isBookmarked(){return e(w)},onToggleBookmark:Sr,footer:d,$$slots:{footer:!0}})}s(ie,ge)};b(Ne,ie=>{e(q)==="game"&&ie(Me)},!0)}s(ne,pe)};b(jt,ne=>{e(q)==="type"?ne(Ut):ne(Tt,!1)})}r(bt),s(nt,Fe)},$$slots:{default:!0}})})}s(C,J)},$$slots:{default:!0}})}),r(Bt),s(g,Bt),Fr()}zr(["click"]);export{co as component};
