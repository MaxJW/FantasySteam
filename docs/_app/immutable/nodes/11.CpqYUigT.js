import{a as s,f as l,c as Ae,t as Ie}from"../chunks/Cz0PwdDH.js";import{o as Fr}from"../chunks/yq7IrD91.js";import{p as Nr,b as g,v as $t,u as me,s as a,g as e,P as Mr,a as zr,Q as u,R as Hr,$ as Wr,c as o,d as i,f as B,r,n as Ue,t as D}from"../chunks/Ct8wem7Y.js";import{d as Vr,s as k}from"../chunks/CIvy6oFH.js";import{i as x,a as Yr,b as qr}from"../chunks/Bfs_sO9o.js";import{b as st,i as ot,s as ft,d as Bt}from"../chunks/BGhj1fUa.js";import{c as ye}from"../chunks/bAwpQOpp.js";import{h as Zr,B as nt}from"../chunks/Dijvr1QR.js";import{b as Qr}from"../chunks/D_ppcZRu.js";import{g as Nt}from"../chunks/DuG5eIWq.js";import{p as Kr}from"../chunks/dUlbVIi0.js";import{g as Jr}from"../chunks/Dphw77Gg.js";import{k as Xr,u as Ht,l as ur,d as vr,h as ea,i as ta,m as ra,r as aa,T as sa,f as oa,g as na,c as ia}from"../chunks/CUsvRYbg.js";import{f as fr,h as la,i as mr,p as ca,j as da,k as ua,P as va,l as ar}from"../chunks/nK_5IJdR.js";import{d as mt,t as fa,a as Mt,b as ma}from"../chunks/DvyQ2pgq.js";import{a as sr,b as pa,c as or,i as ga}from"../chunks/Z1YjaJz3.js";import{g as ha,P as _a}from"../chunks/B_1bKy9M.js";import{g as xa,D as ba,a as wa,b as ka,G as ya,S as nr,B as ir,r as $a,c as Pa}from"../chunks/Bol6bMNE.js";import{I as Da}from"../chunks/aVuIq0C4.js";import{B as Sa}from"../chunks/5Ywcp8Rj.js";import{S as La,T as Ta,a as Ia,b as Ca,c as Ga,d as Ba,L as Ea,e as Ua,C as ja}from"../chunks/BXhAa4ib.js";import{A as Ra,a as Aa}from"../chunks/BilSgz2m.js";import{A as lr}from"../chunks/ZM-ulDmt.js";import{S as Oa,B as Fa,T as Na}from"../chunks/DU7lnnFl.js";import{S as Ma}from"../chunks/DkoLoA3y.js";import{L as cr}from"../chunks/BdeNKjxe.js";import{Z as dr}from"../chunks/0FzaBMSc.js";import{C as za}from"../chunks/Bojz6cgv.js";function pr(m,y,h,A){const U=(m??[]).filter(pe=>pe.userId===y),I=U.length;return A==="winter"?I===0?["hitPick","bombPick"]:I===1?U[0].pickType==="hitPick"?["bombPick"]:["hitPick"]:I<2+h?["seasonalPick"]:I===2+h?["altPick"]:[]:I<h?["seasonalPick"]:I===h?["altPick"]:[]}async function zt(m,y){const h=await vr(mt(m,y));return h.exists()?{id:h.id,...h.data()}:null}function Ha(m,y,h,A){return Xr(mt(m,y),U=>{if(!U.exists()){h(null);return}h({id:U.id,...U.data()})},U=>{A?.(U)})}function Wt(m,y){return y%2===0?[...m].reverse():m}function gr(m){const y=m.currentPick;return y?Wt(m.order,y.round)[y.position]??null:null}async function Wa(m,y,h){await Ht(mt(m,y),{presentUserIds:ur(h)})}async function Va(m,y,h){await Ht(mt(m,y),{presentUserIds:ra(h)})}async function Ya(m,y,h,A){await ea(mt(m,y),{status:"pending",phase:h,order:A,currentPick:null,picks:[],presentUserIds:[],createdAt:ta()})}async function qa(m,y){const h=mt(m,y),A=await vr(h);if(!A.exists())throw new Error("Draft not found");const I={round:1,position:0,userId:A.data().order[0]??"",expiresAt:null};await Ht(h,{status:"active",currentPick:I})}function Za(m,y,h,A){const I=mr(h,A)*m.length;if(y>=I)return null;const pe=Math.floor(y/m.length)+1,ge=y%m.length,it=Wt(m,pe)[ge];return it?{round:pe,position:ge,userId:it,expiresAt:null}:null}async function Qa(m,y,h,A,U){const I=mt(m,y),pe=fa(m,h),ge=await Mt(m);if(!ge)throw new Error("League not found");const Oe=fr(ge.members.length);await aa(oa,async he=>{const $=await he.get(I),E=await he.get(pe);if(!$.exists())throw new Error("Draft does not exist");const M=$.data(),V=M.phase,L=gr(M);if(L!==h)throw new Error(`It is not your turn. Waiting for ${L}.`);if(M.picks.some(Fe=>Fe.gameId===A))throw new Error("This game has already been drafted.");if(!pr(M.picks,h,Oe,V).includes(U))throw new Error(`You cannot make a ${U} right now.`);const pt={userId:h,gameId:A,pickType:U,timestamp:sa.now()};if(he.update(I,{picks:ur(pt)}),E.exists()){const Xe=E.data().picks??{};if(U==="hitPick")he.update(pe,{"picks.hitPick":A});else if(U==="bombPick")he.update(pe,{"picks.bombPick":A});else if(U==="seasonalPick"){const Ne=la(V),Ce=[...Xe[Ne]??[],A];he.update(pe,{[`picks.${Ne}`]:Ce})}else if(U==="altPick"){const Ne=[...Xe.altPicks??[],A];he.update(pe,{"picks.altPicks":Ne})}}const Y=Za(M.order,M.picks.length+1,V,Oe);Y?he.update(I,{currentPick:Y}):he.update(I,{currentPick:null,status:"completed"})}),(await zt(m,y))?.status==="completed"&&await ma(m)}var Ka=l('<div class="flex h-full flex-col items-center justify-center gap-4"><p class="text-sm text-destructive"> </p> <!></div>'),Ja=l('<div class="flex h-full flex-col items-center justify-center gap-3"><!> <p class="text-sm text-muted-foreground">Loading draft room...</p></div>'),Xa=l('<span class="flex items-center gap-1.5 font-medium text-red-400"><span class="relative flex h-2 w-2"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex h-2 w-2 rounded-full bg-red-400"></span></span> LIVE</span>'),es=l("<span> </span>"),ts=l('<span class="font-medium text-yellow-500">Current picker away</span>'),rs=l("<!> Start Draft",1),as=l('<span class="flex h-2 w-2 rounded-full bg-accent"></span>'),ss=l('<span class="flex h-2 w-2 animate-pulse rounded-full bg-muted-foreground/40"></span>'),os=l('<div><span class="max-w-[110px] truncate text-sm font-medium"> </span> <!></div>'),ns=l('<div class="flex flex-1 items-center justify-center"><div class="glass w-full max-w-md rounded-xl p-6 text-center"><div class="mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10"><!></div> <h2 class="text-lg font-semibold">Waiting for Players</h2> <p class="mt-1 text-sm text-muted-foreground"><!></p> <div class="mt-5 grid grid-cols-2 gap-2"></div></div></div>'),is=l("<div><!> <p> </p></div>"),ls=l('<!> <span class="mt-0.5 text-[9px] font-semibold tracking-tight text-muted-foreground uppercase"> </span>',1),cs=l('<img alt="" class="absolute inset-0 h-full w-full object-cover"/> <div class="absolute inset-0 bg-linear-to-t from-black/80 via-black/20 to-transparent"></div> <span class="absolute right-1 bottom-1 left-1.5 line-clamp-2 text-[10px] leading-tight font-medium text-white"> </span>',1),ds=l('<div class="flex h-full w-full items-center justify-center p-1.5 text-center"><span class="line-clamp-3 text-[10px] font-medium text-muted-foreground"> </span></div>'),us=l('<div class="absolute inset-0 flex"><div class="flex w-1/3 flex-col items-center justify-center gap-1 border-r border-white/6 bg-white/2"><!> <span class="text-[8px] font-semibold tracking-tight text-muted-foreground uppercase"> </span></div> <div class="relative flex w-2/3 items-center justify-center overflow-hidden"><!></div></div>'),vs=l("<!> Make Pick",1),fs=l('<div class="flex flex-col items-center gap-1"><div class="h-1.5 w-1.5 animate-ping rounded-full bg-primary"></div> <span class="text-[10px] font-medium text-muted-foreground">Picking...</span></div>'),ms=l('<div class="absolute inset-0 flex items-center justify-center"><!></div>'),ps=l("<div><!></div>"),gs=l('<div class="flex min-w-max gap-2"><div class="flex w-16 shrink-0 flex-col items-center justify-center text-center sm:w-20"><!></div> <!></div>'),hs=l('<div class="sticky top-0 z-10 flex min-w-max gap-2 border-b border-white/6 p-2 backdrop-blur" style="background: oklch(0.15 0.03 250 / 0.9)"><div class="flex w-16 shrink-0 items-center justify-center sm:w-20"></div> <!></div> <div class="flex flex-col gap-2 p-2"></div>',1),_s=l('<div class="flex flex-1 flex-col overflow-hidden rounded-xl border border-white/6 bg-card/30"><!></div>'),xs=l('<div class="flex shrink-0 flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"><div class="flex items-center gap-2"><!> <div class="min-w-0"><div class="flex flex-wrap items-center gap-2"><h1 class="truncate text-lg font-bold tracking-tight sm:text-xl"> </h1> <!></div> <div class="flex flex-wrap items-center gap-3 text-xs text-muted-foreground"><!> <!> <span> </span></div></div></div> <!></div> <!>',1),bs=l("<!> Back",1),ws=l('<button><!> <span> </span> <span class="text-center text-[11px] leading-relaxed text-muted-foreground"> </span></button>'),ks=l('<div class="overflow-y-auto p-5"><div class="grid grid-cols-2 gap-3"></div></div>'),ys=l("<!> <!>",1),$s=l('<button type="button" role="checkbox" aria-label="Bookmarked only" class="flex h-8 shrink-0 cursor-pointer items-center gap-2 rounded-md border border-white/8 bg-white/4 px-3 text-xs transition-colors hover:bg-white/6"><span><!></span> <span class="text-foreground">Bookmarked</span></button>'),Ps=l('<div class="flex flex-1 items-center justify-center"><!></div>'),Ds=l('<button class="flex w-full cursor-pointer items-center justify-between rounded-lg px-3 py-2.5 text-left transition-colors hover:bg-white/4"><span class="flex items-center gap-2 text-sm font-medium"><!> </span> <span class="shrink-0 pl-3 font-mono text-xs text-muted-foreground"> </span></button>'),Ss=l('<div class="grid grid-cols-1 gap-0.5"></div>'),Ls=l('<img alt="" class="absolute inset-0 h-full w-full object-cover transition-transform duration-300 group-hover:scale-[1.03]" loading="lazy" width="264" height="396"/>'),Ts=l('<div class="flex h-full w-full items-center justify-center p-3 text-center text-sm text-muted-foreground"> </div>'),Is=l('<div class="absolute top-2 right-2 rounded-full bg-black/60 p-1" aria-hidden="true"><!></div>'),Cs=l('<span class="mt-0.5 font-mono text-[10px] text-white/80"> </span>'),Gs=l('<button type="button" class="group relative aspect-2/3 w-full cursor-pointer overflow-hidden rounded-lg border border-white/6 bg-white/3 text-left transition-all hover:border-white/15 hover:shadow-lg hover:shadow-primary/5 focus:ring-2 focus:ring-ring focus:outline-none"><!> <!> <div class="absolute inset-x-0 bottom-0 flex min-h-[50%] flex-col justify-end bg-linear-to-t from-black/90 via-black/40 to-transparent p-3 opacity-0 transition-opacity duration-200 group-hover:opacity-100"><span class="line-clamp-2 text-sm font-medium text-white"> </span> <span class="mt-0.5 text-[10px] text-white/70"> </span> <!></div></button>'),Bs=l('<div class="grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6"></div>'),Es=l('<div class="py-3 text-center text-xs text-muted-foreground">Loading more…</div>'),Us=l('<div class="py-2 text-center text-[10px] text-muted-foreground"> </div>'),js=l('<div class="p-3"><!> <div class="h-4 w-full" role="presentation"></div> <!></div>'),Rs=l('<div class="rounded-full border border-white/8 bg-white/3 p-2"><!></div> <div><p class="text-[10px] font-semibold text-muted-foreground uppercase">Drafting as</p> <p class="text-sm font-medium"> </p></div>',1),As=l('<p class="mt-2 text-center text-sm text-destructive"> </p>'),Os=l('<div class="flex w-full items-center justify-between rounded-lg border border-white/8 bg-white/3 p-4"><div class="flex items-center gap-3"><!></div> <!></div> <!>',1),Fs=l('<div class="flex min-h-0 flex-1 flex-col"><div class="shrink-0 border-b border-white/6 px-5 py-3"><div class="relative"><!> <!></div> <div class="mt-2 flex flex-wrap items-center gap-2"><div class="flex items-center gap-2"><!> <!></div> <!> <div class="flex items-center gap-0.5 rounded-lg border border-white/8 bg-white/4 p-0.5"><!> <!></div></div> <p class="mt-2 text-[11px] text-muted-foreground"><!></p></div> <!></div> <!>',1),Ns=l('<div class="border-b border-white/6 p-5 pb-3"><!> <!></div> <div class="flex min-h-0 flex-1 flex-col overflow-hidden"><!></div>',1),Ms=l('<div class="flex h-[calc(100vh-7rem)] flex-col gap-4 md:h-[calc(100vh-8rem)]"><!> <!></div>');function _o(m,y){Nr(y,!0);const h=()=>qr(ia,"$currentUser",A),[A,U]=Yr(),I=new Map,pe=24;let ge=g(0),Oe=g(!1),it=g(void 0),he=g(""),$=g(""),E=g(""),M=g("winter"),V=g(""),L=g(null),P=g(null),pt=g(!1),Y=g("type"),Fe=g(!1),Xe=g(!1),Ne=g(!1),Ce=g(null),q=g(null),hr=g(""),Me=g(null),$e=g($t([])),et=g(""),Et=g($t([])),Ge=g($t([])),ht=g("grid"),je=g(!1),Be=g($t(new Set)),Pt=g(!1),_t=g(""),Vt=null,Yt=g(0),qt=g($t(new Map)),Zt=g(null),ze=g(null);const O=u(()=>h()??null),Qt=u(()=>!!(e(O)&&e(L)&&e(L).commissionerId===e(O).uid)),_r=u(()=>new Set((e(P)?.picks??[]).map(t=>t.gameId))),Dt=u(()=>e(L)?fr(e(L).members.length):2),xr=u(()=>mr(e(M),e(Dt))),br=u(()=>!e(O)||!e(P)||!e(Jt)?[]:pr(e(P).picks??[],e(O).uid,e(Dt),e(M))),Kt=u(()=>e($e).filter(t=>!e(_r).has(t.id)));function St(t){return e(qt).get(t)?.trim()||""}const wr=u(()=>{if(!e(L)||!e(P))return!1;const t=e(P).presentUserIds??[];return e(L).members.every(n=>t.includes(n))}),xt=u(()=>e(P)?gr(e(P)):null),Jt=u(()=>!!(e(O)&&e(xt)===e(O).uid)),kr=u(()=>!!(e(xt)&&(e(P)?.presentUserIds??[]).includes(e(xt)))),Lt=u(()=>e(L)?.members.filter(t=>!(e(P)?.presentUserIds??[]).includes(t))??[]),tt=u(()=>va[e(M)]),Tt=u(()=>e(M)&&e(V)?ua(e(M),e(V)):!1);me(()=>{const t=Jr(Kr).params;a($,t?.id??"",!0),a(E,t?.season??"",!0);const n=ca(e(E));n&&(a(M,n.phase,!0),a(V,n.season,!0))}),me(()=>{e($)&&(a(ze,null),Mt(e($)).then(t=>a(L,t,!0)).catch(t=>a(ze,t instanceof Error?t.message:"Load failed",!0)))}),me(()=>{const t=e(L)?.members;t?.length&&ha(t).then(n=>a(qt,n,!0))}),me(()=>{if(!e($)||!e(E))return;Vt?.();const t=Ha(e($),e(E),n=>a(P,n,!0),n=>a(ze,n.message||"Connection error",!0));return Vt=t,()=>t()}),me(()=>{e(P)?.status==="completed"&&e($)&&Nt(`/league/${e($)}`)}),me(()=>{!e(P)||!e(O)||!e($)||!e(E)||Wa(e($),e(E),e(O).uid).catch(()=>{})}),me(()=>{e($)&&e(E)&&e(L)&&e(Tt)&&Xt()}),me(()=>{!e($)||!e(M)||!e(V)||e(Tt)||zt(e($),e(E)).then(t=>{t||Nt(`/league/${e($)}`)})}),me(()=>{const t=e(P)?.picks??[];for(const n of t)!n?.gameId||I.has(n.gameId)||sr(n.gameId).then(C=>{C&&(I.set(n.gameId,C),Mr(Yt))})}),Fr(()=>{const t=na();if(!t||!e($)||!e(E))return;const n=()=>{Va(e($),e(E),t.uid).catch(()=>{})};return window.addEventListener("beforeunload",n),window.addEventListener("pagehide",n),()=>{n(),window.removeEventListener("beforeunload",n),window.removeEventListener("pagehide",n)}});async function Xt(){if(!(!e($)||!e(E)||!e(L)||!e(Tt)))try{const t=await zt(e($),e(E));t?a(P,t,!0):e(Qt)&&await Ya(e($),e(E),e(M),e(L).members),a(ze,null)}catch(t){a(ze,t instanceof Error?t.message:"Load failed",!0)}}async function yr(){if(a(ze,null),!!e($))try{const t=await Mt(e($));a(L,t,!0),t&&e(E)&&await Xt()}catch(t){a(ze,t instanceof Error?t.message:"Load failed",!0)}}async function $r(){!e($)||!e(E)||await qa(e($),e(E))}function Pr(){a(pt,!0),a(Y,"type"),a(Fe,!1),a(Ce,null),a(q,null),a(Me,null),a(et,""),a(Ge,[],!0),a(je,!1),a(_t,"")}function Dr(t){a(Ce,t,!0),a(Y,"game"),a(he,e(et),!0)}function Sr(t){if(!t?.trim())return"?";const n=t.trim().split(/\s+/);return n.length===1?n[0].slice(0,2).toUpperCase():(n[0][0]+n[n.length-1][0]).toUpperCase()}function Lr(){const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function er(){const t=Lr(),n=parseInt(e(V)),C=`${n}-12-31`;if(e(Ce)==="seasonalPick"){const z=da(e(M),n);return{releaseFrom:z.start>t?z.start:t,releaseTo:z.end}}return{releaseFrom:t,releaseTo:C}}async function Ut(){const t=parseInt(e(V)),n=e(et).trim()||void 0,{releaseFrom:C,releaseTo:z}=er(),X=e(Ge).length?e(Ge):void 0,G={search:n,releaseFrom:C,releaseTo:z,genres:X};e(je)&&(G.bookmarkedOnly=!0,G.bookmarkedIds=e(Be)),a(Xe,!0),a($e,[],!0),a(ge,0);try{const{games:ee,total:te}=await or(t,pe,0,G);a($e,ee,!0),a(ge,te,!0)}finally{a(Xe,!1)}}async function Tr(){const t=parseInt(e(V)),n=e(et).trim()||void 0,{releaseFrom:C,releaseTo:z}=er(),X=e(Ge).length?e(Ge):void 0,G={search:n,releaseFrom:C,releaseTo:z,genres:X};if(e(je)&&(G.bookmarkedOnly=!0,G.bookmarkedIds=e(Be)),!(e(Xe)||e(Oe)||e($e).length>=e(ge))){a(Oe,!0);try{const{games:ee,total:te}=await or(t,pe,e($e).length,G);a($e,[...e($e),...ee],!0),a(ge,te,!0)}finally{a(Oe,!1)}}}me(()=>{if(e(Y)!=="game"||e(et)===e(he))return;const t=e(et),n=setTimeout(()=>{a(he,t,!0),Ut()},300);return()=>clearTimeout(n)}),me(()=>{if(e(Y)!=="game")return;const t=parseInt(e(V));if(!t||Number.isNaN(t)){a(Et,[],!0);return}pa(t).then(n=>a(Et,n,!0))}),me(()=>{e(Y)==="game"&&(e(Ge),e(je),Ut())}),me(()=>{e(Y)!=="game"||!e(O)||xa(e(O).uid).then(t=>a(Be,t,!0))}),me(()=>{const t=e(it);if(!t)return;const n=new IntersectionObserver(C=>{const[z]=C;z?.isIntersecting&&e(Y)==="game"&&e($e).length>0&&e($e).length<e(ge)&&!e(Oe)&&!e(Xe)&&Tr()},{rootMargin:"100px",threshold:0});return n.observe(t),()=>n.disconnect()});async function Ir(){if(!e(O)||!e(q)){console.log("handleToggleBookmark: not me or selectedGameId"),console.log("me",e(O)),console.log("selectedGameId",e(q));return}e(Be).has(e(q))?(await $a(e(O).uid,e(q)),a(Be,new Set([...e(Be)].filter(n=>n!==e(q))),!0)):(await Pa(e(O).uid,e(q)),a(Be,new Set([...e(Be),e(q)]),!0)),e(je)&&Ut()}async function tr(t){a(q,t,!0),a(Ne,!0),a(Me,null),a(Fe,!0);try{if(I.has(t))a(Me,I.get(t),!0);else{const n=await sr(t);n&&(I.set(t,n),a(Me,n,!0))}e(Me)&&(a(q,e(Me).id,!0),a(hr,e(Me).name,!0))}finally{a(Ne,!1)}}async function Cr(){if(!(!e(O)||!e($)||!e(E)||!e(q)||!e(Ce))){if(await ga(e(q))){a(_t,"That game cannot be drafted.");return}a(Pt,!0),a(Fe,!1);try{await Qa(e($),e(E),e(O).uid,e(q),e(Ce)),a(pt,!1)}catch(t){a(_t,t instanceof Error?t.message:"Pick failed",!0)}finally{a(Pt,!1)}}}function Gr(t){if(!t)return"—";const n=new Date(t);return isNaN(n.getTime())?t:n.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}const Br={seasonalPick:{label:"Seasonal",icon:Ma,color:"text-sky-400",borderHover:"hover:border-sky-400/50 hover:bg-sky-400/10"},hitPick:{label:"Hit",icon:Na,color:"text-accent",borderHover:"hover:border-accent/50 hover:bg-accent/10"},bombPick:{label:"Bomb",icon:Fa,color:"text-destructive",borderHover:"hover:border-destructive/50 hover:bg-destructive/10"},altPick:{label:"Alt",icon:Oa,color:"text-purple-400",borderHover:"hover:border-purple-400/50 hover:bg-purple-400/10"}};function Er(t){return t==="seasonalPick"?`Pick a game releasing in the ${e(tt)?.label??""} window`:t==="hitPick"?"Your GOTY prediction — the best performer this year":t==="bombPick"?"A game you think will flop — hurts other players if it bombs":t==="altPick"?"Backup pick — activates if one of your games is delisted from Steam":""}const bt=Br;function Ur(t,n,C){if(e(Yt),!e(P)||!e(L))return null;const z=e(L).members.length;let X;t%2===0?X=t*z+n:X=t*z+(z-1-n);const G=e(P).picks[X],ee=Wt(e(P).order,e(P).currentPick?.round??0),te=!!e(P).currentPick&&e(P).currentPick.round===t+1&&ee[e(P).currentPick.position]===C;let rt,lt;if(G){const He=I.get(G.gameId);rt=He?.coverUrl??void 0,lt=He?.name??""}const wt=ar(e(M),t+1,e(Dt));return{pick:G,isCurrent:te,pickIndex:X,coverUrl:rt,gameName:lt,roundPickType:wt}}var jt=Ms();Zr("1glbubq",t=>{Hr(()=>{Wr.title=e(L)?.name?`${e(L).name} – ${e(tt)?.label??""} Draft`:"Draft Room"})});var rr=o(jt);{var jr=t=>{var n=Ka(),C=o(n),z=o(C,!0);r(C);var X=i(C,2);nt(X,{variant:"outline",onclick:yr,children:(G,ee)=>{Ue();var te=Ie("Retry");s(G,te)},$$slots:{default:!0}}),r(n),D(()=>k(z,e(ze))),s(t,n)},Rr=t=>{var n=Ae(),C=B(n);{var z=G=>{var ee=Ja(),te=o(ee);cr(te,{class:"h-8 w-8 animate-spin text-primary"}),Ue(2),r(ee),s(G,ee)},X=G=>{var ee=xs(),te=B(ee),rt=o(te),lt=o(rt);nt(lt,{variant:"ghost",size:"icon",onclick:()=>Nt(`/league/${e($)}`),class:"h-8 w-8 shrink-0 text-muted-foreground hover:text-foreground",children:(c,p)=>{lr(c,{class:"h-4 w-4"})},$$slots:{default:!0}});var wt=i(lt,2),He=o(wt),ct=o(He),It=o(ct,!0);r(ct);var Rt=i(ct,2);Sa(Rt,{variant:"outline",class:"shrink-0 text-[10px]",children:(c,p)=>{Ue();var re=Ie();D(()=>k(re,`${e(tt)?.label??""??""} Draft`)),s(c,re)},$$slots:{default:!0}}),r(He);var Ct=i(He,2),kt=o(Ct);{var At=c=>{var p=Xa();s(c,p)},Ot=c=>{var p=es(),re=o(p);r(p),D(()=>k(re,`Status: ${e(P).status??""}`)),s(c,p)};x(kt,c=>{e(P).status==="active"?c(At):c(Ot,!1)})}var Gt=i(kt,2);{var ne=c=>{var p=ts();s(c,p)};x(Gt,c=>{!e(kr)&&e(P).status==="active"&&c(ne)})}var _e=i(Gt,2),We=o(_e);r(_e),r(Ct),r(wt),r(rt);var Ve=i(rt,2);{var ie=c=>{{let p=u(()=>!e(wr)||!e(Tt));nt(c,{onclick:$r,get disabled(){return e(p)},class:"glow-sm-primary gap-2",children:(re,Z)=>{var Pe=rs(),Q=B(Pe);_a(Q,{class:"h-4 w-4"}),Ue(),s(re,Pe)},$$slots:{default:!0}})}};x(Ve,c=>{e(Qt)&&e(P).status==="pending"&&c(ie)})}r(te);var xe=i(te,2);{var Re=c=>{var p=ns(),re=o(p),Z=o(re),Pe=o(Z);dr(Pe,{class:"h-6 w-6 text-primary"}),r(Z);var Q=i(Z,4),qe=o(Q);{var Ze=j=>{var ae=Ie();D(()=>k(ae,`Waiting for ${e(Lt).length??""} ${e(Lt).length===1?"player":"players"}`)),s(j,ae)},at=j=>{var ae=Ie("Everyone is here! The commissioner can start the draft.");s(j,ae)};x(qe,j=>{e(Lt).length>0?j(Ze):j(at,!1)})}r(Q);var be=i(Q,2);st(be,21,()=>e(L).members,ot,(j,ae)=>{const Qe=u(()=>!e(Lt).includes(e(ae)));var K=os(),De=o(K),Se=o(De,!0);r(De);var dt=i(De,2);{var Ke=H=>{var d=as();s(H,d)},Je=H=>{var d=ss();s(H,d)};x(dt,H=>{e(Qe)?H(Ke):H(Je,!1)})}r(K),D(H=>{ft(K,1,`flex items-center justify-between rounded-lg border px-3 py-2 transition-colors ${e(Qe)?"border-accent/30 bg-accent/6":"border-white/6 bg-white/2"}`),k(Se,H)},[()=>St(e(ae))||"…"]),s(j,K)}),r(be),r(re),r(p),s(c,p)},Ye=c=>{var p=_s(),re=o(p);nr(re,{class:"min-h-0 flex-1",orientation:"both",children:(Z,Pe)=>{var Q=hs(),qe=B(Q),Ze=i(o(qe),2);st(Ze,17,()=>e(L).members,ot,(be,j)=>{const ae=u(()=>e(O)?.uid===e(j)),Qe=u(()=>e(xt)===e(j));var K=is(),De=o(K);ye(De,()=>Aa,(Ke,Je)=>{Je(Ke,{class:"h-7 w-7 shrink-0",children:(H,d)=>{var v=Ae(),b=B(v);{let F=u(()=>e(ae)?"bg-primary text-primary-foreground":"");ye(b,()=>Ra,(W,N)=>{N(W,{get class(){return`text-[10px] ${e(F)??""}`},children:(we,le)=>{Ue();var Le=Ie();D(Ee=>k(Le,Ee),[()=>Sr(St(e(j)))]),s(we,Le)},$$slots:{default:!0}})})}s(H,v)},$$slots:{default:!0}})});var Se=i(De,2),dt=o(Se,!0);r(Se),r(K),D((Ke,Je)=>{ft(K,1,`flex min-w-[160px] flex-1 items-center justify-center gap-2 rounded-lg border px-2 py-2 transition-all sm:min-w-[180px] ${e(Qe)?"glow-sm-primary border-primary/30 bg-primary/8":"border-white/6 bg-white/3"}`),ft(Se,1,`truncate text-sm font-medium ${e(ae)?"text-primary":""}`),Bt(Se,"title",Ke),k(dt,Je)},[()=>St(e(j))||void 0,()=>St(e(j))||"…"]),s(be,K)}),r(qe);var at=i(qe,2);st(at,21,()=>Array(e(xr)),ot,(be,j,ae)=>{const Qe=u(()=>ar(e(M),ae+1,e(Dt))),K=u(()=>bt[e(Qe)]);var De=gs(),Se=o(De),dt=o(Se);{var Ke=H=>{const d=u(()=>e(K).icon);var v=ls(),b=B(v);ye(b,()=>e(d),(N,we)=>{we(N,{get class(){return`h-4 w-4 ${e(K).color??""}`}})});var F=i(b,2),W=o(F,!0);r(F),D(()=>k(W,e(K).label)),s(H,v)};x(dt,H=>{e(K)&&H(Ke)})}r(Se);var Je=i(Se,2);st(Je,17,()=>e(L).members,ot,(H,d,v)=>{const b=u(()=>Ur(ae,v,e(d))),F=u(()=>e(O)?.uid===e(d)),W=u(()=>e(b)?.isCurrent),N=u(()=>!!e(b)?.pick),we=u(()=>e(xt)===e(d));var le=ps(),Le=o(le);{var Ee=w=>{const _=u(()=>bt[e(b).pick.pickType]||{icon:za,color:"text-gray-500",label:"?"}),R=u(()=>e(_).icon);var f=us(),S=o(f),T=o(S);ye(T,()=>e(R),(ke,ue)=>{ue(ke,{get class(){return`h-4 w-4 ${e(_).color??""}`}})});var se=i(T,2),Te=o(se,!0);r(se),r(S);var ce=i(S,2),J=o(ce);{var oe=ke=>{var ue=cs(),vt=B(ue),gt=i(vt,4),Ft=o(gt,!0);r(gt),D(()=>{Bt(vt,"src",e(b).coverUrl),k(Ft,e(b).gameName||"…")}),s(ke,ue)},de=ke=>{var ue=ds(),vt=o(ue),gt=o(vt,!0);r(vt),r(ue),D(()=>k(gt,e(b).gameName||"…")),s(ke,ue)};x(J,ke=>{e(b).coverUrl?ke(oe):ke(de,!1)})}r(ce),r(f),D(()=>k(Te,e(_).label)),s(w,f)},ut=w=>{var _=Ae(),R=B(_);{var f=S=>{var T=ms(),se=o(T);{var Te=J=>{nt(J,{size:"sm",onclick:Pr,class:"glow-primary gap-1.5 font-semibold",children:(oe,de)=>{var ke=vs(),ue=B(ke);dr(ue,{class:"h-3.5 w-3.5"}),Ue(),s(oe,ke)},$$slots:{default:!0}})},ce=J=>{var oe=fs();s(J,oe)};x(se,J=>{e(F)&&e(Jt)?J(Te):J(ce,!1)})}r(T),s(S,T)};x(R,S=>{e(W)&&S(f)},!0)}s(w,_)};x(Le,w=>{e(N)&&e(b)?.pick?w(Ee):w(ut,!1)})}r(le),D(()=>ft(le,1,`group relative min-h-[90px] min-w-[160px] flex-1 overflow-hidden rounded-lg border transition-all sm:min-h-[100px] sm:min-w-[180px]
										${e(W)?"animate-glow-pulse border-primary/50 ring-1 ring-primary/30":"border-white/6"}
										${e(we)&&!e(W)?"bg-primary/3":e(N)?"bg-card/50":"bg-white/1"}`)),s(H,le)}),r(De),s(be,De)}),r(at),s(Z,Q)},$$slots:{default:!0}}),r(p),s(c,p)};x(xe,c=>{e(P).status==="pending"?c(Re):c(Ye,!1)})}D((c,p)=>{k(It,e(L).name||""),k(We,`${c??""} — ${p??""}`)},[()=>e(tt)?.releaseStart(parseInt(e(V))).slice(5),()=>e(tt)?.releaseEnd(parseInt(e(V))).slice(5)]),s(G,ee)};x(C,G=>{!e(L)||!e(P)?G(z):G(X,!1)},!0)}s(t,n)};x(rr,t=>{e(ze)?t(jr):t(Rr,!1)})}var Ar=i(rr,2);ye(Ar,()=>ka,(t,n)=>{n(t,{get open(){return e(pt)},set open(C){a(pt,C,!0)},children:(C,z)=>{var X=Ae(),G=B(X);{let ee=u(()=>e(Y)==="type"?"w-auto max-w-md sm:max-w-md":"h-[90vh] w-[90vw] max-w-none sm:max-w-none");ye(G,()=>ba,(te,rt)=>{rt(te,{get class(){return`flex flex-col gap-0 overflow-hidden p-0 ${e(ee)??""}`},children:(lt,wt)=>{var He=Ns(),ct=B(He),It=o(ct);ye(It,()=>wa,(ne,_e)=>{_e(ne,{class:"text-lg font-semibold",children:(We,Ve)=>{var ie=Ae(),xe=B(ie);{var Re=c=>{var p=Ie("Select Pick Type");s(c,p)},Ye=c=>{var p=Ie("Select Game");s(c,p)};x(xe,c=>{e(Y)==="type"?c(Re):c(Ye,!1)})}s(We,ie)},$$slots:{default:!0}})});var Rt=i(It,2);{var Ct=ne=>{nt(ne,{variant:"ghost",size:"sm",class:"mt-1 flex items-center gap-1 text-xs text-muted-foreground",onclick:()=>{a(Fe,!1),a(Y,"type")},children:(_e,We)=>{var Ve=bs(),ie=B(Ve);lr(ie,{class:"size-3 "}),Ue(),s(_e,Ve)},$$slots:{default:!0}})};x(Rt,ne=>{e(Y)!=="type"&&ne(Ct)})}r(ct);var kt=i(ct,2),At=o(kt);{var Ot=ne=>{var _e=ks(),We=o(_e);st(We,21,()=>e(br),ot,(Ve,ie)=>{const xe=u(()=>bt[e(ie)]);var Re=Ae(),Ye=B(Re);{var c=p=>{const re=u(()=>e(xe).icon);var Z=ws();Z.__click=()=>Dr(e(ie));var Pe=o(Z);ye(Pe,()=>e(re),(be,j)=>{j(be,{get class(){return`size-9 ${e(xe).color??""} transition-transform group-hover:scale-110`}})});var Q=i(Pe,2),qe=o(Q,!0);r(Q);var Ze=i(Q,2),at=o(Ze,!0);r(Ze),r(Z),D(be=>{ft(Z,1,`group flex cursor-pointer flex-col items-center justify-center gap-3 rounded-xl border-2 border-white/6 bg-white/2 p-5 transition-all ${e(xe).borderHover??""}`),ft(Q,1,`text-base font-bold ${e(xe).color??""}`),k(qe,e(xe).label),k(at,be)},[()=>Er(e(ie))]),s(p,Z)};x(Ye,p=>{e(xe)&&p(c)})}s(Ve,Re)}),r(We),r(_e),s(ne,_e)},Gt=ne=>{var _e=Ae(),We=B(_e);{var Ve=ie=>{var xe=Fs(),Re=B(xe),Ye=o(Re),c=o(Ye),p=o(c);La(p,{class:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"});var re=i(p,2);Da(re,{placeholder:"Search games...",class:"pl-9",autofocus:!0,get value(){return e(et)},set value(d){a(et,d,!0)}}),r(c);var Z=i(c,2),Pe=o(Z),Q=o(Pe);Ta(Q,{class:"h-3.5 w-3.5 shrink-0 text-muted-foreground"});var qe=i(Q,2);ye(qe,()=>Ia,(d,v)=>{v(d,{type:"multiple",get value(){return e(Ge)},set value(b){a(Ge,b,!0)},children:(b,F)=>{var W=ys(),N=B(W);ye(N,()=>Ca,(le,Le)=>{Le(le,{class:"h-8 max-w-[140px] min-w-0 border-white/8 bg-white/4 text-xs",children:(Ee,ut)=>{Ue();var w=Ie();D(()=>k(w,e(Ge).length>1?`${e(Ge).length} genres`:e(Ge)[0]??"Genre")),s(Ee,w)},$$slots:{default:!0}})});var we=i(N,2);ye(we,()=>Ga,(le,Le)=>{Le(le,{children:(Ee,ut)=>{var w=Ae(),_=B(w);st(_,17,()=>e(Et),ot,(R,f)=>{var S=Ae(),T=B(S);ye(T,()=>Ba,(se,Te)=>{Te(se,{get value(){return e(f)},get label(){return e(f)},children:(ce,J)=>{Ue();var oe=Ie();D(()=>k(oe,e(f))),s(ce,oe)},$$slots:{default:!0}})}),s(R,S)}),s(Ee,w)},$$slots:{default:!0}})}),s(b,W)},$$slots:{default:!0}})}),r(Pe);var Ze=i(Pe,2);{var at=d=>{var v=$s();v.__click=()=>a(je,!e(je));var b=o(v),F=o(b);{var W=N=>{ja(N,{class:"h-2 w-2"})};x(F,N=>{e(je)&&N(W)})}r(b),Ue(2),r(v),D(()=>{Bt(v,"aria-checked",e(je)),ft(b,1,`flex size-3.5 shrink-0 items-center justify-center rounded border border-white/8 bg-white/4 transition-colors ${e(je)?"border-primary bg-primary text-primary-foreground":""}`)}),s(d,v)};x(Ze,d=>{e(O)&&d(at)})}var be=i(Ze,2),j=o(be);{let d=u(()=>e(ht)==="table"?"secondary":"ghost");nt(j,{get variant(){return e(d)},size:"icon",class:"h-7 w-7",onclick:()=>a(ht,"table"),"aria-label":"Table view",children:(v,b)=>{Ea(v,{class:"h-3.5 w-3.5"})},$$slots:{default:!0}})}var ae=i(j,2);{let d=u(()=>e(ht)==="grid"?"secondary":"ghost");nt(ae,{get variant(){return e(d)},size:"icon",class:"h-7 w-7",onclick:()=>a(ht,"grid"),"aria-label":"Grid view",children:(v,b)=>{Ua(v,{class:"h-3.5 w-3.5"})},$$slots:{default:!0}})}r(be),r(Z);var Qe=i(Z,2),K=o(Qe);{var De=d=>{var v=Ie();D((b,F)=>k(v,`Showing ${e(tt)?.label??""??""} games (${b??""} — ${F??""})`),[()=>e(tt)?.releaseStart(parseInt(e(V))).slice(5),()=>e(tt)?.releaseEnd(parseInt(e(V))).slice(5)]),s(d,v)},Se=d=>{var v=Ie();D(()=>k(v,`All unreleased games for ${e(V)??""}`)),s(d,v)};x(K,d=>{e(Ce)==="seasonalPick"?d(De):d(Se,!1)})}r(Qe),r(Ye);var dt=i(Ye,2);{var Ke=d=>{var v=Ps(),b=o(v);cr(b,{class:"animate-spin text-primary"}),r(v),s(d,v)},Je=d=>{nr(d,{class:"min-h-0 flex-1",get viewportRef(){return e(Zt)},set viewportRef(v){a(Zt,v,!0)},children:(v,b)=>{var F=js(),W=o(F);{var N=w=>{var _=Ss();st(_,21,()=>e(Kt),ot,(R,f)=>{var S=Ds();S.__click=()=>tr(e(f).id);var T=o(S),se=o(T);{var Te=de=>{ir(de,{class:"h-3.5 w-3.5 shrink-0 text-yellow-400"})};x(se,de=>{e(Be).has(e(f).id)&&de(Te)})}var ce=i(se);r(T);var J=i(T,2),oe=o(J,!0);r(J),r(S),D(de=>{k(ce,` ${e(f).name??""}`),k(oe,de)},[()=>Gr(e(f).releaseDate)]),s(R,S)}),r(_),s(w,_)},we=w=>{var _=Bs();st(_,21,()=>e(Kt),ot,(R,f)=>{var S=Gs();S.__click=()=>tr(e(f).id);var T=o(S);{var se=ve=>{var fe=Ls();D(()=>Bt(fe,"src",e(f).coverUrl)),s(ve,fe)},Te=ve=>{var fe=Ts(),yt=o(fe,!0);r(fe),D(()=>k(yt,e(f).name)),s(ve,fe)};x(T,ve=>{e(f).coverUrl?ve(se):ve(Te,!1)})}var ce=i(T,2);{var J=ve=>{var fe=Is(),yt=o(fe);ir(yt,{class:"h-4 w-4 text-yellow-400"}),r(fe),s(ve,fe)};x(ce,ve=>{e(Be).has(e(f).id)&&ve(J)})}var oe=i(ce,2),de=o(oe),ke=o(de,!0);r(de);var ue=i(de,2),vt=o(ue,!0);r(ue);var gt=i(ue,2);{var Ft=ve=>{var fe=Cs(),yt=o(fe);r(fe),D(Or=>k(yt,`Score: ${Or??""}`),[()=>Math.round(e(f).score).toLocaleString()]),s(ve,fe)};x(gt,ve=>{e(f).score!=null&&ve(Ft)})}r(oe),r(S),D(()=>{k(ke,e(f).name),k(vt,e(f).releaseDate??"TBA")}),s(R,S)}),r(_),s(w,_)};x(W,w=>{e(ht)==="table"?w(N):w(we,!1)})}var le=i(W,2);Qr(le,w=>a(it,w),()=>e(it));var Le=i(le,2);{var Ee=w=>{var _=Es();s(w,_)},ut=w=>{var _=Ae(),R=B(_);{var f=S=>{var T=Us(),se=o(T);r(T),D(()=>k(se,`${e($e).length??""} of ${e(ge)??""}`)),s(S,T)};x(R,S=>{e($e).length>0&&e($e).length<e(ge)&&S(f)},!0)}s(w,_)};x(Le,w=>{e(Oe)?w(Ee):w(ut,!1)})}r(F),s(v,F)},$$slots:{default:!0}})};x(dt,d=>{e(Xe)?d(Ke):d(Je,!1)})}r(Re);var H=i(Re,2);{const d=F=>{var W=Os(),N=B(W),we=o(N),le=o(we);{var Le=_=>{const R=u(()=>bt[e(Ce)]),f=u(()=>e(R).icon);var S=Rs(),T=B(S),se=o(T);ye(se,()=>e(f),(oe,de)=>{de(oe,{get class(){return`h-5 w-5 ${e(R).color??""}`}})}),r(T);var Te=i(T,2),ce=i(o(Te),2),J=o(ce);r(ce),r(Te),D(()=>k(J,`${e(R).label??""} Pick`)),s(_,S)};x(le,_=>{e(Ce)&&bt[e(Ce)]&&_(Le)})}r(we);var Ee=i(we,2);nt(Ee,{size:"lg",onclick:Cr,get disabled(){return e(Pt)},class:"glow-sm-primary px-6",children:(_,R)=>{Ue();var f=Ie();D(()=>k(f,e(Pt)?"Submitting...":"Confirm Pick")),s(_,f)},$$slots:{default:!0}}),r(N);var ut=i(N,2);{var w=_=>{var R=As(),f=o(R,!0);r(R),D(()=>k(f,e(_t))),s(_,R)};x(ut,_=>{e(_t)&&_(w)})}s(F,W)};let v=u(()=>e(q)!=null&&!e(Ne)&&e(Me)==null),b=u(()=>e(q)!=null&&e(Be).has(e(q)));ya(H,{get open(){return e(Fe)},onOpenChange:F=>a(Fe,F,!0),get game(){return e(Me)},get loading(){return e(Ne)},get showNotFound(){return e(v)},get isBookmarked(){return e(b)},onToggleBookmark:Ir,footer:d,$$slots:{footer:!0}})}s(ie,xe)};x(We,ie=>{e(Y)==="game"&&ie(Ve)},!0)}s(ne,_e)};x(At,ne=>{e(Y)==="type"?ne(Ot):ne(Gt,!1)})}r(kt),s(lt,He)},$$slots:{default:!0}})})}s(C,X)},$$slots:{default:!0}})}),r(jt),s(m,jt),zr(),U()}Vr(["click"]);export{_o as component};
