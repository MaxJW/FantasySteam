import{a as s,f as c,c as ke,t as ge}from"../chunks/CpGdMysL.js";import{o as _r}from"../chunks/m1-UBQ76.js";import{p as hr,b as P,i as Lt,u as _e,s as o,g as e,I as xr,a as br,J as wr,K as m,$ as kr,c as n,d as v,f as O,r,n as je,t as R}from"../chunks/BDrvxx__.js";import{d as yr,s as C}from"../chunks/BSuI6fb-.js";import{i as x}from"../chunks/BrlxcVzR.js";import{h as Pr,b as Be,i as Oe,s as He,d as It}from"../chunks/BtlP16IT.js";import{c as ye}from"../chunks/COOgE8t9.js";import{b as $r}from"../chunks/CdPC5Fv_.js";import{g as Dr}from"../chunks/DbojsEFi.js";import{g as Ct}from"../chunks/DtVsZ9JU.js";import{p as Sr}from"../chunks/DTU4Di7p.js";import{g as Et}from"../chunks/CagLvj_A.js";import{e as Nt,f as Tr,h as Bt,p as Lr,i as Ir,P as Cr,j as Ut}from"../chunks/Gs9gDzk3.js";import{d as Ae,t as Er,a as Ot,b as Ur}from"../chunks/C5kb4MaX.js";import{a as jt,b as At,i as jr}from"../chunks/M144yGS5.js";import{l as Ar,u as ht,m as Ht,a as zt,s as Gr,e as Rr,n as Fr,r as Mr,T as Nr,b as Br}from"../chunks/Q1b3iPLy.js";import{g as Or,P as Hr}from"../chunks/DoAvgbqq.js";import{B as Qe}from"../chunks/oI9HSfvP.js";import{I as zr}from"../chunks/DaIZ7o_-.js";import{B as Yr}from"../chunks/D3gcqIlW.js";import{D as qr,a as Wr,b as Zr,S as Gt,G as Kr}from"../chunks/DmoFy5kk.js";import{A as Vr,a as Jr}from"../chunks/CmvDzIua.js";import{A as Rt}from"../chunks/MIiYdz2_.js";import{L as Ft}from"../chunks/BI3I7OaX.js";import{S as Qr,B as Xr,T as ea}from"../chunks/BkWUYZn6.js";import{S as ta}from"../chunks/CvsPdbFn.js";import{S as ra}from"../chunks/D18c6Ap4.js";import{Z as Mt}from"../chunks/xdI8nkcU.js";import{C as aa}from"../chunks/WnCfmsHm.js";function Yt(f,g,d,D){const j=(f??[]).filter(J=>J.userId===g),E=j.length;return D==="winter"?E===0?["hitPick","bombPick"]:E===1?j[0].pickType==="hitPick"?["bombPick"]:["hitPick"]:E<2+d?["seasonalPick"]:E===2+d?["altPick"]:[]:E<d?["seasonalPick"]:E===d?["altPick"]:[]}async function qt(f,g){const d=await zt(Ae(f,g));return d.exists()?{id:d.id,...d.data()}:null}function sa(f,g,d){return Ar(Ae(f,g),D=>{if(!D.exists()){d(null);return}d({id:D.id,...D.data()})})}function xt(f,g){return g%2===0?[...f].reverse():f}function Wt(f){const g=f.currentPick;return g?xt(f.order,g.round)[g.position]??null:null}async function na(f,g,d){await ht(Ae(f,g),{presentUserIds:Ht(d)})}async function oa(f,g,d){await ht(Ae(f,g),{presentUserIds:Fr(d)})}async function ia(f,g,d,D){await Gr(Ae(f,g),{status:"pending",phase:d,order:D,currentPick:null,picks:[],presentUserIds:[],createdAt:Rr()})}async function la(f,g){const d=Ae(f,g),D=await zt(d);if(!D.exists())throw new Error("Draft not found");const E={round:1,position:0,userId:D.data().order[0]??"",expiresAt:null};await ht(d,{status:"active",currentPick:E})}function ca(f,g,d,D){const E=Bt(d,D)*f.length;if(g>=E)return null;const J=Math.floor(g/f.length)+1,he=g%f.length,A=xt(f,J)[he];return A?{round:J,position:he,userId:A,expiresAt:null}:null}async function da(f,g,d,D,j){const E=Ae(f,g),J=Er(f,d),he=await Ot(f);if(!he)throw new Error("League not found");const b=Nt(he.members.length);await Mr(Br,async H=>{const oe=await H.get(E),w=await H.get(J);if(!oe.exists())throw new Error("Draft does not exist");const u=oe.data(),Pe=u.phase,Y=Wt(u);if(Y!==d)throw new Error(`It is not your turn. Waiting for ${Y}.`);if(u.picks.some($e=>$e.gameId===D))throw new Error("This game has already been drafted.");if(!Yt(u.picks,d,b,Pe).includes(j))throw new Error(`You cannot make a ${j} right now.`);const ze={userId:d,gameId:D,pickType:j,timestamp:Nr.now()};if(H.update(E,{picks:Ht(ze)}),w.exists()){const Xe=w.data().picks??{};if(j==="hitPick")H.update(J,{"picks.hitPick":D});else if(j==="bombPick")H.update(J,{"picks.bombPick":D});else if(j==="seasonalPick"){const re=Tr(Pe),Q=[...Xe[re]??[],D];H.update(J,{[`picks.${re}`]:Q})}else if(j==="altPick"){const re=[...Xe.altPicks??[],D];H.update(J,{"picks.altPicks":re})}}const ie=ca(u.order,u.picks.length+1,Pe,b);ie?H.update(E,{currentPick:ie}):H.update(E,{currentPick:null,status:"completed"})}),(await qt(f,g))?.status==="completed"&&await Ur(f)}var ua=c('<div class="flex h-full flex-col items-center justify-center gap-3"><!> <p class="text-sm text-muted-foreground">Loading draft room...</p></div>'),va=c('<span class="flex items-center gap-1.5 font-medium text-red-400"><span class="relative flex h-2 w-2"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex h-2 w-2 rounded-full bg-red-400"></span></span> LIVE</span>'),fa=c("<span> </span>"),ma=c('<span class="font-medium text-yellow-500">Current picker away</span>'),pa=c("<!> Start Draft",1),ga=c('<span class="flex h-2 w-2 rounded-full bg-accent"></span>'),_a=c('<span class="flex h-2 w-2 animate-pulse rounded-full bg-muted-foreground/40"></span>'),ha=c('<div><span class="max-w-[110px] truncate text-sm font-medium"> </span> <!></div>'),xa=c('<div class="flex flex-1 items-center justify-center"><div class="glass w-full max-w-md rounded-xl p-6 text-center"><div class="mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10"><!></div> <h2 class="text-lg font-semibold">Waiting for Players</h2> <p class="mt-1 text-sm text-muted-foreground"><!></p> <div class="mt-5 grid grid-cols-2 gap-2"></div></div></div>'),ba=c("<div><!> <p> </p></div>"),wa=c('<!> <span class="mt-0.5 text-[9px] font-semibold tracking-tight text-muted-foreground uppercase"> </span>',1),ka=c('<img alt="" class="absolute inset-0 h-full w-full object-cover"/> <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div> <span class="absolute right-1 bottom-1 left-1.5 line-clamp-2 text-[10px] leading-tight font-medium text-white"> </span>',1),ya=c('<div class="flex h-full w-full items-center justify-center p-1.5 text-center"><span class="line-clamp-3 text-[10px] font-medium text-muted-foreground"> </span></div>'),Pa=c('<div class="absolute inset-0 flex"><div class="flex w-1/3 flex-col items-center justify-center gap-1 border-r border-white/[0.06] bg-white/[0.02]"><!> <span class="text-[8px] font-semibold tracking-tight text-muted-foreground uppercase"> </span></div> <div class="relative flex w-2/3 items-center justify-center overflow-hidden"><!></div></div>'),$a=c("<!> Make Pick",1),Da=c('<div class="flex flex-col items-center gap-1"><div class="h-1.5 w-1.5 animate-ping rounded-full bg-primary"></div> <span class="text-[10px] font-medium text-muted-foreground">Picking...</span></div>'),Sa=c('<div class="absolute inset-0 flex items-center justify-center"><!></div>'),Ta=c("<div><!></div>"),La=c('<div class="flex min-w-max gap-2"><div class="flex w-16 shrink-0 flex-col items-center justify-center text-center sm:w-20"><!></div> <!></div>'),Ia=c('<div class="sticky top-0 z-10 flex min-w-max gap-2 border-b border-white/[0.06] p-2 backdrop-blur" style="background: oklch(0.15 0.03 250 / 0.9)"><div class="flex w-16 shrink-0 items-center justify-center sm:w-20"></div> <!></div> <div class="flex flex-col gap-2 p-2"></div>',1),Ca=c('<div class="flex flex-1 flex-col overflow-hidden rounded-xl border border-white/[0.06] bg-card/30"><!></div>'),Ea=c('<div class="flex shrink-0 flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"><div class="flex items-center gap-2"><!> <div class="min-w-0"><div class="flex flex-wrap items-center gap-2"><h1 class="truncate text-lg font-bold tracking-tight sm:text-xl"> </h1> <!></div> <div class="flex flex-wrap items-center gap-3 text-xs text-muted-foreground"><!> <!> <span> </span></div></div></div> <!></div> <!>',1),Ua=c("<!> Back",1),ja=c('<button><!> <span> </span> <span class="text-center text-[11px] leading-relaxed text-muted-foreground"> </span></button>'),Aa=c('<div class="overflow-y-auto p-5"><div class="grid h-full min-h-[340px] grid-cols-2 content-center gap-3"></div></div>'),Ga=c('<div class="flex flex-1 items-center justify-center"><!></div>'),Ra=c('<button class="flex w-full items-center justify-between rounded-lg px-3 py-2.5 text-left transition-colors hover:bg-white/[0.04]"><span class="text-sm font-medium"> </span> <span class="shrink-0 pl-3 font-mono text-xs text-muted-foreground"> </span></button>'),Fa=c('<div class="py-3 text-center text-xs text-muted-foreground">Loading more…</div>'),Ma=c('<div class="py-2 text-center text-[10px] text-muted-foreground"> </div>'),Na=c('<div class="p-3"><div class="grid grid-cols-1 gap-0.5"></div> <div class="h-4 w-full" role="presentation"></div> <!></div>'),Ba=c('<div class="flex min-h-0 flex-1 flex-col"><div class="shrink-0 border-b border-white/[0.06] px-5 py-3"><div class="relative"><!> <!></div> <p class="mt-2 text-[11px] text-muted-foreground"><!></p></div> <!></div>'),Oa=c('<div class="rounded-full border border-white/[0.08] bg-white/[0.03] p-2"><!></div> <div><p class="text-[10px] font-semibold text-muted-foreground uppercase">Drafting as</p> <p class="text-sm font-medium"> </p></div>',1),Ha=c('<p class="mt-2 text-center text-sm text-destructive"> </p>'),za=c('<div class="flex w-full items-center justify-between rounded-lg border border-white/[0.08] bg-white/[0.03] p-4"><div class="flex items-center gap-3"><!></div> <!></div> <!>',1),Ya=c('<div class="flex min-h-0 flex-1 flex-col"><!></div>'),qa=c('<div class="border-b border-white/[0.06] p-5 pb-3"><!> <!></div> <div class="flex h-[420px] flex-col overflow-hidden"><!></div>',1),Wa=c('<div class="flex h-[calc(100vh-7rem)] flex-col gap-4 md:h-[calc(100vh-8rem)]"><!> <!></div>');function ys(f,g){hr(g,!0);const d=new Map,D=24;let j=P(0),E=P(!1),J=P(void 0),he=P(""),b=P(""),A=P(""),H=P("winter"),oe=P(""),w=P(null),u=P(null),Pe=P(!1),Y=P("type"),Ge=P(!1),ze=P(!1),ie=P(null),$e=P(null),Xe=P(""),re=P(null),Q=P(Lt([])),De=P(""),et=P(!1),Ye=P(""),bt=null,wt=P(0),kt=P(Lt(new Map));const le=m(Et),yt=m(()=>!!(e(le)&&e(w)&&e(w).commissionerId===e(le).uid)),Zt=m(()=>new Set((e(u)?.picks??[]).map(t=>t.gameId))),tt=m(()=>e(w)?Nt(e(w).members.length):2),Kt=m(()=>Bt(e(H),e(tt))),Vt=m(()=>!e(le)||!e(u)||!e(Pt)?[]:Yt(e(u).picks??[],e(le).uid,e(tt),e(H))),Jt=m(()=>e(Q).filter(t=>!e(Zt).has(t.id)));function rt(t){return e(kt).get(t)?.trim()||""}const Qt=m(()=>{if(!e(w)||!e(u))return!1;const t=e(u).presentUserIds??[];return e(w).members.every(a=>t.includes(a))}),qe=m(()=>e(u)?Wt(e(u)):null),Pt=m(()=>!!(e(le)&&e(qe)===e(le).uid)),Xt=m(()=>!!(e(qe)&&(e(u)?.presentUserIds??[]).includes(e(qe)))),at=m(()=>e(w)?.members.filter(t=>!(e(u)?.presentUserIds??[]).includes(t))??[]),Se=m(()=>Cr[e(H)]);_e(()=>{const t=Dr(Sr).params;o(b,t?.id??"",!0),o(A,t?.season??"",!0);const a=Lr(e(A));a&&(o(H,a.phase,!0),o(oe,a.season,!0))}),_e(()=>{e(b)&&Ot(e(b)).then(t=>o(w,t,!0))}),_e(()=>{const t=e(w)?.members;t?.length&&Or(t).then(a=>o(kt,a,!0))}),_e(()=>{if(!e(b)||!e(A))return;bt?.();const t=sa(e(b),e(A),a=>o(u,a,!0));return bt=t,()=>t()}),_e(()=>{e(u)?.status==="completed"&&e(b)&&Ct(`/league/${e(b)}`)}),_e(()=>{!e(u)||!e(le)||!e(b)||!e(A)||na(e(b),e(A),e(le).uid).catch(()=>{})}),_e(()=>{e(b)&&e(A)&&e(w)&&er()}),_e(()=>{const t=e(u)?.picks??[];for(const a of t)!a?.gameId||d.has(a.gameId)||jt(a.gameId).then(S=>{S&&(d.set(a.gameId,S),xr(wt))})}),_r(()=>{const t=Et();if(!t||!e(b)||!e(A))return;const a=()=>{oa(e(b),e(A),t.uid).catch(()=>{})};return window.addEventListener("beforeunload",a),window.addEventListener("pagehide",a),()=>{a(),window.removeEventListener("beforeunload",a),window.removeEventListener("pagehide",a)}});async function er(){if(!e(b)||!e(A)||!e(w))return;const t=await qt(e(b),e(A));t?o(u,t,!0):e(yt)&&await ia(e(b),e(A),e(H),e(w).members)}async function tr(){!e(b)||!e(A)||await la(e(b),e(A))}function rr(){o(Pe,!0),o(Y,"type"),o(ie,null),o($e,null),o(re,null),o(De,""),o(Ye,"")}function ar(t){o(ie,t,!0),o(Y,"game"),o(he,e(De),!0),Dt()}function sr(t){if(!t?.trim())return"?";const a=t.trim().split(/\s+/);return a.length===1?a[0].slice(0,2).toUpperCase():(a[0][0]+a[a.length-1][0]).toUpperCase()}function nr(){const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function $t(){const t=nr(),a=parseInt(e(oe)),S=`${a}-12-31`;if(e(ie)==="seasonalPick"){const z=Ir(e(H),a);return{releaseFrom:z.start>t?z.start:t,releaseTo:z.end}}return{releaseFrom:t,releaseTo:S}}async function Dt(){const t=parseInt(e(oe)),a=e(De).trim()||void 0,{releaseFrom:S,releaseTo:z}=$t();o(Ge,!0),o(Q,[],!0),o(j,0);try{const{games:X,total:ce}=await At(t,D,0,{search:a,releaseFrom:S,releaseTo:z});o(Q,X,!0),o(j,ce,!0)}finally{o(Ge,!1)}}async function or(){const t=parseInt(e(oe)),a=e(De).trim()||void 0,{releaseFrom:S,releaseTo:z}=$t();if(!(e(Ge)||e(E)||e(Q).length>=e(j))){o(E,!0);try{const{games:X,total:ce}=await At(t,D,e(Q).length,{search:a,releaseFrom:S,releaseTo:z});o(Q,[...e(Q),...X],!0),o(j,ce,!0)}finally{o(E,!1)}}}_e(()=>{if(e(Y)!=="game"||e(De)===e(he))return;const t=e(De),a=setTimeout(()=>{o(he,t,!0),Dt()},300);return()=>clearTimeout(a)}),_e(()=>{const t=e(J);if(!t)return;const a=new IntersectionObserver(S=>{const[z]=S;z?.isIntersecting&&e(Y)==="game"&&e(Q).length>0&&e(Q).length<e(j)&&!e(E)&&!e(Ge)&&or()},{rootMargin:"100px",threshold:0});return a.observe(t),()=>a.disconnect()});async function ir(t){o(ze,!0),o(re,null),o(Y,"confirm");try{if(d.has(t))o(re,d.get(t),!0);else{const a=await jt(t);a&&(d.set(t,a),o(re,a,!0))}e(re)&&(o($e,e(re).id,!0),o(Xe,e(re).name,!0))}finally{o(ze,!1)}}async function lr(){if(!(!e(le)||!e(b)||!e(A)||!e($e)||!e(ie))){if(await jr(e($e))){o(Ye,"That game cannot be drafted.");return}o(et,!0);try{await da(e(b),e(A),e(le).uid,e($e),e(ie)),o(Pe,!1)}catch(t){o(Ye,t instanceof Error?t.message:"Pick failed",!0)}finally{o(et,!1)}}}function cr(t){if(!t)return"—";const a=new Date(t);return isNaN(a.getTime())?t:a.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}const dr={seasonalPick:{label:"Seasonal",icon:ta,color:"text-sky-400",borderHover:"hover:border-sky-400/50 hover:bg-sky-400/10"},hitPick:{label:"Hit",icon:ea,color:"text-accent",borderHover:"hover:border-accent/50 hover:bg-accent/10"},bombPick:{label:"Bomb",icon:Xr,color:"text-destructive",borderHover:"hover:border-destructive/50 hover:bg-destructive/10"},altPick:{label:"Alt",icon:Qr,color:"text-purple-400",borderHover:"hover:border-purple-400/50 hover:bg-purple-400/10"}};function ur(t){return t==="seasonalPick"?`Pick a game releasing in the ${e(Se)?.label??""} window`:t==="hitPick"?"Your GOTY prediction — the best performer this year":t==="bombPick"?"A game you think will flop — hurts other players if it bombs":t==="altPick"?"Backup pick — activates if one of your games is delisted from Steam":""}const We=dr;function vr(t,a,S){if(e(wt),!e(u)||!e(w))return null;const z=e(w).members.length;let X;t%2===0?X=t*z+a:X=t*z+(z-1-a);const ce=e(u).picks[X],Le=xt(e(u).order,e(u).currentPick?.round??0),Ie=!!e(u).currentPick&&e(u).currentPick.round===t+1&&Le[e(u).currentPick.position]===S;let Re,Ze;if(ce){const xe=d.get(ce.gameId);Re=xe?.coverUrl??void 0,Ze=xe?.name??""}const Ce=Ut(e(H),t+1,e(tt));return{pick:ce,isCurrent:Ie,pickIndex:X,coverUrl:Re,gameName:Ze,roundPickType:Ce}}var ut=Wa();Pr("1glbubq",t=>{wr(()=>{kr.title=e(w)?.name?`${e(w).name} – ${e(Se)?.label??""} Draft`:"Draft Room"})});var St=n(ut);{var fr=t=>{var a=ua(),S=n(a);Ft(S,{class:"h-8 w-8 animate-spin text-primary"}),je(2),r(a),s(t,a)},mr=t=>{var a=Ea(),S=O(a),z=n(S),X=n(z);Qe(X,{variant:"ghost",size:"icon",onclick:()=>Ct(`/league/${e(b)}`),class:"h-8 w-8 shrink-0 text-muted-foreground hover:text-foreground",children:(i,l)=>{Rt(i,{class:"h-4 w-4"})},$$slots:{default:!0}});var ce=v(X,2),Le=n(ce),Ie=n(Le),Re=n(Ie,!0);r(Ie);var Ze=v(Ie,2);Yr(Ze,{variant:"outline",class:"shrink-0 text-[10px]",children:(i,l)=>{je();var $=ge();R(()=>C($,`${e(Se)?.label??""??""} Draft`)),s(i,$)},$$slots:{default:!0}}),r(Le);var Ce=v(Le,2),xe=n(Ce);{var st=i=>{var l=va();s(i,l)},vt=i=>{var l=fa(),$=n(l);r(l),R(()=>C($,`Status: ${e(u).status??""}`)),s(i,l)};x(xe,i=>{e(u).status==="active"?i(st):i(vt,!1)})}var nt=v(xe,2);{var ot=i=>{var l=ma();s(i,l)};x(nt,i=>{!e(Xt)&&e(u).status==="active"&&i(ot)})}var it=v(nt,2),ft=n(it);r(it),r(Ce),r(ce),r(z);var mt=v(z,2);{var ee=i=>{{let l=m(()=>!e(Qt));Qe(i,{onclick:tr,get disabled(){return e(l)},class:"glow-sm-primary gap-2",children:($,q)=>{var G=pa(),k=O(G);Hr(k,{class:"h-4 w-4"}),je(),s($,G)},$$slots:{default:!0}})}};x(mt,i=>{e(yt)&&e(u).status==="pending"&&i(ee)})}r(S);var de=v(S,2);{var be=i=>{var l=xa(),$=n(l),q=n($),G=n(q);Mt(G,{class:"h-6 w-6 text-primary"}),r(q);var k=v(q,4),K=n(k);{var W=h=>{var L=ge();R(()=>C(L,`Waiting for ${e(at).length??""} ${e(at).length===1?"player":"players"}`)),s(h,L)},ue=h=>{var L=ge("Everyone is here! The commissioner can start the draft.");s(h,L)};x(K,h=>{e(at).length>0?h(W):h(ue,!1)})}r(k);var T=v(k,2);Be(T,21,()=>e(w).members,Oe,(h,L)=>{const te=m(()=>!e(at).includes(e(L)));var I=ha(),p=n(I),y=n(p,!0);r(p);var ve=v(p,2);{var V=_=>{var F=ga();s(_,F)},U=_=>{var F=_a();s(_,F)};x(ve,_=>{e(te)?_(V):_(U,!1)})}r(I),R(_=>{He(I,1,`flex items-center justify-between rounded-lg border px-3 py-2 transition-colors ${e(te)?"border-accent/30 bg-accent/[0.06]":"border-white/[0.06] bg-white/[0.02]"}`),C(y,_)},[()=>rt(e(L))||"…"]),s(h,I)}),r(T),r($),r(l),s(i,l)},we=i=>{var l=Ca(),$=n(l);Gt($,{class:"min-h-0 flex-1",orientation:"both",children:(q,G)=>{var k=Ia(),K=O(k),W=v(n(K),2);Be(W,17,()=>e(w).members,Oe,(T,h)=>{const L=m(()=>e(le)?.uid===e(h)),te=m(()=>e(qe)===e(h));var I=ba(),p=n(I);ye(p,()=>Jr,(V,U)=>{U(V,{class:"h-7 w-7 shrink-0",children:(_,F)=>{var fe=ke(),M=O(fe);{let N=m(()=>e(L)?"bg-primary text-primary-foreground":"");ye(M,()=>Vr,(B,Z)=>{Z(B,{get class(){return`text-[10px] ${e(N)??""}`},children:(ae,se)=>{je();var ne=ge();R(Ee=>C(ne,Ee),[()=>sr(rt(e(h)))]),s(ae,ne)},$$slots:{default:!0}})})}s(_,fe)},$$slots:{default:!0}})});var y=v(p,2),ve=n(y,!0);r(y),r(I),R((V,U)=>{He(I,1,`flex min-w-[160px] flex-1 items-center justify-center gap-2 rounded-lg border px-2 py-2 transition-all sm:min-w-[180px] ${e(te)?"glow-sm-primary border-primary/30 bg-primary/[0.08]":"border-white/[0.06] bg-white/[0.03]"}`),He(y,1,`truncate text-sm font-medium ${e(L)?"text-primary":""}`),It(y,"title",V),C(ve,U)},[()=>rt(e(h))||void 0,()=>rt(e(h))||"…"]),s(T,I)}),r(K);var ue=v(K,2);Be(ue,21,()=>Array(e(Kt)),Oe,(T,h,L)=>{const te=m(()=>Ut(e(H),L+1,e(tt))),I=m(()=>We[e(te)]);var p=La(),y=n(p),ve=n(y);{var V=_=>{const F=m(()=>e(I).icon);var fe=wa(),M=O(fe);ye(M,()=>e(F),(Z,ae)=>{ae(Z,{get class(){return`h-4 w-4 ${e(I).color??""}`}})});var N=v(M,2),B=n(N,!0);r(N),R(()=>C(B,e(I).label)),s(_,fe)};x(ve,_=>{e(I)&&_(V)})}r(y);var U=v(y,2);Be(U,17,()=>e(w).members,Oe,(_,F,fe)=>{const M=m(()=>vr(L,fe,e(F))),N=m(()=>e(le)?.uid===e(F)),B=m(()=>e(M)?.isCurrent),Z=m(()=>!!e(M)?.pick),ae=m(()=>e(qe)===e(F));var se=Ta(),ne=n(se);{var Ee=Fe=>{const Me=m(()=>We[e(M).pick.pickType]||{icon:aa,color:"text-gray-500",label:"?"}),gt=m(()=>e(Me).icon);var Ke=Pa(),Ue=n(Ke),Ne=n(Ue);ye(Ne,()=>e(gt),(me,pe)=>{pe(me,{get class(){return`h-4 w-4 ${e(Me).color??""}`}})});var lt=v(Ne,2),_t=n(lt,!0);r(lt),r(Ue);var ct=v(Ue,2),Te=n(ct);{var Ve=me=>{var pe=ka(),Je=O(pe),dt=v(Je,4),gr=n(dt,!0);r(dt),R(()=>{It(Je,"src",e(M).coverUrl),C(gr,e(M).gameName||"…")}),s(me,pe)},Tt=me=>{var pe=ya(),Je=n(pe),dt=n(Je,!0);r(Je),r(pe),R(()=>C(dt,e(M).gameName||"…")),s(me,pe)};x(Te,me=>{e(M).coverUrl?me(Ve):me(Tt,!1)})}r(ct),r(Ke),R(()=>C(_t,e(Me).label)),s(Fe,Ke)},pt=Fe=>{var Me=ke(),gt=O(Me);{var Ke=Ue=>{var Ne=Sa(),lt=n(Ne);{var _t=Te=>{Qe(Te,{size:"sm",onclick:rr,class:"glow-primary gap-1.5 font-semibold",children:(Ve,Tt)=>{var me=$a(),pe=O(me);Mt(pe,{class:"h-3.5 w-3.5"}),je(),s(Ve,me)},$$slots:{default:!0}})},ct=Te=>{var Ve=Da();s(Te,Ve)};x(lt,Te=>{e(N)&&e(Pt)?Te(_t):Te(ct,!1)})}r(Ne),s(Ue,Ne)};x(gt,Ue=>{e(B)&&Ue(Ke)},!0)}s(Fe,Me)};x(ne,Fe=>{e(Z)&&e(M)?.pick?Fe(Ee):Fe(pt,!1)})}r(se),R(()=>He(se,1,`group relative min-h-[90px] min-w-[160px] flex-1 overflow-hidden rounded-lg border transition-all sm:min-h-[100px] sm:min-w-[180px]
										${e(B)?"animate-glow-pulse border-primary/50 ring-1 ring-primary/30":"border-white/[0.06]"}
										${e(ae)&&!e(B)?"bg-primary/[0.03]":e(Z)?"bg-card/50":"bg-white/[0.01]"}`)),s(_,se)}),r(p),s(T,p)}),r(ue),s(q,k)},$$slots:{default:!0}}),r(l),s(i,l)};x(de,i=>{e(u).status==="pending"?i(be):i(we,!1)})}R((i,l)=>{C(Re,e(w).name||""),C(ft,`${i??""} — ${l??""}`)},[()=>e(Se)?.releaseStart(parseInt(e(oe))).slice(5),()=>e(Se)?.releaseEnd(parseInt(e(oe))).slice(5)]),s(t,a)};x(St,t=>{!e(w)||!e(u)?t(fr):t(mr,!1)})}var pr=v(St,2);ye(pr,()=>Zr,(t,a)=>{a(t,{get open(){return e(Pe)},set open(S){o(Pe,S,!0)},children:(S,z)=>{var X=ke(),ce=O(X);ye(ce,()=>qr,(Le,Ie)=>{Ie(Le,{class:"gap-0 overflow-hidden p-0 sm:max-w-2xl",children:(Re,Ze)=>{var Ce=qa(),xe=O(Ce),st=n(xe);ye(st,()=>Wr,(ee,de)=>{de(ee,{class:"text-lg font-semibold",children:(be,we)=>{var i=ke(),l=O(i);{var $=G=>{var k=ge("Select Pick Type");s(G,k)},q=G=>{var k=ke(),K=O(k);{var W=T=>{var h=ge("Select Game");s(T,h)},ue=T=>{var h=ge("Confirm Selection");s(T,h)};x(K,T=>{e(Y)==="game"?T(W):T(ue,!1)},!0)}s(G,k)};x(l,G=>{e(Y)==="type"?G($):G(q,!1)})}s(be,i)},$$slots:{default:!0}})});var vt=v(st,2);{var nt=ee=>{Qe(ee,{variant:"ghost",size:"sm",class:"mt-1 flex items-center gap-1 text-xs text-muted-foreground",onclick:()=>o(Y,e(Y)==="confirm"?"game":"type",!0),children:(de,be)=>{var we=Ua(),i=O(we);Rt(i,{class:"h-3 w-3"}),je(),s(de,we)},$$slots:{default:!0}})};x(vt,ee=>{e(Y)!=="type"&&ee(nt)})}r(xe);var ot=v(xe,2),it=n(ot);{var ft=ee=>{var de=Aa(),be=n(de);Be(be,21,()=>e(Vt),Oe,(we,i)=>{const l=m(()=>We[e(i)]);var $=ke(),q=O($);{var G=k=>{const K=m(()=>e(l).icon);var W=ja();W.__click=()=>ar(e(i));var ue=n(W);ye(ue,()=>e(K),(I,p)=>{p(I,{get class(){return`size-9 ${e(l).color??""} transition-transform group-hover:scale-110`}})});var T=v(ue,2),h=n(T,!0);r(T);var L=v(T,2),te=n(L,!0);r(L),r(W),R(I=>{He(W,1,`group flex flex-col items-center justify-center gap-3 rounded-xl border-2 border-white/[0.06] bg-white/[0.02] p-5 transition-all ${e(l).borderHover??""}`),He(T,1,`text-base font-bold ${e(l).color??""}`),C(h,e(l).label),C(te,I)},[()=>ur(e(i))]),s(k,W)};x(q,k=>{e(l)&&k(G)})}s(we,$)}),r(be),r(de),s(ee,de)},mt=ee=>{var de=ke(),be=O(de);{var we=l=>{var $=Ba(),q=n($),G=n(q),k=n(G);ra(k,{class:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"});var K=v(k,2);zr(K,{placeholder:"Search games...",class:"pl-9",autofocus:!0,get value(){return e(De)},set value(p){o(De,p,!0)}}),r(G);var W=v(G,2),ue=n(W);{var T=p=>{var y=ge();R((ve,V)=>C(y,`Showing ${e(Se)?.label??""??""} games (${ve??""} — ${V??""})`),[()=>e(Se)?.releaseStart(parseInt(e(oe))).slice(5),()=>e(Se)?.releaseEnd(parseInt(e(oe))).slice(5)]),s(p,y)},h=p=>{var y=ge();R(()=>C(y,`All unreleased games for ${e(oe)??""}`)),s(p,y)};x(ue,p=>{e(ie)==="seasonalPick"?p(T):p(h,!1)})}r(W),r(q);var L=v(q,2);{var te=p=>{var y=Ga(),ve=n(y);Ft(ve,{class:"animate-spin text-primary"}),r(y),s(p,y)},I=p=>{Gt(p,{class:"min-h-0 flex-1",children:(y,ve)=>{var V=Na(),U=n(V);Be(U,21,()=>e(Jt),Oe,(N,B)=>{var Z=Ra();Z.__click=()=>ir(e(B).id);var ae=n(Z),se=n(ae,!0);r(ae);var ne=v(ae,2),Ee=n(ne,!0);r(ne),r(Z),R(pt=>{C(se,e(B).name),C(Ee,pt)},[()=>cr(e(B).releaseDate)]),s(N,Z)}),r(U);var _=v(U,2);$r(_,N=>o(J,N),()=>e(J));var F=v(_,2);{var fe=N=>{var B=Fa();s(N,B)},M=N=>{var B=ke(),Z=O(B);{var ae=se=>{var ne=Ma(),Ee=n(ne);r(ne),R(()=>C(Ee,`${e(Q).length??""} of ${e(j)??""}`)),s(se,ne)};x(Z,se=>{e(Q).length>0&&e(Q).length<e(j)&&se(ae)},!0)}s(N,B)};x(F,N=>{e(E)?N(fe):N(M,!1)})}r(V),s(y,V)},$$slots:{default:!0}})};x(L,p=>{e(Ge)?p(te):p(I,!1)})}r($),s(l,$)},i=l=>{var $=ke(),q=O($);{var G=k=>{var K=Ya(),W=n(K);Kr(W,{embedded:!0,get game(){return e(re)},get loading(){return e(ze)},footer:T=>{var h=za(),L=O(h),te=n(L),I=n(te);{var p=U=>{const _=m(()=>We[e(ie)]),F=m(()=>e(_).icon);var fe=Oa(),M=O(fe),N=n(M);ye(N,()=>e(F),(se,ne)=>{ne(se,{get class(){return`h-5 w-5 ${e(_).color??""}`}})}),r(M);var B=v(M,2),Z=v(n(B),2),ae=n(Z);r(Z),r(B),R(()=>C(ae,`${e(_).label??""} Pick`)),s(U,fe)};x(I,U=>{e(ie)&&We[e(ie)]&&U(p)})}r(te);var y=v(te,2);Qe(y,{size:"lg",onclick:lr,get disabled(){return e(et)},class:"glow-sm-primary px-6",children:(U,_)=>{je();var F=ge();R(()=>C(F,e(et)?"Submitting...":"Confirm Pick")),s(U,F)},$$slots:{default:!0}}),r(L);var ve=v(L,2);{var V=U=>{var _=Ha(),F=n(_,!0);r(_),R(()=>C(F,e(Ye))),s(U,_)};x(ve,U=>{e(Ye)&&U(V)})}s(T,h)},$$slots:{footer:!0}}),r(K),s(k,K)};x(q,k=>{e(Y)==="confirm"&&k(G)},!0)}s(l,$)};x(be,l=>{e(Y)==="game"?l(we):l(i,!1)},!0)}s(ee,de)};x(it,ee=>{e(Y)==="type"?ee(ft):ee(mt,!1)})}r(ot),s(Re,Ce)},$$slots:{default:!0}})}),s(S,X)},$$slots:{default:!0}})}),r(ut),s(f,ut),br()}yr(["click"]);export{ys as component};
