import{d as _r,a as s,f as c,c as ke,t as ge,s as I}from"../chunks/MBJ6GwaM.js";import{o as hr}from"../chunks/BSecBvd7.js";import{p as xr,b as P,z as Lt,u as _e,s as o,g as e,A as br,a as wr,B as kr,C as m,$ as yr,c as n,d as v,f as O,r,n as Ue,t as R}from"../chunks/DSOR0kfI.js";import{i as x}from"../chunks/ByjyKV1b.js";import{h as Pr,b as Ne,i as Oe,d as He,f as Ct}from"../chunks/B1D1IMEm.js";import{c as ye}from"../chunks/rM9ti0Cp.js";import{b as $r}from"../chunks/DsLS6WdN.js";import{g as Dr}from"../chunks/DITLjvqa.js";import{g as It}from"../chunks/CeQ0iUvZ.js";import{p as Sr}from"../chunks/N--74vBB.js";import{g as Et}from"../chunks/NxKFzN9C.js";import{d as je,t as Tr,a as Mt,b as Nt,e as Lr,f as Cr,h as Ot,p as Ir,i as Er,P as Ar,k as At}from"../chunks/BNemM3Yf.js";import{g as Ut,a as jt,i as Ur}from"../chunks/CREfjt_9.js";import{k as jr,u as ht,l as Ht,g as zt,s as Gr,h as Rr,m as Fr,r as Br,T as Mr,a as Nr}from"../chunks/CbR0rNbh.js";import{g as Or,P as Hr}from"../chunks/DwVClj7e.js";import{B as Je}from"../chunks/q16SlMYW.js";import{I as zr}from"../chunks/B3TmETIu.js";import{B as Yr}from"../chunks/CeVywxwh.js";import{D as qr,a as Wr,b as Zr,S as Gt,G as Vr}from"../chunks/Dj5BP4YO.js";import{A as Kr,a as Qr}from"../chunks/dJHOwICk.js";import{A as Rt}from"../chunks/SW3fwX3o.js";import{L as Ft}from"../chunks/DTbY4grD.js";import{S as Jr}from"../chunks/eYfS2g12.js";import{B as Xr,T as ea,S as ta}from"../chunks/BEqP53ug.js";import{S as ra}from"../chunks/D2UFy7k0.js";import{Z as Bt}from"../chunks/BqAi0SDD.js";import{C as aa}from"../chunks/DJyjECAS.js";function Yt(f,g,d,D){const U=(f??[]).filter(Q=>Q.userId===g),E=U.length;return D==="winter"?E===0?["hitPick","bombPick"]:E===1?U[0].pickType==="hitPick"?["bombPick"]:["hitPick"]:E<2+d?["seasonalPick"]:E===2+d?["altPick"]:[]:E<d?["seasonalPick"]:E===d?["altPick"]:[]}async function qt(f,g){const d=await zt(je(f,g));return d.exists()?{id:d.id,...d.data()}:null}function sa(f,g,d){return jr(je(f,g),D=>{if(!D.exists()){d(null);return}d({id:D.id,...D.data()})})}function xt(f,g){return g%2===0?[...f].reverse():f}function Wt(f){const g=f.currentPick;return g?xt(f.order,g.round)[g.position]??null:null}async function na(f,g,d){await ht(je(f,g),{presentUserIds:Ht(d)})}async function oa(f,g,d){await ht(je(f,g),{presentUserIds:Fr(d)})}async function ia(f,g,d,D){await Gr(je(f,g),{status:"pending",phase:d,order:D,currentPick:null,picks:[],presentUserIds:[],createdAt:Rr()})}async function la(f,g){const d=je(f,g),D=await zt(d);if(!D.exists())throw new Error("Draft not found");const E={round:1,position:0,userId:D.data().order[0]??"",expiresAt:null};await ht(d,{status:"active",currentPick:E})}function ca(f,g,d,D){const E=Ot(d,D)*f.length;if(g>=E)return null;const Q=Math.floor(g/f.length)+1,he=g%f.length,j=xt(f,Q)[he];return j?{round:Q,position:he,userId:j,expiresAt:null}:null}async function da(f,g,d,D,U){const E=je(f,g),Q=Tr(f,d),he=await Mt(f);if(!he)throw new Error("League not found");const b=Nt(he.members.length);await Br(Nr,async H=>{const oe=await H.get(E),w=await H.get(Q);if(!oe.exists())throw new Error("Draft does not exist");const u=oe.data(),Pe=u.phase,Y=Wt(u);if(Y!==d)throw new Error(`It is not your turn. Waiting for ${Y}.`);if(u.picks.some($e=>$e.gameId===D))throw new Error("This game has already been drafted.");if(!Yt(u.picks,d,b,Pe).includes(U))throw new Error(`You cannot make a ${U} right now.`);const ze={userId:d,gameId:D,pickType:U,timestamp:Mr.now()};if(H.update(E,{picks:Ht(ze)}),w.exists()){const Xe=w.data().picks??{};if(U==="hitPick")H.update(Q,{"picks.hitPick":D});else if(U==="bombPick")H.update(Q,{"picks.bombPick":D});else if(U==="seasonalPick"){const re=Cr(Pe),J=[...Xe[re]??[],D];H.update(Q,{[`picks.${re}`]:J})}else if(U==="altPick"){const re=[...Xe.altPicks??[],D];H.update(Q,{"picks.altPicks":re})}}const ie=ca(u.order,u.picks.length+1,Pe,b);ie?H.update(E,{currentPick:ie}):H.update(E,{currentPick:null,status:"completed"})}),(await qt(f,g))?.status==="completed"&&await Lr(f)}var ua=c('<div class="flex h-full flex-col items-center justify-center gap-3"><!> <p class="text-sm text-muted-foreground">Loading draft room...</p></div>'),va=c('<span class="flex items-center gap-1.5 font-medium text-red-400"><span class="relative flex h-2 w-2"><span class="absolute inline-flex h-full w-full animate-ping rounded-full bg-red-400 opacity-75"></span> <span class="relative inline-flex h-2 w-2 rounded-full bg-red-400"></span></span> LIVE</span>'),fa=c("<span> </span>"),ma=c('<span class="font-medium text-yellow-500">Current picker away</span>'),pa=c("<!> Start Draft",1),ga=c('<span class="flex h-2 w-2 rounded-full bg-accent"></span>'),_a=c('<span class="flex h-2 w-2 animate-pulse rounded-full bg-muted-foreground/40"></span>'),ha=c('<div><span class="max-w-[110px] truncate text-sm font-medium"> </span> <!></div>'),xa=c('<div class="flex flex-1 items-center justify-center"><div class="glass w-full max-w-md rounded-xl p-6 text-center"><div class="mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-xl bg-primary/10"><!></div> <h2 class="text-lg font-semibold">Waiting for Players</h2> <p class="mt-1 text-sm text-muted-foreground"><!></p> <div class="mt-5 grid grid-cols-2 gap-2"></div></div></div>'),ba=c("<div><!> <p> </p></div>"),wa=c('<!> <span class="mt-0.5 text-[9px] font-semibold tracking-tight text-muted-foreground uppercase"> </span>',1),ka=c('<img alt="" class="absolute inset-0 h-full w-full object-cover"/> <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"></div> <span class="absolute right-1 bottom-1 left-1.5 line-clamp-2 text-[10px] leading-tight font-medium text-white"> </span>',1),ya=c('<div class="flex h-full w-full items-center justify-center p-1.5 text-center"><span class="line-clamp-3 text-[10px] font-medium text-muted-foreground"> </span></div>'),Pa=c('<div class="absolute inset-0 flex"><div class="flex w-1/3 flex-col items-center justify-center gap-1 border-r border-white/[0.06] bg-white/[0.02]"><!> <span class="text-[8px] font-semibold tracking-tight text-muted-foreground uppercase"> </span></div> <div class="relative flex w-2/3 items-center justify-center overflow-hidden"><!></div></div>'),$a=c("<!> Make Pick",1),Da=c('<div class="flex flex-col items-center gap-1"><div class="h-1.5 w-1.5 animate-ping rounded-full bg-primary"></div> <span class="text-[10px] font-medium text-muted-foreground">Picking...</span></div>'),Sa=c('<div class="absolute inset-0 flex items-center justify-center"><!></div>'),Ta=c("<div><!></div>"),La=c('<div class="flex min-w-max gap-2"><div class="flex w-16 shrink-0 flex-col items-center justify-center text-center sm:w-20"><!></div> <!></div>'),Ca=c('<div class="sticky top-0 z-10 flex min-w-max gap-2 border-b border-white/[0.06] p-2 backdrop-blur" style="background: oklch(0.15 0.03 250 / 0.9)"><div class="flex w-16 shrink-0 items-center justify-center sm:w-20"></div> <!></div> <div class="flex flex-col gap-2 p-2"></div>',1),Ia=c('<div class="flex flex-1 flex-col overflow-hidden rounded-xl border border-white/[0.06] bg-card/30"><!></div>'),Ea=c('<div class="flex shrink-0 flex-col gap-2 sm:flex-row sm:items-center sm:justify-between"><div class="flex items-center gap-2"><!> <div class="min-w-0"><div class="flex flex-wrap items-center gap-2"><h1 class="truncate text-lg font-bold tracking-tight sm:text-xl"> </h1> <!></div> <div class="flex flex-wrap items-center gap-3 text-xs text-muted-foreground"><!> <!> <span> </span></div></div></div> <!></div> <!>',1),Aa=c("<!> Back",1),Ua=c('<button><!> <span> </span> <span class="text-center text-[11px] leading-relaxed text-muted-foreground"> </span></button>'),ja=c('<div class="overflow-y-auto p-5"><div class="grid h-full min-h-[340px] grid-cols-2 content-center gap-3"></div></div>'),Ga=c('<div class="flex flex-1 items-center justify-center"><!></div>'),Ra=c('<button class="flex w-full items-center justify-between rounded-lg px-3 py-2.5 text-left transition-colors hover:bg-white/[0.04]"><span class="text-sm font-medium"> </span> <span class="shrink-0 pl-3 font-mono text-xs text-muted-foreground"> </span></button>'),Fa=c('<div class="py-3 text-center text-xs text-muted-foreground">Loading more…</div>'),Ba=c('<div class="py-2 text-center text-[10px] text-muted-foreground"> </div>'),Ma=c('<div class="p-3"><div class="grid grid-cols-1 gap-0.5"></div> <div class="h-4 w-full" role="presentation"></div> <!></div>'),Na=c('<div class="flex min-h-0 flex-1 flex-col"><div class="shrink-0 border-b border-white/[0.06] px-5 py-3"><div class="relative"><!> <!></div> <p class="mt-2 text-[11px] text-muted-foreground"><!></p></div> <!></div>'),Oa=c('<div class="rounded-full border border-white/[0.08] bg-white/[0.03] p-2"><!></div> <div><p class="text-[10px] font-semibold text-muted-foreground uppercase">Drafting as</p> <p class="text-sm font-medium"> </p></div>',1),Ha=c('<p class="mt-2 text-center text-sm text-destructive"> </p>'),za=c('<div class="flex w-full items-center justify-between rounded-lg border border-white/[0.08] bg-white/[0.03] p-4"><div class="flex items-center gap-3"><!></div> <!></div> <!>',1),Ya=c('<div class="flex min-h-0 flex-1 flex-col"><!></div>'),qa=c('<div class="border-b border-white/[0.06] p-5 pb-3"><!> <!></div> <div class="flex h-[420px] flex-col overflow-hidden"><!></div>',1),Wa=c('<div class="flex h-[calc(100vh-7rem)] flex-col gap-4 md:h-[calc(100vh-8rem)]"><!> <!></div>');function ws(f,g){xr(g,!0);const d=new Map,D=24;let U=P(0),E=P(!1),Q=P(void 0),he=P(""),b=P(""),j=P(""),H=P("winter"),oe=P(""),w=P(null),u=P(null),Pe=P(!1),Y=P("type"),Ge=P(!1),ze=P(!1),ie=P(null),$e=P(null),Xe=P(""),re=P(null),J=P(Lt([])),De=P(""),et=P(!1),Ye=P(""),bt=null,wt=P(0),kt=P(Lt(new Map));const le=m(Et),yt=m(()=>!!(e(le)&&e(w)&&e(w).commissionerId===e(le).uid)),Zt=m(()=>new Set((e(u)?.picks??[]).map(t=>t.gameId))),tt=m(()=>e(w)?Nt(e(w).members.length):2),Vt=m(()=>Ot(e(H),e(tt))),Kt=m(()=>!e(le)||!e(u)||!e(Pt)?[]:Yt(e(u).picks??[],e(le).uid,e(tt),e(H))),Qt=m(()=>e(J).filter(t=>!e(Zt).has(t.id)));function rt(t){return e(kt).get(t)?.trim()||""}const Jt=m(()=>{if(!e(w)||!e(u))return!1;const t=e(u).presentUserIds??[];return e(w).members.every(a=>t.includes(a))}),qe=m(()=>e(u)?Wt(e(u)):null),Pt=m(()=>!!(e(le)&&e(qe)===e(le).uid)),Xt=m(()=>!!(e(qe)&&(e(u)?.presentUserIds??[]).includes(e(qe)))),at=m(()=>e(w)?.members.filter(t=>!(e(u)?.presentUserIds??[]).includes(t))??[]),Se=m(()=>Ar[e(H)]);_e(()=>{const t=Dr(Sr).params;o(b,t?.id??"",!0),o(j,t?.season??"",!0);const a=Ir(e(j));a&&(o(H,a.phase,!0),o(oe,a.season,!0))}),_e(()=>{e(b)&&Mt(e(b)).then(t=>o(w,t,!0))}),_e(()=>{const t=e(w)?.members;t?.length&&Or(t).then(a=>o(kt,a,!0))}),_e(()=>{if(!e(b)||!e(j))return;bt?.();const t=sa(e(b),e(j),a=>o(u,a,!0));return bt=t,()=>t()}),_e(()=>{e(u)?.status==="completed"&&e(b)&&It(`/league/${e(b)}`)}),_e(()=>{!e(u)||!e(le)||!e(b)||!e(j)||na(e(b),e(j),e(le).uid).catch(()=>{})}),_e(()=>{e(b)&&e(j)&&e(w)&&er()}),_e(()=>{const t=e(u)?.picks??[];for(const a of t)!a?.gameId||d.has(a.gameId)||Ut(a.gameId).then(S=>{S&&(d.set(a.gameId,S),br(wt))})}),hr(()=>{const t=Et();if(!t||!e(b)||!e(j))return;const a=()=>{oa(e(b),e(j),t.uid).catch(()=>{})};return window.addEventListener("beforeunload",a),window.addEventListener("pagehide",a),()=>{a(),window.removeEventListener("beforeunload",a),window.removeEventListener("pagehide",a)}});async function er(){if(!e(b)||!e(j)||!e(w))return;const t=await qt(e(b),e(j));t?o(u,t,!0):e(yt)&&await ia(e(b),e(j),e(H),e(w).members)}async function tr(){!e(b)||!e(j)||await la(e(b),e(j))}function rr(){o(Pe,!0),o(Y,"type"),o(ie,null),o($e,null),o(re,null),o(De,""),o(Ye,"")}function ar(t){o(ie,t,!0),o(Y,"game"),o(he,e(De),!0),Dt()}function sr(t){if(!t?.trim())return"?";const a=t.trim().split(/\s+/);return a.length===1?a[0].slice(0,2).toUpperCase():(a[0][0]+a[a.length-1][0]).toUpperCase()}function nr(){const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}function $t(){const t=nr(),a=parseInt(e(oe)),S=`${a}-12-31`;if(e(ie)==="seasonalPick"){const z=Er(e(H),a);return{releaseFrom:z.start>t?z.start:t,releaseTo:z.end}}return{releaseFrom:t,releaseTo:S}}async function Dt(){const t=parseInt(e(oe)),a=e(De).trim()||void 0,{releaseFrom:S,releaseTo:z}=$t();o(Ge,!0),o(J,[],!0),o(U,0);try{const{games:X,total:ce}=await jt(t,D,0,{search:a,releaseFrom:S,releaseTo:z});o(J,X,!0),o(U,ce,!0)}finally{o(Ge,!1)}}async function or(){const t=parseInt(e(oe)),a=e(De).trim()||void 0,{releaseFrom:S,releaseTo:z}=$t();if(!(e(Ge)||e(E)||e(J).length>=e(U))){o(E,!0);try{const{games:X,total:ce}=await jt(t,D,e(J).length,{search:a,releaseFrom:S,releaseTo:z});o(J,[...e(J),...X],!0),o(U,ce,!0)}finally{o(E,!1)}}}_e(()=>{if(e(Y)!=="game"||e(De)===e(he))return;const t=e(De),a=setTimeout(()=>{o(he,t,!0),Dt()},300);return()=>clearTimeout(a)}),_e(()=>{const t=e(Q);if(!t)return;const a=new IntersectionObserver(S=>{const[z]=S;z?.isIntersecting&&e(Y)==="game"&&e(J).length>0&&e(J).length<e(U)&&!e(E)&&!e(Ge)&&or()},{rootMargin:"100px",threshold:0});return a.observe(t),()=>a.disconnect()});async function ir(t){o(ze,!0),o(re,null),o(Y,"confirm");try{if(d.has(t))o(re,d.get(t),!0);else{const a=await Ut(t);a&&(d.set(t,a),o(re,a,!0))}e(re)&&(o($e,e(re).id,!0),o(Xe,e(re).name,!0))}finally{o(ze,!1)}}async function lr(){if(!(!e(le)||!e(b)||!e(j)||!e($e)||!e(ie))){if(await Ur(e($e))){o(Ye,"That game cannot be drafted.");return}o(et,!0);try{await da(e(b),e(j),e(le).uid,e($e),e(ie)),o(Pe,!1)}catch(t){o(Ye,t instanceof Error?t.message:"Pick failed",!0)}finally{o(et,!1)}}}function cr(t){if(!t)return"—";const a=new Date(t);return isNaN(a.getTime())?t:a.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"})}const dr={seasonalPick:{label:"Seasonal",icon:ta,color:"text-sky-400",borderHover:"hover:border-sky-400/50 hover:bg-sky-400/10"},hitPick:{label:"Hit",icon:ea,color:"text-accent",borderHover:"hover:border-accent/50 hover:bg-accent/10"},bombPick:{label:"Bomb",icon:Xr,color:"text-destructive",borderHover:"hover:border-destructive/50 hover:bg-destructive/10"},altPick:{label:"Alt",icon:Jr,color:"text-purple-400",borderHover:"hover:border-purple-400/50 hover:bg-purple-400/10"}};function ur(t){return t==="seasonalPick"?`Pick a game releasing in the ${e(Se)?.label??""} window`:t==="hitPick"?"Your GOTY prediction — the best performer this year":t==="bombPick"?"A game you think will flop — hurts other players if it bombs":t==="altPick"?"Backup pick — activates if one of your games is delisted from Steam":""}const We=dr;function vr(t,a,S){if(e(wt),!e(u)||!e(w))return null;const z=e(w).members.length;let X;t%2===0?X=t*z+a:X=t*z+(z-1-a);const ce=e(u).picks[X],Le=xt(e(u).order,e(u).currentPick?.round??0),Ce=!!e(u).currentPick&&e(u).currentPick.round===t+1&&Le[e(u).currentPick.position]===S;let Re,Ze;if(ce){const xe=d.get(ce.gameId);Re=xe?.coverUrl??void 0,Ze=xe?.name??""}const Ie=At(e(H),t+1,e(tt));return{pick:ce,isCurrent:Ce,pickIndex:X,coverUrl:Re,gameName:Ze,roundPickType:Ie}}var ut=Wa();Pr("1glbubq",t=>{kr(()=>{yr.title=e(w)?.name?`${e(w).name} – ${e(Se)?.label??""} Draft`:"Draft Room"})});var St=n(ut);{var fr=t=>{var a=ua(),S=n(a);Ft(S,{class:"h-8 w-8 animate-spin text-primary"}),Ue(2),r(a),s(t,a)},mr=t=>{var a=Ea(),S=O(a),z=n(S),X=n(z);Je(X,{variant:"ghost",size:"icon",onclick:()=>It(`/league/${e(b)}`),class:"h-8 w-8 shrink-0 text-muted-foreground hover:text-foreground",children:(i,l)=>{Rt(i,{class:"h-4 w-4"})},$$slots:{default:!0}});var ce=v(X,2),Le=n(ce),Ce=n(Le),Re=n(Ce,!0);r(Ce);var Ze=v(Ce,2);Yr(Ze,{variant:"outline",class:"shrink-0 text-[10px]",children:(i,l)=>{Ue();var $=ge();R(()=>I($,`${e(Se)?.label??""??""} Draft`)),s(i,$)},$$slots:{default:!0}}),r(Le);var Ie=v(Le,2),xe=n(Ie);{var st=i=>{var l=va();s(i,l)},vt=i=>{var l=fa(),$=n(l);r(l),R(()=>I($,`Status: ${e(u).status??""}`)),s(i,l)};x(xe,i=>{e(u).status==="active"?i(st):i(vt,!1)})}var nt=v(xe,2);{var ot=i=>{var l=ma();s(i,l)};x(nt,i=>{!e(Xt)&&e(u).status==="active"&&i(ot)})}var it=v(nt,2),ft=n(it);r(it),r(Ie),r(ce),r(z);var mt=v(z,2);{var ee=i=>{{let l=m(()=>!e(Jt));Je(i,{onclick:tr,get disabled(){return e(l)},class:"glow-sm-primary gap-2",children:($,q)=>{var G=pa(),k=O(G);Hr(k,{class:"h-4 w-4"}),Ue(),s($,G)},$$slots:{default:!0}})}};x(mt,i=>{e(yt)&&e(u).status==="pending"&&i(ee)})}r(S);var de=v(S,2);{var be=i=>{var l=xa(),$=n(l),q=n($),G=n(q);Bt(G,{class:"h-6 w-6 text-primary"}),r(q);var k=v(q,4),V=n(k);{var W=h=>{var L=ge();R(()=>I(L,`Waiting for ${e(at).length??""} ${e(at).length===1?"player":"players"}`)),s(h,L)},ue=h=>{var L=ge("Everyone is here! The commissioner can start the draft.");s(h,L)};x(V,h=>{e(at).length>0?h(W):h(ue,!1)})}r(k);var T=v(k,2);Ne(T,21,()=>e(w).members,Oe,(h,L)=>{const te=m(()=>!e(at).includes(e(L)));var C=ha(),p=n(C),y=n(p,!0);r(p);var ve=v(p,2);{var K=_=>{var F=ga();s(_,F)},A=_=>{var F=_a();s(_,F)};x(ve,_=>{e(te)?_(K):_(A,!1)})}r(C),R(_=>{He(C,1,`flex items-center justify-between rounded-lg border px-3 py-2 transition-colors ${e(te)?"border-accent/30 bg-accent/[0.06]":"border-white/[0.06] bg-white/[0.02]"}`),I(y,_)},[()=>rt(e(L))||"…"]),s(h,C)}),r(T),r($),r(l),s(i,l)},we=i=>{var l=Ia(),$=n(l);Gt($,{class:"min-h-0 flex-1",orientation:"both",children:(q,G)=>{var k=Ca(),V=O(k),W=v(n(V),2);Ne(W,17,()=>e(w).members,Oe,(T,h)=>{const L=m(()=>e(le)?.uid===e(h)),te=m(()=>e(qe)===e(h));var C=ba(),p=n(C);ye(p,()=>Qr,(K,A)=>{A(K,{class:"h-7 w-7 shrink-0",children:(_,F)=>{var fe=ke(),B=O(fe);{let M=m(()=>e(L)?"bg-primary text-primary-foreground":"");ye(B,()=>Kr,(N,Z)=>{Z(N,{get class(){return`text-[10px] ${e(M)??""}`},children:(ae,se)=>{Ue();var ne=ge();R(Ee=>I(ne,Ee),[()=>sr(rt(e(h)))]),s(ae,ne)},$$slots:{default:!0}})})}s(_,fe)},$$slots:{default:!0}})});var y=v(p,2),ve=n(y,!0);r(y),r(C),R((K,A)=>{He(C,1,`flex min-w-[160px] flex-1 items-center justify-center gap-2 rounded-lg border px-2 py-2 transition-all sm:min-w-[180px] ${e(te)?"glow-sm-primary border-primary/30 bg-primary/[0.08]":"border-white/[0.06] bg-white/[0.03]"}`),He(y,1,`truncate text-sm font-medium ${e(L)?"text-primary":""}`),Ct(y,"title",K),I(ve,A)},[()=>rt(e(h))||void 0,()=>rt(e(h))||"…"]),s(T,C)}),r(V);var ue=v(V,2);Ne(ue,21,()=>Array(e(Vt)),Oe,(T,h,L)=>{const te=m(()=>At(e(H),L+1,e(tt))),C=m(()=>We[e(te)]);var p=La(),y=n(p),ve=n(y);{var K=_=>{const F=m(()=>e(C).icon);var fe=wa(),B=O(fe);ye(B,()=>e(F),(Z,ae)=>{ae(Z,{get class(){return`h-4 w-4 ${e(C).color??""}`}})});var M=v(B,2),N=n(M,!0);r(M),R(()=>I(N,e(C).label)),s(_,fe)};x(ve,_=>{e(C)&&_(K)})}r(y);var A=v(y,2);Ne(A,17,()=>e(w).members,Oe,(_,F,fe)=>{const B=m(()=>vr(L,fe,e(F))),M=m(()=>e(le)?.uid===e(F)),N=m(()=>e(B)?.isCurrent),Z=m(()=>!!e(B)?.pick),ae=m(()=>e(qe)===e(F));var se=Ta(),ne=n(se);{var Ee=Fe=>{const Be=m(()=>We[e(B).pick.pickType]||{icon:aa,color:"text-gray-500",label:"?"}),gt=m(()=>e(Be).icon);var Ve=Pa(),Ae=n(Ve),Me=n(Ae);ye(Me,()=>e(gt),(me,pe)=>{pe(me,{get class(){return`h-4 w-4 ${e(Be).color??""}`}})});var lt=v(Me,2),_t=n(lt,!0);r(lt),r(Ae);var ct=v(Ae,2),Te=n(ct);{var Ke=me=>{var pe=ka(),Qe=O(pe),dt=v(Qe,4),gr=n(dt,!0);r(dt),R(()=>{Ct(Qe,"src",e(B).coverUrl),I(gr,e(B).gameName||"…")}),s(me,pe)},Tt=me=>{var pe=ya(),Qe=n(pe),dt=n(Qe,!0);r(Qe),r(pe),R(()=>I(dt,e(B).gameName||"…")),s(me,pe)};x(Te,me=>{e(B).coverUrl?me(Ke):me(Tt,!1)})}r(ct),r(Ve),R(()=>I(_t,e(Be).label)),s(Fe,Ve)},pt=Fe=>{var Be=ke(),gt=O(Be);{var Ve=Ae=>{var Me=Sa(),lt=n(Me);{var _t=Te=>{Je(Te,{size:"sm",onclick:rr,class:"glow-primary gap-1.5 font-semibold",children:(Ke,Tt)=>{var me=$a(),pe=O(me);Bt(pe,{class:"h-3.5 w-3.5"}),Ue(),s(Ke,me)},$$slots:{default:!0}})},ct=Te=>{var Ke=Da();s(Te,Ke)};x(lt,Te=>{e(M)&&e(Pt)?Te(_t):Te(ct,!1)})}r(Me),s(Ae,Me)};x(gt,Ae=>{e(N)&&Ae(Ve)},!0)}s(Fe,Be)};x(ne,Fe=>{e(Z)&&e(B)?.pick?Fe(Ee):Fe(pt,!1)})}r(se),R(()=>He(se,1,`group relative min-h-[90px] min-w-[160px] flex-1 overflow-hidden rounded-lg border transition-all sm:min-h-[100px] sm:min-w-[180px]
										${e(N)?"animate-glow-pulse border-primary/50 ring-1 ring-primary/30":"border-white/[0.06]"}
										${e(ae)&&!e(N)?"bg-primary/[0.03]":e(Z)?"bg-card/50":"bg-white/[0.01]"}`)),s(_,se)}),r(p),s(T,p)}),r(ue),s(q,k)},$$slots:{default:!0}}),r(l),s(i,l)};x(de,i=>{e(u).status==="pending"?i(be):i(we,!1)})}R((i,l)=>{I(Re,e(w).name||""),I(ft,`${i??""} — ${l??""}`)},[()=>e(Se)?.releaseStart(parseInt(e(oe))).slice(5),()=>e(Se)?.releaseEnd(parseInt(e(oe))).slice(5)]),s(t,a)};x(St,t=>{!e(w)||!e(u)?t(fr):t(mr,!1)})}var pr=v(St,2);ye(pr,()=>Zr,(t,a)=>{a(t,{get open(){return e(Pe)},set open(S){o(Pe,S,!0)},children:(S,z)=>{var X=ke(),ce=O(X);ye(ce,()=>qr,(Le,Ce)=>{Ce(Le,{class:"gap-0 overflow-hidden p-0 sm:max-w-2xl",children:(Re,Ze)=>{var Ie=qa(),xe=O(Ie),st=n(xe);ye(st,()=>Wr,(ee,de)=>{de(ee,{class:"text-lg font-semibold",children:(be,we)=>{var i=ke(),l=O(i);{var $=G=>{var k=ge("Select Pick Type");s(G,k)},q=G=>{var k=ke(),V=O(k);{var W=T=>{var h=ge("Select Game");s(T,h)},ue=T=>{var h=ge("Confirm Selection");s(T,h)};x(V,T=>{e(Y)==="game"?T(W):T(ue,!1)},!0)}s(G,k)};x(l,G=>{e(Y)==="type"?G($):G(q,!1)})}s(be,i)},$$slots:{default:!0}})});var vt=v(st,2);{var nt=ee=>{Je(ee,{variant:"ghost",size:"sm",class:"mt-1 flex items-center gap-1 text-xs text-muted-foreground",onclick:()=>o(Y,e(Y)==="confirm"?"game":"type",!0),children:(de,be)=>{var we=Aa(),i=O(we);Rt(i,{class:"h-3 w-3"}),Ue(),s(de,we)},$$slots:{default:!0}})};x(vt,ee=>{e(Y)!=="type"&&ee(nt)})}r(xe);var ot=v(xe,2),it=n(ot);{var ft=ee=>{var de=ja(),be=n(de);Ne(be,21,()=>e(Kt),Oe,(we,i)=>{const l=m(()=>We[e(i)]);var $=ke(),q=O($);{var G=k=>{const V=m(()=>e(l).icon);var W=Ua();W.__click=()=>ar(e(i));var ue=n(W);ye(ue,()=>e(V),(C,p)=>{p(C,{get class(){return`size-9 ${e(l).color??""} transition-transform group-hover:scale-110`}})});var T=v(ue,2),h=n(T,!0);r(T);var L=v(T,2),te=n(L,!0);r(L),r(W),R(C=>{He(W,1,`group flex flex-col items-center justify-center gap-3 rounded-xl border-2 border-white/[0.06] bg-white/[0.02] p-5 transition-all ${e(l).borderHover??""}`),He(T,1,`text-base font-bold ${e(l).color??""}`),I(h,e(l).label),I(te,C)},[()=>ur(e(i))]),s(k,W)};x(q,k=>{e(l)&&k(G)})}s(we,$)}),r(be),r(de),s(ee,de)},mt=ee=>{var de=ke(),be=O(de);{var we=l=>{var $=Na(),q=n($),G=n(q),k=n(G);ra(k,{class:"absolute top-2.5 left-2.5 h-4 w-4 text-muted-foreground"});var V=v(k,2);zr(V,{placeholder:"Search games...",class:"pl-9",autofocus:!0,get value(){return e(De)},set value(p){o(De,p,!0)}}),r(G);var W=v(G,2),ue=n(W);{var T=p=>{var y=ge();R((ve,K)=>I(y,`Showing ${e(Se)?.label??""??""} games (${ve??""} — ${K??""})`),[()=>e(Se)?.releaseStart(parseInt(e(oe))).slice(5),()=>e(Se)?.releaseEnd(parseInt(e(oe))).slice(5)]),s(p,y)},h=p=>{var y=ge();R(()=>I(y,`All unreleased games for ${e(oe)??""}`)),s(p,y)};x(ue,p=>{e(ie)==="seasonalPick"?p(T):p(h,!1)})}r(W),r(q);var L=v(q,2);{var te=p=>{var y=Ga(),ve=n(y);Ft(ve,{class:"animate-spin text-primary"}),r(y),s(p,y)},C=p=>{Gt(p,{class:"min-h-0 flex-1",children:(y,ve)=>{var K=Ma(),A=n(K);Ne(A,21,()=>e(Qt),Oe,(M,N)=>{var Z=Ra();Z.__click=()=>ir(e(N).id);var ae=n(Z),se=n(ae,!0);r(ae);var ne=v(ae,2),Ee=n(ne,!0);r(ne),r(Z),R(pt=>{I(se,e(N).name),I(Ee,pt)},[()=>cr(e(N).releaseDate)]),s(M,Z)}),r(A);var _=v(A,2);$r(_,M=>o(Q,M),()=>e(Q));var F=v(_,2);{var fe=M=>{var N=Fa();s(M,N)},B=M=>{var N=ke(),Z=O(N);{var ae=se=>{var ne=Ba(),Ee=n(ne);r(ne),R(()=>I(Ee,`${e(J).length??""} of ${e(U)??""}`)),s(se,ne)};x(Z,se=>{e(J).length>0&&e(J).length<e(U)&&se(ae)},!0)}s(M,N)};x(F,M=>{e(E)?M(fe):M(B,!1)})}r(K),s(y,K)},$$slots:{default:!0}})};x(L,p=>{e(Ge)?p(te):p(C,!1)})}r($),s(l,$)},i=l=>{var $=ke(),q=O($);{var G=k=>{var V=Ya(),W=n(V);Vr(W,{embedded:!0,get game(){return e(re)},get loading(){return e(ze)},footer:T=>{var h=za(),L=O(h),te=n(L),C=n(te);{var p=A=>{const _=m(()=>We[e(ie)]),F=m(()=>e(_).icon);var fe=Oa(),B=O(fe),M=n(B);ye(M,()=>e(F),(se,ne)=>{ne(se,{get class(){return`h-5 w-5 ${e(_).color??""}`}})}),r(B);var N=v(B,2),Z=v(n(N),2),ae=n(Z);r(Z),r(N),R(()=>I(ae,`${e(_).label??""} Pick`)),s(A,fe)};x(C,A=>{e(ie)&&We[e(ie)]&&A(p)})}r(te);var y=v(te,2);Je(y,{size:"lg",onclick:lr,get disabled(){return e(et)},class:"glow-sm-primary px-6",children:(A,_)=>{Ue();var F=ge();R(()=>I(F,e(et)?"Submitting...":"Confirm Pick")),s(A,F)},$$slots:{default:!0}}),r(L);var ve=v(L,2);{var K=A=>{var _=Ha(),F=n(_,!0);r(_),R(()=>I(F,e(Ye))),s(A,_)};x(ve,A=>{e(Ye)&&A(K)})}s(T,h)},$$slots:{footer:!0}}),r(V),s(k,V)};x(q,k=>{e(Y)==="confirm"&&k(G)},!0)}s(l,$)};x(be,l=>{e(Y)==="game"?l(we):l(i,!1)},!0)}s(ee,de)};x(it,ee=>{e(Y)==="type"?ee(ft):ee(mt,!1)})}r(ot),s(Re,Ie)},$$slots:{default:!0}})}),s(S,X)},$$slots:{default:!0}})}),r(ut),s(f,ut),wr()}_r(["click"]);export{ws as component};
