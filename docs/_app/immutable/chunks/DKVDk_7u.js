import{_ as S}from"./PPVm8Dsz.js";import{a as _,d as k,b as y,c as v,q as E,n as F,g as $}from"./2_D5sMpC.js";const d=["winter","summer","fall"],G={winter:{label:"Winter",releaseStart:e=>`${e}-01-01`,releaseEnd:e=>`${e}-04-30`,draftMonth:11},summer:{label:"Summer",releaseStart:e=>`${e}-05-01`,releaseEnd:e=>`${e}-08-31`,draftMonth:3},fall:{label:"Fall",releaseStart:e=>`${e}-09-01`,releaseEnd:e=>`${e}-12-31`,draftMonth:7}};function A(e,t){return`${e}-${t}`}function O(e){const t=e.match(/^(winter|summer|fall)-(\d{4})$/);return t?{phase:t[1],season:t[2]}:null}function I(e){const t=d.indexOf(e);return t<d.length-1?d[t+1]:null}function R(e){const t=e.getMonth();return t<=3?"winter":t<=7?"summer":"fall"}function x(e){let t=R(new Date);for(;t;){if(e[t]!=="completed")return t;t=I(t)}return null}function H(e,t){const s=G[e];return{start:s.releaseStart(t),end:s.releaseEnd(t)}}function M(e,t){return e==="winter"?t+3:t+1}function B(e,t,s){return e==="winter"?t===1?"hitPick":t===2?"bombPick":t<=2+s?"seasonalPick":"altPick":t<=s?"seasonalPick":"altPick"}const C={2:8,3:6,4:4,5:3,6:2,7:2,8:2};function q(e){return C[e]??2}function N(e){return`${e}Picks`}function U(e,t=[]){const s=new Set(t),a=[];e.hitPick&&a.push(e.hitPick);const r=["winterPicks","summerPicks","fallPicks"];let n=0;for(const h of r){const f=e[h]??[];for(const c of f)if(s.has(c)){const m=(e.altPicks??[])[n];m&&a.push(m),n++}else a.push(c)}return a}const u=(await S(async()=>{const{default:e}=await import("./BAsd2ghB.js");return{default:e}},[],import.meta.url)).default,p=new Map(u.games.map(e=>[e.id,e]));let g=null;function w(){return g||(g=_(k(y,"meta","scores")).then(e=>e.exists()?e.data().scores??{}:{})),g}async function Y(e){const t=p.get(e)??null;if(!t)return null;const s=await w();return{...t,id:e,score:s[e]??null}}function K(){const e=[...new Set(u.games.map(t=>t.releaseDate?.slice(0,4)).filter(t=>!!t&&/^\d{4}$/.test(t)).map(t=>parseInt(t,10)))].sort((t,s)=>s-t);return Promise.resolve(e)}async function L(e){const t=String(e),s=await w();return u.games.filter(a=>a.releaseDate?.startsWith(t)).map(a=>({id:a.id,name:a.name,releaseDate:a.releaseDate??null,coverUrl:a.coverUrl??null,score:s[a.id]??null}))}async function W(e,t,s,a){let r=await L(e);if(a?.releaseFrom&&(r=r.filter(i=>(i.releaseDate??"")>=a.releaseFrom)),a?.releaseTo&&(r=r.filter(i=>(i.releaseDate??"")<=a.releaseTo)),a?.search?.trim()){const i=a.search.trim().toLowerCase();r=r.filter(o=>o.name.toLowerCase().includes(i))}const n=a?.sortBy??"date",f=(a?.order??"asc")==="asc"?1:-1;r=[...r].sort((i,o)=>{let l=0;if(n==="id")l=(i.id??"").localeCompare(o.id??"");else if(n==="name")l=(i.name??"").localeCompare(o.name??"",void 0,{sensitivity:"base"});else if(n==="date")l=(i.releaseDate??"").localeCompare(o.releaseDate??"");else{const P=i.score??-1/0,D=o.score??-1/0;l=P===D?0:P<D?-1:1}return l*f});const c=r.length;return{games:r.slice(s,s+t),total:c}}function j(e){const t=p.get(e);return Promise.resolve(t?.isHidden===!0)}async function V(e){const t=v(y,"games",e,"history"),s=E(t,F("date","asc"));return(await $(s)).docs.map(r=>{const n=r.data();return{owners:n.estimatedOwners??0,ownersDelta:n.salesDelta??0,ccu:n.ccu??0,daysSinceRelease:n.daysSinceRelease??0,dailyPoints:n.points??0,date:n.date??r.id}})}function z(){const e=new Date().toISOString().split("T")[0];return Promise.resolve(u.games.filter(t=>!t.isHidden&&t.releaseDate&&t.releaseDate>=e).sort((t,s)=>(t.releaseDate??"").localeCompare(s.releaseDate??"")).map(t=>({...t,id:t.id})))}export{d as D,G as P,U as a,V as b,A as c,I as d,q as e,N as f,x as g,M as h,Y as i,W as j,H as k,j as l,B as m,z as n,K as o,O as p};
