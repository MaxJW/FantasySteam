import{_ as w}from"./PPVm8Dsz.js";import{g as _,d as v,a as f,c as P,q as S,o as h,b as G}from"./CbR0rNbh.js";const c=(await w(async()=>{const{default:a}=await import("./BAsd2ghB.js");return{default:a}},[],import.meta.url)).default,y=new Map(c.games.map(a=>[a.id,a]));let m=null;function g(){return m||(m=_(v(f,"meta","scores")).then(a=>a.exists()?a.data().scores??{}:{})),m}async function H(a){const e=y.get(a)??null;if(!e)return null;const r=await g();return{...e,id:a,score:r[a]??null}}function I(){const a=[...new Set(c.games.map(e=>e.releaseDate?.slice(0,4)).filter(e=>!!e&&/^\d{4}$/.test(e)).map(e=>parseInt(e,10)))].sort((e,r)=>r-e);return Promise.resolve(a)}async function C(a){const e=String(a),r=await g();return c.games.filter(t=>t.releaseDate?.startsWith(e)).map(t=>({id:t.id,name:t.name,releaseDate:t.releaseDate??null,coverUrl:t.coverUrl??null,score:r[t.id]??null}))}async function R(a,e,r,t){let s=await C(a);if(t?.releaseFrom&&(s=s.filter(o=>(o.releaseDate??"")>=t.releaseFrom)),t?.releaseTo&&(s=s.filter(o=>(o.releaseDate??"")<=t.releaseTo)),t?.search?.trim()){const o=t.search.trim().toLowerCase();s=s.filter(i=>i.name.toLowerCase().includes(o))}const n=t?.sortBy??"date",D=(t?.order??"asc")==="asc"?1:-1;s=[...s].sort((o,i)=>{let l=0;if(n==="id")l=(o.id??"").localeCompare(i.id??"");else if(n==="name")l=(o.name??"").localeCompare(i.name??"",void 0,{sensitivity:"base"});else if(n==="date")l=(o.releaseDate??"").localeCompare(i.releaseDate??"");else{const d=o.score??-1/0,u=i.score??-1/0;l=d===u?0:d<u?-1:1}return l*D});const p=s.length;return{games:s.slice(r,r+e),total:p}}function T(a){const e=y.get(a);return Promise.resolve(e?.isHidden===!0)}async function O(a){const e=P(f,"games",a,"history"),r=S(e,h("date","asc"));return(await G(r)).docs.map(s=>{const n=s.data();return{owners:n.estimatedOwners??0,ownersDelta:n.salesDelta??0,ccu:n.ccu??0,daysSinceRelease:n.daysSinceRelease??0,dailyPoints:n.points??0,date:n.date??s.id}})}function U(){const a=new Date().toISOString().split("T")[0];return Promise.resolve(c.games.filter(e=>!e.isHidden&&e.releaseDate&&e.releaseDate>=a).sort((e,r)=>(e.releaseDate??"").localeCompare(r.releaseDate??"")).map(e=>({...e,id:e.id})))}export{R as a,O as b,U as c,I as d,H as g,T as i};
