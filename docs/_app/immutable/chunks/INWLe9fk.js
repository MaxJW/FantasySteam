import{c as j,a as m,f as R}from"./gRx6Pn2l.js";import{i as A}from"./B7QUMImS.js";import{p as C,ag as D,ah as I,f as M,g as T,a as V,a2 as q,c as y,r as h,d as E,s as z}from"./vIZKj9Q3.js";import{d as B}from"./DuGzo3VH.js";import{i as k,a as F,b as x}from"./nU2p-N_8.js";import{_ as G}from"./PPVm8Dsz.js";import{w as P}from"./BDeyOzaV.js";function H(p={}){const{immediate:u=!1,onNeedRefresh:o,onOfflineReady:r,onRegistered:d,onRegisteredSW:f,onRegisterError:i}=p;let t,n,l;const b=async(e=!0)=>{await n,l?.()};async function _(){if("serviceWorker"in navigator){if(t=await G(async()=>{const{Workbox:e}=await import("./BIl4cyR9.js");return{Workbox:e}},[],import.meta.url).then(({Workbox:e})=>new e("./sw.js",{scope:"./",type:"classic"})).catch(e=>{i?.(e)}),!t)return;l=()=>{t?.messageSkipWaiting()};{let e=!1;const g=()=>{e=!0,t?.addEventListener("controlling",a=>{a.isUpdate&&window.location.reload()}),o?.()};t.addEventListener("installed",a=>{typeof a.isUpdate>"u"?typeof a.isExternal<"u"&&a.isExternal?g():!e&&r?.():a.isUpdate||r?.()}),t.addEventListener("waiting",g)}t.register({immediate:u}).then(e=>{f?f("./sw.js",e):d?.(e)}).catch(e=>{i?.(e)})}}return n=_(),b}function J(p={}){const{immediate:u=!0,onNeedRefresh:o,onOfflineReady:r,onRegistered:d,onRegisteredSW:f,onRegisterError:i}=p,t=P(!1),n=P(!1),l=H({immediate:u,onOfflineReady(){n.set(!0),r?.()},onNeedRefresh(){t.set(!0),o?.()},onRegistered:d,onRegisteredSW:f,onRegisterError:i});return{needRefresh:t,offlineReady:n,updateServiceWorker:l}}var K=R("<span>App ready to work offline</span>"),Q=R("<span>New content available, click reload to update.</span>"),X=R('<button type="button" class="pwa-toast-btn pwa-toast-btn-primary svelte-taxab8">Reload</button>'),Y=R('<div class="pwa-toast svelte-taxab8" role="alert"><div class="pwa-toast-message svelte-taxab8"><!></div> <div class="pwa-toast-actions svelte-taxab8"><!> <button type="button" class="pwa-toast-btn svelte-taxab8">Close</button></div></div>');function ie(p,u){C(u,!1);const o=()=>x(l,"$offlineReady",d),r=()=>x(t,"$needRefresh",d),[d,f]=F(),i=q(),{needRefresh:t,updateServiceWorker:n,offlineReady:l}=J({immediate:!0,onRegisteredSW(a,v){v?.update()},onRegisterError(a){console.error("SW registration error:",a)}});function b(){l.set(!1),t.set(!1)}D(()=>(o(),r()),()=>{z(i,o()||r())}),I(),A();var _=j(),e=M(_);{var g=a=>{var v=Y(),w=y(v),$=y(w);{var N=s=>{var c=K();m(s,c)},L=s=>{var c=Q();m(s,c)};k($,s=>{o()?s(N):s(L,!1)})}h(w);var W=E(w,2),S=y(W);{var O=s=>{var c=X();c.__click=()=>n(!0),m(s,c)};k(S,s=>{r()&&s(O)})}var U=E(S,2);U.__click=b,h(W),h(v),m(a,v)};k(e,a=>{T(i)&&a(g)})}m(p,_),V(),f()}B(["click"]);export{ie as default};
